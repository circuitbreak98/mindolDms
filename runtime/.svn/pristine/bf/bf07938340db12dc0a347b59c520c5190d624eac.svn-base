<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
	<!-- top file include  start -->
	<%@ include file="include/top.jsp" %>	
	<!-- top page include  end -->	
	<%
	//get data
	IDataSet responseData = WebUtils.getResultDataSet(request);
	if(responseData != null){
		IResultMessage resultMessage = responseData.getResultMessage();
		String Message = BaseUtils.getMessage(resultMessage.getMessageId(), resultMessage.getMessageParams());
		
		//로그인성공여부 확인 
		if(resultMessage.getStatus() != IResultMessage.FAIL){  
		    out.println( "<script>");
		    out.println( " location.href='jsp/SknCrdLstM.jsp';");
		    out.println( "</script>"); 
		} else {
		    //로그인여부에 따라 분기처리  
	 	    if( "DMS00011".equals(resultMessage.getMessageId()) || "DMS00013".equals(resultMessage.getMessageId())){
	 	       out.println( "<script>");
			    out.println( "alert('"+Message+"');"); 
			    out.println( "window.open('/jsp/chgPwdPopup.jsp', 'pop','toolbar=no,directories=no,scrollbars=no,resizable=no,status=no,menubar=no,width=390');");
			    out.println( "</script>"); 
		    } else { 
			    out.println( "<script>");
			    out.println( "alert('"+Message+"');");
			    out.println( " location.href='jsp/login.jsp';");
			    out.println( "</script>"); 
		    }
		}
	}	
	%>	
	<!-- content start -->
	<div id="contentDiv"> 
		<div id ="contentWrapDiv"> 			
			<!-- login layout start  -->	
			<div id="loginWrapDiv">
				 <div class="page_tit"><img src="${contextPath}/ext/img/member_title_01.gif" alt="로그인" /></div>
	                <div class="loginDiv">            
	                	<form name="loginForm" method="post" >
	                	<input type="hidden" name="${transactionId}">
						<input type="hidden" name="${target}">
						<%-- <input type="hidden" name="ipad" value="<%=request.getRemoteAddr()%>">		
						<input type="hidden" name="urlReferer" id="urlReferer" value="${urlReferer}"/> --%>
						<input type="hidden" name="LINK_SYSTEM" value="NO">		
						<input type="hidden" name="FORCED_YN" value="Y">		
	                    <div class="login-option">                		
	                        <ul class="login-form" >
	                            <li>
	                                <input type="text" name="USER_ID" id="USER_ID" class="input" alt="아이디" />
	                            </li>
	                            <li class="mt-10">
	                                <input type="password" name="USER_PWD"  id="USER_PWD"  class="input" alt="비밀번호"  />
	                            </li>
	                            <li class="mt-10">	                                
	                                    <p id="checkSaveUserIdP" class="float-left">
	                                    	<input type="checkbox" name="saveUserId" id="saveUserId"  />
	                                    	아이디저장
	                                    </p>
	                                    <div class="alertSearchZone"  title="Warning!"  data-placement="bottom" data-toggle="popover" data-content="" ></div>
	                            </li>  
	                        </ul>
	                    </div>	                 
	                </form>	                    
                   	<div class="login_bu"><input type="image" src="${contextPath}/ext/img/btn_box_login.gif" onClick="onBeforeLogin()" /></div>
               	 	
                   <!--  <div class="member-text-hide"></div>배경의 이미지를 가리기 위해 필요함. -->
                </div> 
            </div>
			<!-- login layout end -->
		</div>
		<!-- content end -->
		<!-- footer file include  start -->
		<%@ include file="include/footer.jsp" %>	
		<!-- footer page include  end -->	
	</div>	
	
<script>	
	$(document).ready(function() {
		var userId = $.cookie("admin_id");		
		if ( userId == "undefined" || userId == null || userId == "") {
	 		$("input[name='saveUserId']").removeAttr("checked");
			$("input[name='USER_ID']").focus(); 
		} else {
		    $("input[name='saveUserId']").attr("checked", "checked");
			$("input[name='USER_ID']").val(userId);
			$("input[name='USER_PWD']").focus(); 
		} 				
	});
	
	function onBeforeLogin() {
		var saveUserId = document.getElementById("saveUserId").checked;
		var userId = $("input[name='USER_ID']").val();
		
		if(!gfn_check(["USER_ID","USER_PWD"])){
			return false;	
		}
		
		if(saveUserId){$.cookie('admin_id', userId, {path:'/', expires:30});}
		else{$.cookie('admin_id', null, {path:'/'});}		
		doLogin();
	
	}

	function doLogin(){
		document.loginForm.${transactionId}.value="PSCLginOp_pLginWeb";
		document.loginForm.${target}.value="forward:jsp/login.jsp"; //loginProcess
		document.loginForm.target = "_self";
		document.loginForm.action = "${contextPath}/login.cmd";
		document.loginForm.submit();
	}
	
</script>
</body>
</html>