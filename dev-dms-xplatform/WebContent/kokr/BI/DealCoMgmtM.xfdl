<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="DealCoMgmtM" classname="ProgramReg" inheritanceid="" position="absolute 0 0 1038 528" titletext="거래처관리" style="font:arial,11;" onload="Form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w&#13;&#10;20" class="tip_guide" visible="false" position2="absolute l:1018 w:20 t:43 h:202" positiontype="position2"/>
        <Div id="div_search" taborder="0" text="Div00" position="absolute 0 0 1018 40" class="bg_search" anchor="left top right">
          <Layouts>
            <Layout>
              <Static id="Static01" text="거래처명" class="sta_WFSA_Label" position="absolute 15 9 91 29" tooltiptype="hover" tooltiptext="거래처명" anchor="default"/>
              <Static id="Static00" text="거래상태" class="sta_WFSA_Label" position="absolute 597 9 658 29" tooltiptype="hover" anchor="default"/>
              <Static id="Static08" text="w&#13;&#10;&#13;10" class="tip_guide" visible="false" position2="absolute l:294 w:10 t:-3 h:42" positiontype="position2"/>
              <Static id="Static09" text="w&#13;&#10;&#13;10" class="tip_guide" visible="false" position2="absolute l:68 w:10 t:-2 h:42" positiontype="position2"/>
              <Static id="Static12" text="w&#13;&#10;&#13;15" class="tip_guide" visible="false" position2="absolute l:0 w:15 t:10 h:42" positiontype="position2"/>
              <Edit id="edt_dealCoNm" taborder="0" position="absolute 78 9 198 29" anchor="default" validate="title:거래처명,maxlengthB:80" maxlength="30" onkeydown="div_search_edt_dealCoNm_onkeydown"/>
              <Static id="Static03" text="거래처구분" class="sta_WFSA_Label" position="absolute 411 9 480 29" tooltiptype="hover" tooltiptext="거래처구분" anchor="default"/>
              <Combo id="cbo_dealCoCl1" taborder="2" innerdataset="@ds_DMS103" codecolumn="CM_CD_ID" datacolumn="CM_CD_NM" index="-1" position="absolute 487 9 567 29" anchor="default" validate=""/>
              <Static id="Static06" text="사업자번호" class="sta_WFSA_Label" position="absolute 769 9 839 29" tooltiptype="hover" anchor="default"/>
              <Combo id="cbo_dealCoStCd" taborder="3" innerdataset="@ds_DMS104" codecolumn="CM_CD_ID" datacolumn="CM_CD_NM" index="-1" position="absolute 660 9 739 29" anchor="default"/>
              <MaskEdit id="msk_bizNum" taborder="4" type="string" mask="###-##-#####" maskchar="_" enable="true" position="absolute 845 9 925 29" style="align:left middle;" anchor="default" onkeydown="div_search_msk_bizNum_onkeydown"/>
              <Static id="Static04" text="w&#13;30" class="tip_guide" visible="false" position2="absolute l:198 w:30 t:1 h:42" positiontype="position2"/>
              <Static id="Static05" text="w&#13;&#10;30" class="tip_guide" visible="false" position2="absolute l:567 w:30 t:-1 h:42" positiontype="position2"/>
              <Static id="Static02" text="w&#13;&#10;30" class="tip_guide" visible="false" position2="absolute l:739 w:30 t:-1 h:42" positiontype="position2"/>
              <Static id="Static07" text="거래처코드" class="sta_WFSA_Label" position="absolute 228 9 304 29" tooltiptype="hover" tooltiptext="거래처코드"/>
              <Edit id="edt_dealCoCd" taborder="1" maxlength="30" position="absolute 304 9 381 29" validate="title:거래처코드,maxlength:10" onkeydown="div_search_edt_dealCoNm_onkeydown"/>
              <Static id="Static10" text="w&#13;&#10;30" class="tip_guide" visible="false" position2="absolute l:381 w:30 t:-1 h:42" positiontype="position2"/>
              <Static id="Static11" text="w&#13;&#10;&#13;10" class="tip_guide" visible="false" position2="absolute l:477 w:10 t:-4 h:42" positiontype="position2"/>
              <Static id="Static13" text="w&#13;&#10;&#13;10" class="tip_guide" visible="false" position2="absolute l:650 w:10 t:4 h:42" positiontype="position2"/>
              <Static id="Static14" text="w&#13;&#10;&#13;10" class="tip_guide" visible="false" position2="absolute l:835 w:10 t:4 h:42" positiontype="position2"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static13" text="h33" class="tip_guide" visible="false" position2="absolute l:285 w:42 t:40 h:33" positiontype="position2"/>
        <Static id="stc_subTitle01" text="조회결과" class="sub_title" position="absolute 0 50 229 70" usedecorate="true"/>
        <Static id="Static00" text="h10" class="tip_guide" visible="false" position2="absolute l:113 w:42 t:0 h:10" positiontype="position2"/>
        <Static id="Static14" text="h10" class="tip_guide" visible="false" position2="absolute l:113 w:42 t:30 h:10" positiontype="position2"/>
        <Static id="Static02" text="h14" class="tip_guide" visible="false" position2="absolute l:2 w:42 t:40 h:14" positiontype="position2"/>
        <Static id="Static04" text="h8" class="tip_guide" visible="false" position2="absolute l:4 w:42 t:65 h:8" positiontype="position2"/>
        <Button id="btn_search" taborder="2" text="조회" onclick="btn_search_onclick" class="btn_WFSA_Search_M" position="absolute 959 12 1017 39" style="align:center middle;" anchor="top right"/>
        <Static id="Static08" text="v10" class="guideTip" visible="false" position2="absolute l:599 w:30 t:73 h:10" positiontype="position2"/>
        <Static id="Static09" text="w20" class="guideTip" visible="false" position2="absolute l:998 w:20 t:80 h:307" positiontype="position2"/>
        <Static id="Static12" text="v10" class="guideTip" visible="false" position2="absolute l:596 w:382 t:95 h:10" positiontype="position2"/>
        <Div id="Div01" anchor="top right" taborder="1" class="bg_detail" position="absolute 455 73 1019 488">
          <Layouts>
            <Layout width="564" height="395">
              <Div id="Div03" anchor="left top right" taborder="103" text="Div00" class="bg_detail2" position="absolute 9 124 553 334">
                <Layouts>
                  <Layout width="995" height="621">
                    <Static id="Static05" text="v10" class="guideTip" visible="false" position2="absolute l:820 w:30 t:0 h:10" positiontype="position2"/>
                    <Static id="Static48" text="v4" class="guideTip" visible="false" position2="absolute l:32 w:333 t:-140 h:4" positiontype="position2"/>
                    <Static id="Static01" text="v4" class="guideTip" visible="false" position2="absolute l:32 w:333 t:-120 h:4" positiontype="position2"/>
                    <Static id="Static02" text="v4" class="guideTip" visible="false" position2="absolute l:31 w:541 t:-96 h:4" positiontype="position2"/>
                    <Static id="Static03" text="v4" class="guideTip" visible="false" position2="absolute l:31 w:541 t:-72 h:4" positiontype="position2"/>
                    <Static id="Static06" text="v10" class="guideTip" visible="false" position2="absolute l:112 w:29 t:0 h:10" positiontype="position2"/>
                    <Static id="stc_05" text="주소" onclick="Div01_stc_05_onclick" class="sta_WFDA_detail_Label" position="absolute 9 130 97 150" anchor="default"/>
                    <Button id="btn_addrSrch" taborder="10" class="btn_WFDA_search" position="absolute 149 130 168 150" tooltiptype="hover" tooltiptext="우편번호 검색" anchor="default" onclick="Div01_Div03_btn_addrSrch_onclick"/>
                    <Edit id="edt_addr" taborder="11" value="서울 강남구 논현로80길 25" readonly="true" enable="true" position="absolute 169 130 503 150" anchor="default" onkillfocus="Div01_Div03_edt_addr_ontextchanged"/>
                    <Static id="stc_13" text="업태" class="sta_WFDA_detail_Label" position="absolute 255 34 335 54" anchor="default"/>
                    <Edit id="edt_bizCon" taborder="3" position="absolute 333 34 452 54" anchor="default" validate="title:업태,maxlengthB:60" maxlength="20"/>
                    <Static id="stc_14" text="거래상태" class="sta_WFDA_detail_Label_P" position="absolute 9 10 89 30" anchor="default"/>
                    <Static id="stc_02" text="사업자번호" class="sta_WFDA_detail_Label" position="absolute 9 34 81 54" anchor="default"/>
                    <Static id="stc_15" text="종목" class="sta_WFDA_detail_Label" position="absolute 9 58 89 78" anchor="default"/>
                    <Edit id="edt_typOfBiz" taborder="4" position="absolute 88 58 183 78" anchor="default" validate="title:종목,maxlengthB:60" maxlength="20"/>
                    <Static id="stc_16" text="전화번호" class="sta_WFDA_detail_Label" position="absolute 255 58 317 78" anchor="default"/>
                    <Static id="stc_20" text="거래개시일" class="sta_WFDA_detail_Label" position="absolute 9 82 86 102" anchor="default"/>
                    <Static id="stc_21" text="FAX" class="sta_WFDA_detail_Label" position="absolute 9 106 47 126" anchor="default"/>
                    <Static id="stc_22" text="대표자명" class="sta_WFDA_detail_Label" position="absolute 255 10 336 30" anchor="default"/>
                    <Edit id="edt_repUserNm" taborder="1" position="absolute 333 10 452 30" anchor="default" validate="title:대표자명,maxlengthB:30" maxlength="10" onkillfocus="Div01_Div03_edt_repUserNm_ontextchanged"/>
                    <Static id="stc_23" text="거래종료일" class="sta_WFDA_detail_Label" position="absolute 255 82 335 102" anchor="default"/>
                    <MaskEdit id="edt_bizNum" taborder="2" type="string" mask="###-##-#####" onkeydown="div_search_edt_rtnTelNo_onkeydown" oneditclick="Div01_edt_rtnTelNo_oneditclick" enable="true" position="absolute 88 34 171 54" style="align:left middle;" anchor="default"/>
                    <Calendar id="cal_dealStaDt" taborder="6" dateformat="yyyy-MM-dd" onkeydown="div_search_cal_logBzopDt_onkeydown" enable="true" position="absolute 88 82 189 102" anchor="default"/>
                    <Calendar id="cal_dealEndDt" taborder="7" dateformat="yyyy-MM-dd" onkeydown="div_search_cal_logBzopDt_onkeydown" enable="true" position="absolute 333 82 428 102" anchor="default"/>
                    <Static id="Static00" text="v10" class="guideTip" visible="false" position2="absolute l:186 w:30 t:198 h:10" positiontype="position2"/>
                    <MaskEdit id="edt_zipNo" taborder="9" type="string" mask="###-###" onkeydown="div_search_edt_rtnTelNo_onkeydown" oneditclick="Div01_edt_rtnTelNo_oneditclick" position="absolute 88 130 148 150" style="align:left middle;" anchor="default" readonly="true"/>
                    <Combo id="cbo_dealCoStCd" taborder="0" innerdataset="@ds_DMS1041" codecolumn="CM_CD_ID" datacolumn="CM_CD_NM" position="absolute 88 10 236 30" anchor="default" validate="title:거래처상태코드1111,required:true,maxlength:2" onitemchanged="Div01_Div03_cbo_dealCoStCd_onitemchanged"/>
                    <Static id="Static04" text="v4" class="guideTip" visible="false" position2="absolute l:118 w:29 t:30 h:4" positiontype="position2"/>
                    <Static id="Static07" text="w&#13;&#10;30" class="tip_guide" visible="false" position2="absolute l:67 w:30 t:-657 h:42" positiontype="position2"/>
                    <Static id="Static08" text="w&#13;&#10;30" class="tip_guide" visible="false" position2="absolute l:236 w:30 t:-1 h:130" positiontype="position2"/>
                    <Static id="Static09" text="v4" class="guideTip" visible="false" position2="absolute l:118 w:29 t:54 h:4" positiontype="position2"/>
                    <Static id="Static10" text="v4" class="guideTip" visible="false" position2="absolute l:118 w:29 t:78 h:4" positiontype="position2"/>
                    <Static id="Static11" text="v4" class="guideTip" visible="false" position2="absolute l:118 w:29 t:102 h:4" positiontype="position2"/>
                    <Static id="Static12" text="v4" class="guideTip" visible="false" position2="absolute l:118 w:29 t:126 h:4" positiontype="position2"/>
                    <MaskEdit id="edt_phonNum" taborder="5" type="string" onsetfocus="div_info_MaskEdit00_onsetfocus" onkillfocus="div_info_MaskEdit00_onkillfocus" position="absolute 333 58 432 78" style="align:left middle;" anchor="default"/>
                    <MaskEdit id="edt_faxNo" taborder="8" type="string" onsetfocus="div_info_MaskEdit00_onsetfocus" onkillfocus="div_info_MaskEdit00_onkillfocus2" position="absolute 88 106 187 126" style="align:left middle;" validate="" anchor="default"/>
                    <Static id="stc_frmlId09" text="은행명" class="sta_WFDA_detail_Label" position="absolute 8 154 67 174" anchor="default"/>
                    <Combo id="cbo_BANK_CD" taborder="12" innerdataset="ds_DMS166" codecolumn="CM_CD_ID" datacolumn="CM_CD_NM" onkeydown="div_search_cbo_msgType_onkeydown" position="absolute 88 154 216 174" validate="" anchor="default"/>
                    <Static id="stc_frmlId08" text="계좌번호" class="sta_WFDA_detail_Label" position="absolute 255 154 349 174" anchor="default"/>
                    <Edit id="edt_DEALCO_ACCO_NO" taborder="13" imemode="alpha" inputmode="upper" inputtype="number,digit" maxlength="20" onkeydown="div_search_edt_userNm_onkeydown" position="absolute 333 154 463 174" validate="" anchor="default"/>
                    <Static id="stc_frmlId00" text="ERP상태" class="sta_WFDA_detail_Label" position="absolute 8 178 78 198" anchor="default"/>
                    <Combo id="cbo_dealCoStCd00" taborder="15" innerdataset="ds_DMS239" codecolumn="CM_CD_ID" datacolumn="CM_CD_NM" position="absolute 88 178 333 198" validate="" readonly="true" anchor="default"/>
                  </Layout>
                </Layouts>
                <InitValue>
                  <Combo id="cbo_BANK_CD" index="0"/>
                </InitValue>
              </Div>
              <Div id="Div02" anchor="left top right" taborder="0" text="Div00" class="bg_detail2" position="absolute 9 29 553 95">
                <Layouts>
                  <Layout width="995" height="621">
                    <Static id="Static05" text="v10" class="guideTip" visible="false" position2="absolute l:820 w:30 t:0 h:10" positiontype="position2"/>
                    <Static id="Static09" text="v10" class="guideTip" visible="false" position2="absolute l:122 w:30 t:0 h:10" positiontype="position2"/>
                    <Static id="Static00" text="v10" class="guideTip" visible="false" position2="absolute l:127 w:30 t:54 h:10" positiontype="position2"/>
                    <Edit id="edt_posAgencyNm" taborder="2" readonly="false" enable="false" enableevent="false" position="absolute 390 10 496 30" anchor="default" imemode="hangul" maxlength="100"/>
                    <Button id="btn_dealSrch" taborder="3" class="btn_WFDA_search" enableevent="true" position="absolute 497 10 517 30" tooltiptype="hover" tooltiptext="소속대리점 검색" anchor="default" onclick="Div01_Div02_btn_dealSrch_onclick"/>
                    <Edit id="edt_posAgency" taborder="1" autoskip="true" enable="false" enableevent="false" position="absolute 320 10 389 30" anchor="default" readonly="false" class="Code" maxlength="2"/>
                    <Static id="stc_07" text="소속대리점" class="sta_WFDA_detail_Label" position="absolute 217 10 298 30" anchor="default"/>
                    <Combo id="cbo_dealCoCl1" taborder="0" innerdataset="@ds_DMS1031" codecolumn="CM_CD_ID" datacolumn="CM_CD_NM" enable="true" position="absolute 88 10 198 30" anchor="default" validate="title:거래처구분코드,required:true,maxlength:2" onitemchanged="Div01_Div02_cbo_dealCoCl1_onitemchanged"/>
                    <Edit id="edt_dealCoNm" taborder="5" position="absolute 88 34 198 54" anchor="default" validate="title:거래처명,required:true,maxlengthB:80" maxlength="30"/>
                    <Static id="stc_00" text="거래처명" class="sta_WFDA_detail_Label_P" position="absolute 9 34 90 54" anchor="default"/>
                    <Static id="stc_11" text="거래처구분" class="sta_WFDA_detail_Label_P" position="absolute 9 10 90 30" anchor="default"/>
                    <Static id="Static18" text="v4" class="guideTip" visible="false" position2="absolute l:600 w:406 t:166 h:4" positiontype="position2"/>
                    <Static id="Static15" text="v4" class="guideTip" visible="false" position2="absolute l:592 w:406 t:142 h:4" positiontype="position2"/>
                    <Static id="Static07" text="v4" class="guideTip" visible="false" position2="absolute l:599 w:406 t:118 h:4" positiontype="position2"/>
                    <Static id="Static01" text="v10" class="guideTip" visible="false" position2="absolute l:122 w:30 t:264 h:10" positiontype="position2"/>
                    <Button id="btn_reset" taborder="4" class="btn_WFSA_reset" position="absolute 518 10 538 30" tooltiptext="초기화" onclick="Div01_Div02_btn_reset_onclick" anchor="default"/>
                    <Static id="Static08" text="w&#13;&#10;30" class="tip_guide" visible="false" position2="absolute l:198 w:30 t:-1 h:130" positiontype="position2"/>
                    <Static id="stc_01" text="대리점조직코드" class="sta_WFDA_detail_Label" position="absolute 217 34 314 54" anchor="default"/>
                    <Edit id="edt_agnOrgCd" taborder="6" imemode="alpha" inputmode="upper" inputtype="numberandenglish" readonly="true" maxlength="10" position="absolute 320 34 430 54" anchor="default"/>
                  </Layout>
                </Layouts>
                <InitValue/>
              </Div>
              <Static id="Static07" text="v4" class="guideTip" visible="false" position2="absolute l:594 w:406 t:156 h:4" positiontype="position2"/>
              <Static id="Static15" text="v4" class="guideTip" visible="false" position2="absolute l:595 w:406 t:188 h:4" positiontype="position2"/>
              <Static id="stc_msgId01" text="거래처 기본정보" onclick="Div01_stc_msgId01_onclick" class="sub_title_02" position="absolute 19 6 139 26" anchor="top right"/>
              <Static id="stc_msgId02" text="추가정보" onclick="Div01_stc_msgId01_onclick" class="sub_title_02" position="absolute 19 101 139 121" anchor="top right"/>
              <Static id="Static12" text="v10" class="guideTip" visible="false" position2="absolute l:20 w:182 t:0 h:10" positiontype="position2"/>
              <Static id="Static04" text="h8" class="tip_guide" visible="false" position2="absolute l:22 w:42 t:21 h:8" positiontype="position2"/>
              <Static id="Static01" text="v29" class="guideTip" visible="false" position2="absolute l:232 w:130 t:0 h:29" positiontype="position2"/>
              <Static id="Static00" text="v29" class="guideTip" visible="false" position2="absolute l:248 w:130 t:95 h:29" positiontype="position2"/>
              <Static id="Static02" text="h8" class="tip_guide" visible="false" position2="absolute l:18 w:42 t:116 h:8" positiontype="position2"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Static id="Static05" text="W10" class="guideTip" visible="false" position2="absolute l:445 w:10 t:49 h:211" positiontype="position2"/>
        <Static id="Static20" text="W10" class="guideTip" visible="false" position2="absolute l:1009 w:10 t:72 h:371" positiontype="position2"/>
        <Button id="btn_excel" taborder="11" class="btn_common_excel" position="absolute 423 50 445 70" userdata="" anchor="top right" onclick="btn_excel_onclick" tooltiptext="엑셀출력"/>
        <ActiveX id="msie" progid="{8856F961-340A-11D0-A96B-00C04FD705A2}" useautobitmapcache="1" position2="absolute l:576 w:0 t:61 h:0" positiontype="position2" anchor="default" taborder="3" TitleChange="msie_TitleChange" visible="true" DownloadComplete="msie_DownloadComplete"/>
        <UserGrid id="grd_main" taborder="4" binddataset="ds_dealCo" readonly="true" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" autofittype="col" hideendline="col" nodataimage="URL('theme://Img/ico_WFDA_nodata.png')" position="absolute 0 73 445 488" anchor="all" tooltiptype="hover" style="focusborder:0 none #808080ff ;background:#ffffffff;color:#000000ff;cursor:hand;" _number="true" _status="false" _check="false" _checkColumnName="_checkcol" _checkedallevent="false" _nodataimage="true" _sort="true" _tooltip="true" oncellclick="grd_main_oncellclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="150"/>
                <Column size="90"/>
                <Column size="55"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="cursor:hand;" text="거래처코드"/>
                <Cell col="1" style="cursor:hand;" text="거래처구분"/>
                <Cell col="2" style="cursor:hand;" text="거래처명"/>
                <Cell col="3" style="cursor:hand;" text="사업자번호"/>
                <Cell col="4" style="cursor:hand;" text="거래상태"/>
              </Band>
              <Band id="body">
                <Cell class="Link" text="bind:DEALCO_CD"/>
                <Cell col="1" displaytype="combo" style="align:center;" class="alignLeft" text="bind:DEALCO_CL_1" combodataset="ds_DMS1031" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM"/>
                <Cell col="2" style="align:left middle;" text="bind:DEALCO_NM"/>
                <Cell col="3" displaytype="normal" edittype="none" text="bind:DEALCO_BLICENS_NO" mask="###-##-#####" calendardisplay="edit" calendardisplaynulltype="none"/>
                <Cell col="4" displaytype="combo" text="bind:DEALCO_ST_CD" combodataset="ds_DMS1041" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM" calendardisplaynulltype="none"/>
              </Band>
            </Format>
          </Formats>
        </UserGrid>
        <Button id="btn_reset" taborder="7" text="리셋" onclick="btn_reset_onclick" class="btn_common_resetTxt" position="absolute 866 50 916 70" anchor="top right"/>
        <Button id="btn_new" taborder="8" text="신규" onclick="btn_new_onclick" class="btn_common_addTxt" position="absolute 917 50 967 70" anchor="top right"/>
        <Button id="btn_save" taborder="9" text="저장" onclick="btn_save_onclick" class="btn_common_saveTxt" position="absolute 968 50 1018 70" anchor="top right"/>
        <Button id="btn_filter" taborder="10" onclick="btn_filter_onclick" class="btn_common_filter" position="absolute 400 50 422 70" anchor="top right" tooltiptext="필터" userautr=""/>
        <CommGridPage id="cgp_main" position2="absolute l:4.82% w:294 b:10 h:20" positiontype="position2" titletext="Grid Page" taborder="5" dragscrolltype="none"/>
        <CommGridPageCnt id="cgp_mainCnt" anchor="right bottom" titletext="Grid Page Count" taborder="6" position="absolute 345 498 445 518" style="background:transparent; "/>
        <Static id="Static16" text="w10" class="guideTip" visible="false" position2="absolute l:455 w:10 t:73 h:603" positiontype="position2"/>
        <Static id="Static10" text="W10" onclick="Static07_onclick" class="guideTip" visible="false" position2="absolute l:544 w:10 t:89 h:331" positiontype="position2"/>
        <Static id="Static01" text="w10" class="guideTip" visible="false" position2="absolute l:465 w:10 t:81 h:603" positiontype="position2"/>
        <Static id="Static03" text="W10" onclick="Static07_onclick" class="guideTip" visible="false" position2="absolute l:776 w:10 t:89 h:331" positiontype="position2"/>
        <UserGrid id="grd_mainAll" taborder="12" binddataset="ds_dealCoAll" readonly="true" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" autofittype="col" hideendline="col" nodataimage="URL('theme://Img/ico_WFDA_nodata.png')" oncellclick="grd_main_oncellclick" position="absolute 475 496 920 521" anchor="all" tooltiptype="hover" style="focusborder:0 none #808080ff ;background:#ffffffff;color:#000000ff;cursor:hand;" _number="true" _status="false" _check="false" _checkColumnName="_checkcol" _checkedallevent="false" _nodataimage="true" _sort="true" _tooltip="true" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="150"/>
                <Column size="90"/>
                <Column size="55"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="cursor:hand;" text="거래처코드"/>
                <Cell col="1" style="cursor:hand;" text="거래처구분"/>
                <Cell col="2" style="cursor:hand;" text="거래처명"/>
                <Cell col="3" style="cursor:hand;" text="사업자번호"/>
                <Cell col="4" style="cursor:hand;" text="거래상태"/>
              </Band>
              <Band id="body">
                <Cell class="Link" text="bind:DEALCO_CD"/>
                <Cell col="1" displaytype="combo" style="align:center;" class="alignLeft" text="bind:DEALCO_CL_1" combodataset="ds_DMS1031" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM"/>
                <Cell col="2" style="align:left middle;" text="bind:DEALCO_NM"/>
                <Cell col="3" displaytype="normal" edittype="none" text="bind:DEALCO_BLICENS_NO" mask="###-##-#####" calendardisplay="edit" calendardisplaynulltype="none"/>
                <Cell col="4" displaytype="combo" text="bind:DEALCO_ST_CD" combodataset="ds_DMS1041" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM" calendardisplaynulltype="none"/>
              </Band>
            </Format>
          </Formats>
        </UserGrid>
        <Button id="btn_excelAll" taborder="13" tabstop="false" text="엑셀다운" class="btn_common" position="absolute 796 50 865 70" anchor="top right" onclick="btn_excelAll_onclick" visible="false"/>
        <WebBrowser id="WebBrowser" text="WebBrowser" position="absolute 583 56 583 56" anchor="default" taborder="14" useautobitmapcache="1" cookiesynctype="always"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_dealCo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_dealCo_onrowposchanged">
        <ColumnInfo>
          <Column id="DEALCO_CD" type="STRING" size="10"/>
          <Column id="DEALCO_NM" type="STRING" size="80"/>
          <Column id="DEALCO_CL_1" type="STRING" size="2"/>
          <Column id="DEALCO_CL_2" type="STRING" size="2"/>
          <Column id="AGN_ORG_CD" type="STRING" size="10"/>
          <Column id="ORG_NM" type="STRING" size="256"/>
          <Column id="DEALCO_BLICENS_NO" type="STRING" size="10"/>
          <Column id="DEALCO_REPVE_NM" type="STRING" size="30"/>
          <Column id="BIZTYP" type="STRING" size="60"/>
          <Column id="EVNT" type="STRING" size="60"/>
          <Column id="DEALCO_ZIPCD" type="STRING" size="6"/>
          <Column id="DEALCO_ADDR" type="STRING" size="600"/>
          <Column id="DEALCO_MBLPHON_NO" type="STRING" size="14"/>
          <Column id="DEALCO_TEL_NO" type="STRING" size="14"/>
          <Column id="DEALCO_EMAIL_ADDR" type="STRING" size="100"/>
          <Column id="DEALCO_FAX_NO" type="STRING" size="14"/>
          <Column id="DEALCO_ST_CD" type="STRING" size="2"/>
          <Column id="DEAL_STA_DT" type="STRING" size="8"/>
          <Column id="DEAL_END_DT" type="STRING" size="8"/>
          <Column id="CHRGR_NM" type="STRING" size="30"/>
          <Column id="CHRGR_MBLPHON_NO" type="STRING" size="14"/>
          <Column id="EFF_STA_DT" type="STRING" size="14"/>
          <Column id="EFF_END_DT" type="STRING" size="14"/>
          <Column id="DEALCO_RMK" type="STRING" size="1000"/>
          <Column id="UKEY_AGN_CD" type="STRING" size="256"/>
          <Column id="UKEY_SUB_CD" type="STRING" size="10"/>
          <Column id="UKEY_CHNL_CD" type="STRING" size="10"/>
          <Column id="AFFIL_AGN" type="STRING" size="10"/>
          <Column id="AFFIL_AGN_NM" type="STRING" size="80"/>
          <Column id="HIGHR_DEALCO_CD" type="STRING" size="10"/>
          <Column id="DEL_YN" type="STRING" size="1"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="15"/>
          <Column id="FS_REG_DTM" type="STRING" size="30"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="15"/>
          <Column id="LS_CHG_DTM" type="STRING" size="30"/>
          <Column id="DEALCO_EMAIL_ADDR_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_REPVE_NM_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_MBLPHON_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_TEL_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_FAX_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_ADDR_ENPT" type="STRING" size="256"/>
          <Column id="CHRGR_MBLPHON_NO_ENPT" type="STRING" size="256"/>
          <Column id="CHRGR_NM_ENPT" type="STRING" size="256"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="DEALCO_ACCO_NO" type="STRING" size="256"/>
          <Column id="DEALCO_ACCO_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_FISCL_ST_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ncFieldMap" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DEALCO_CD" type="STRING" size="256"/>
          <Column id="DEALCO_NM" type="STRING" size="100"/>
          <Column id="DEALCO_CL_1" type="STRING" size="2"/>
          <Column id="DEALCO_ST_CD" type="STRING" size="2"/>
          <Column id="DEALCO_BLICENS_NO" type="STRING" size="10"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_DMS103" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS104" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS1031" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS1041" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prnInfoInq" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PRN_INFO_INQ_ITEM_CD" type="STRING" size="2"/>
          <Column id="PRN_INFO_INQ_CTT" type="STRING" size="2000"/>
          <Column id="PRN_INFO_INQ_ITEM_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchSecureInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FRM_ID" type="STRING" size="256"/>
          <Column id="INQ_OBJ_CL_CD" type="STRING" size="256"/>
          <Column id="INQ_OBJ_NO" type="STRING" size="256"/>
          <Column id="INQ_REQ_CHNL_CD" type="STRING" size="256"/>
          <Column id="INQ_REQ_IDF_NO" type="STRING" size="256"/>
          <Column id="REG_HST_YN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="REG_HST_YN">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_dealCoTemp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_dealCo_onrowposchanged">
        <ColumnInfo>
          <Column id="DEALCO_CD" type="STRING" size="10"/>
          <Column id="DEALCO_NM" type="STRING" size="80"/>
          <Column id="DEALCO_CL_1" type="STRING" size="2"/>
          <Column id="DEALCO_CL_2" type="STRING" size="2"/>
          <Column id="AGN_ORG_CD" type="STRING" size="10"/>
          <Column id="ORG_NM" type="STRING" size="256"/>
          <Column id="DEALCO_BLICENS_NO" type="STRING" size="10"/>
          <Column id="DEALCO_REPVE_NM" type="STRING" size="30"/>
          <Column id="BIZTYP" type="STRING" size="60"/>
          <Column id="EVNT" type="STRING" size="60"/>
          <Column id="DEALCO_ZIPCD" type="STRING" size="6"/>
          <Column id="DEALCO_ADDR" type="STRING" size="600"/>
          <Column id="DEALCO_MBLPHON_NO" type="STRING" size="14"/>
          <Column id="DEALCO_TEL_NO" type="STRING" size="14"/>
          <Column id="DEALCO_EMAIL_ADDR" type="STRING" size="100"/>
          <Column id="DEALCO_FAX_NO" type="STRING" size="14"/>
          <Column id="DEALCO_ST_CD" type="STRING" size="2"/>
          <Column id="DEAL_STA_DT" type="STRING" size="8"/>
          <Column id="DEAL_END_DT" type="STRING" size="8"/>
          <Column id="CHRGR_NM" type="STRING" size="30"/>
          <Column id="CHRGR_MBLPHON_NO" type="STRING" size="14"/>
          <Column id="EFF_STA_DT" type="STRING" size="14"/>
          <Column id="EFF_END_DT" type="STRING" size="14"/>
          <Column id="DEALCO_RMK" type="STRING" size="1000"/>
          <Column id="UKEY_AGN_CD" type="STRING" size="256"/>
          <Column id="UKEY_SUB_CD" type="STRING" size="10"/>
          <Column id="UKEY_CHNL_CD" type="STRING" size="10"/>
          <Column id="AFFIL_AGN" type="STRING" size="10"/>
          <Column id="AFFIL_AGN_NM" type="STRING" size="80"/>
          <Column id="HIGHR_DEALCO_CD" type="STRING" size="10"/>
          <Column id="DEL_YN" type="STRING" size="1"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="15"/>
          <Column id="FS_REG_DTM" type="STRING" size="30"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="15"/>
          <Column id="LS_CHG_DTM" type="STRING" size="30"/>
          <Column id="DEALCO_EMAIL_ADDR_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_REPVE_NM_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_MBLPHON_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_TEL_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_FAX_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_ADDR_ENPT" type="STRING" size="256"/>
          <Column id="CHRGR_MBLPHON_NO_ENPT" type="STRING" size="256"/>
          <Column id="CHRGR_NM_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_FISCL_ST_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dealCoAll" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_dealCo_onrowposchanged">
        <ColumnInfo>
          <Column id="DEALCO_CD" type="STRING" size="10"/>
          <Column id="DEALCO_NM" type="STRING" size="80"/>
          <Column id="DEALCO_CL_1" type="STRING" size="2"/>
          <Column id="DEALCO_CL_2" type="STRING" size="2"/>
          <Column id="AGN_ORG_CD" type="STRING" size="10"/>
          <Column id="ORG_NM" type="STRING" size="256"/>
          <Column id="DEALCO_BLICENS_NO" type="STRING" size="10"/>
          <Column id="DEALCO_REPVE_NM" type="STRING" size="30"/>
          <Column id="BIZTYP" type="STRING" size="60"/>
          <Column id="EVNT" type="STRING" size="60"/>
          <Column id="DEALCO_ZIPCD" type="STRING" size="6"/>
          <Column id="DEALCO_ADDR" type="STRING" size="600"/>
          <Column id="DEALCO_MBLPHON_NO" type="STRING" size="14"/>
          <Column id="DEALCO_TEL_NO" type="STRING" size="14"/>
          <Column id="DEALCO_EMAIL_ADDR" type="STRING" size="100"/>
          <Column id="DEALCO_FAX_NO" type="STRING" size="14"/>
          <Column id="DEALCO_ST_CD" type="STRING" size="2"/>
          <Column id="DEAL_STA_DT" type="STRING" size="8"/>
          <Column id="DEAL_END_DT" type="STRING" size="8"/>
          <Column id="CHRGR_NM" type="STRING" size="30"/>
          <Column id="CHRGR_MBLPHON_NO" type="STRING" size="14"/>
          <Column id="EFF_STA_DT" type="STRING" size="14"/>
          <Column id="EFF_END_DT" type="STRING" size="14"/>
          <Column id="DEALCO_RMK" type="STRING" size="1000"/>
          <Column id="UKEY_AGN_CD" type="STRING" size="256"/>
          <Column id="UKEY_SUB_CD" type="STRING" size="10"/>
          <Column id="UKEY_CHNL_CD" type="STRING" size="10"/>
          <Column id="AFFIL_AGN" type="STRING" size="10"/>
          <Column id="AFFIL_AGN_NM" type="STRING" size="80"/>
          <Column id="HIGHR_DEALCO_CD" type="STRING" size="10"/>
          <Column id="DEL_YN" type="STRING" size="1"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="15"/>
          <Column id="FS_REG_DTM" type="STRING" size="30"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="15"/>
          <Column id="LS_CHG_DTM" type="STRING" size="30"/>
          <Column id="DEALCO_EMAIL_ADDR_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_REPVE_NM_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_MBLPHON_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_TEL_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_FAX_NO_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_ADDR_ENPT" type="STRING" size="256"/>
          <Column id="CHRGR_MBLPHON_NO_ENPT" type="STRING" size="256"/>
          <Column id="CHRGR_NM_ENPT" type="STRING" size="256"/>
          <Column id="DEALCO_FISCL_ST_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS166" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS239" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item6" compid="div_search.msk_bizNum" propid="value" datasetid="ds_ncFieldMap" columnid="DEALCO_BLICENS_NO"/>
      <BindItem id="item2" compid="Div01.Div02.cbo_dealCoCl1" propid="value" datasetid="ds_dealCo" columnid="DEALCO_CL_1"/>
      <BindItem id="item7" compid="Div01.Div03.edt_bizNum" propid="value" datasetid="ds_dealCo" columnid="DEALCO_BLICENS_NO"/>
      <BindItem id="item5" compid="Div01.Div03.cal_dealStaDt" propid="value" datasetid="ds_dealCo" columnid="DEAL_STA_DT"/>
      <BindItem id="item8" compid="Div01.Div03.cal_dealEndDt" propid="value" datasetid="ds_dealCo" columnid="DEAL_END_DT"/>
      <BindItem id="item10" compid="Div01.Div02.edt_dealCoNm" propid="value" datasetid="ds_dealCo" columnid="DEALCO_NM"/>
      <BindItem id="item11" compid="Div01.Div02.edt_posAgency" propid="value" datasetid="ds_dealCo" columnid="AFFIL_AGN"/>
      <BindItem id="item13" compid="Div01.Div03.edt_typOfBiz" propid="value" datasetid="ds_dealCo" columnid="EVNT"/>
      <BindItem id="item14" compid="Div01.Div03.edt_bizCon" propid="value" datasetid="ds_dealCo" columnid="BIZTYP"/>
      <BindItem id="item17" compid="Div01.Div03.edt_repUserNm" propid="value" datasetid="ds_dealCo" columnid="DEALCO_REPVE_NM"/>
      <BindItem id="item18" compid="Div01.Div03.edt_zipNo" propid="value" datasetid="ds_dealCo" columnid="DEALCO_ZIPCD"/>
      <BindItem id="item19" compid="Div01.Div03.edt_addr" propid="value" datasetid="ds_dealCo" columnid="DEALCO_ADDR"/>
      <BindItem id="item20" compid="div_search.edt_dealCoNm" propid="value" datasetid="ds_ncFieldMap" columnid="DEALCO_NM"/>
      <BindItem id="item21" compid="div_search.cbo_dealCoCl1" propid="value" datasetid="ds_ncFieldMap" columnid="DEALCO_CL_1"/>
      <BindItem id="item22" compid="div_search.cbo_dealCoStCd" propid="value" datasetid="ds_ncFieldMap" columnid="DEALCO_ST_CD"/>
      <BindItem id="item0" compid="Div01.Div03.cbo_dealCoStCd" propid="value" datasetid="ds_dealCo" columnid="DEALCO_ST_CD"/>
      <BindItem id="item1" compid="Div01.Div02.edt_posAgencyNm" propid="value" datasetid="ds_dealCo" columnid="AFFIL_AGN_NM"/>
      <BindItem id="item3" compid="div_search.edt_dealCoCd" propid="value" datasetid="ds_ncFieldMap" columnid="DEALCO_CD"/>
      <BindItem id="item4" compid="Div01.Div03.edt_phonNum" propid="value" datasetid="ds_dealCo" columnid="DEALCO_TEL_NO"/>
      <BindItem id="item9" compid="Div01.Div03.edt_faxNo" propid="value" datasetid="ds_dealCo" columnid="DEALCO_FAX_NO"/>
      <BindItem id="item12" compid="Div01.Div02.edt_agnOrgCd" propid="value" datasetid="ds_dealCo" columnid="AGN_ORG_CD"/>
      <BindItem id="item15" compid="Div01.Div03.cbo_BANK_CD" propid="value" datasetid="ds_dealCo" columnid="BANK_CD"/>
      <BindItem id="item16" compid="Div01.Div03.edt_DEALCO_ACCO_NO" propid="value" datasetid="ds_dealCo" columnid="DEALCO_ACCO_NO"/>
      <BindItem id="item24" compid="Div01.Div03.cbo_dealCoStCd00" propid="value" datasetid="ds_dealCo" columnid="DEALCO_FISCL_ST_CD"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 * 01. 업무구분 : 기준정보
 * 02. 화면 : DealCoMgmtM.xfdl
 * 03. 화면 설명 : 거래처관리
 * 04. 관련 화면/서비스 : 
 * 05. 작성자 : LeeYoungJin
 * 05. 작성일 : 2015-06-29
 * 07. 수정이력 :
 ************************************************************************************************
 *     수정일        이  름    사유
 ************************************************************************************************
 *     2015.06.29    LeeYoungJin    최초 작성
 ************************************************************************************************
 */
 
/*===============================================================================================
 * [ PART 1 ] Form에서 Include 할 라이브러리(xjs)파일 정의
================================================================================================*/
include "LIB::common.xjs"; //공통함수 호출

/*===============================================================================================
 * [ PART 2 ] Form에서 사용될 전역변수를 선언
================================================================================================*/

 var pv_sPtrn = "";
 var g_row_type = "";
 var g_row = -1;
 var dc_yn = "";
 var curPage = 1;
 var loc = gds_svcconfig.lookup("DOMAIN_CD", gv_domainCd, gv_RunMode+"Url");

/*===============================================================================================
 * [ PART 3 ] Form Event 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : Form Load Event
-----------------------------------------------------------------------------------------------*/
function Form_onload(obj:Form, e:LoadEventInfo)
{
	//공통 Form 초기화
	gfn_setInitForm(obj, e, "FBI002M");

 	//Form 초기 개발자 셋팅
 	//공통코드 초기화
 	fn_setInitCode(obj, e);
 	//그리드 초기화
 	fn_setInitGrid(obj, e);
 	//기본값 초기화
 	fn_setInitForm(obj, e);
 	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : Form 종료전 Check 함수(공통)
-----------------------------------------------------------------------------------------------*/
function Form_checkBeforeClose()
{
	//변경된 Dataset검증
	if ( gfn_formBeforeOnClose(this, "ds_dealCo") ) {
		return true;
	} else {
		return false;
	}
}

/*===============================================================================================
 * [ PART 4 ] Load 후 초기설정
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 공통코드 초기화
-----------------------------------------------------------------------------------------------*/
function fn_setInitCode(obj:Form, e:LoadEventInfo)
{
	var strCode =  "DMS103=ds_DMS103=A";
	   strCode += ",DMS104=ds_DMS104=A";
	   strCode += ",DMS103=ds_DMS1031=N";
	   strCode += ",DMS104=ds_DMS1041=N";
	   strCode += ",DMS239=ds_DMS239=N";
	   strCode += ",DMS166=ds_DMS166=S";
						
	gfn_getCodeDs( this
				  , strCode
				  ,"fn_afterCodeCallBack");
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 공통코드 호출 후 처리
-----------------------------------------------------------------------------------------------*/
function fn_afterCodeCallBack()
{		  	
	div_search.cbo_dealCoCl1.index=0;
	div_search.cbo_dealCoStCd.index=0;
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 그리드 초기화
-----------------------------------------------------------------------------------------------*/
function fn_setInitGrid(obj:Form, e:LoadEventInfo)
{
	//그리드 페이징 초기화
	cgp_main.setPageInit("fn_selectPageExec", false);
	cgp_mainCnt.setPageNoCnt(0, 0, 0);	//PageNo Count
	
	//기본페이지 설정
	page = 1;   
	
	// 그리드 초기화 
	//gfn_initGrid(objGrid:UserGrid, bReadonly, bSortable, bTooltip, sSelectType, innerDs, sPage, sPageSize, sTotCnt);
	gfn_initGrid(grd_main, true, true, true, "row", null);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 페이지 Click시 페이지조회
 * param   : iTotalRowCount - 전체 Row수
 * param   : iUnitSelRowNo  - 페이지당 Row수
 * param   : iCurrPage      - 현재 페이지
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_selectPageExec(iTotalRowCount, iUnitSelRowNo, iCurrPage)
{
	//trace("페이징처리::total row="+iTotalRowCount+"::unit row="+iUnitSelRowNo+"::current page="+iCurrPage);
	//페이징처리
	page = iCurrPage;
	fn_searchMain();
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 기본값 설정
-----------------------------------------------------------------------------------------------*/
function fn_setInitForm(obj:Form, e:LoadEventInfo)
{
	div_search.edt_dealCoNm.setFocus();
	var URL1="http://"+loc+"/jusoBlank.jsp";
	msie.Navigate2(URL1);
}

/*===============================================================================================
 * [ PART 5 ] Transaction 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 메인조회
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_searchMain()
{
	var sSvcID		 = "searchMain";
	var sTrID		 = "PBIDealCoMgmt_pInqDealCoLst";
	var sPtrn		 = "R";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "ncFieldMap=ds_ncFieldMap";
	var sOutputDs	 = "ds_dealCo=RS_DEALCO_LIST";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";

	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 메인조회
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_searchMainAll()
{
	var sSvcID		 = "searchMainAll";
	var sTrID		 = "PBIDealCoMgmt_pInqDealCoLst";
	var sPtrn		 = "R";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "ncFieldMap=ds_ncFieldMap";
	var sOutputDs	 = "ds_dealCoTemp=RS_DEALCO_LIST";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";

	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}

// 액셀전체다운로드 다음처리
function fn_nextLoop()
{
	
	if ( total_record_cnt <=  page * page_size ) {
		page_size = 50;
		page = curPage;
		gfn_baseExcelExpert(grd_mainAll,"거래처목록","거래처목록");
	} else {
		//다음페이지 조회
		page++;
		fn_searchMainAll();
	} 
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 메인저장 (insert, update)
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_saveMain()
{	
	var sSvcID		 = "saveMain";
	var sTrID		 = "PBIDealCoMgmt_pSaveDealCo";
	var sPtrn		 = ds_dealCo.getRowType(ds_dealCo.rowposition) == Dataset.ROWTYPE_INSERT? "I" : "U";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "RS_DEALCO_LIST=ds_dealCo:u";
	var sOutputDs	 = "";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	pv_sPtrn         = sPtrn;  // 저장Type을 전역변수로 저장
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}

/*===============================================================================================
 * [ PART 6 ] CallBack 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : Transaction CallBack
 * param   : sSvcID, iErrorCode, sErrorMsg(ncMsgId,ncMsg)
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_callBack(sSvcID, iErrorCode, sErrorMsg, ncMsgId, ncMsg)
{
 	switch(sSvcID) {
		case "searchMain" : 
			//페이징 관련셋팅
			//ds_dealCo.appendData(ds_dealCoTempPage, true);	
			//조회된 첫번째row로 setFocus 
			ds_dealCo.rowposition = (page-1) * page_size ;
			gfn_setGridTitleCountPaging(stc_subTitle01, total_record_cnt);
			cgp_main.setPageNo(page_size, total_record_cnt, page);	//PageNo
			cgp_mainCnt.setPageNoCnt(page_size, total_record_cnt, page);	//PageNo Count
			div_search.edt_dealCoNm.setFocus();
			gfn_tel_onkillfocus(Div01.Div03.edt_phonNum);
			if(!gfn_isNull(Div01.Div03.edt_faxNo.value)) gfn_tel_onkillfocus(Div01.Div03.edt_faxNo);
			break;
			
		case "searchMainAll" : 
			ds_dealCoAll.appendData(ds_dealCoTemp,true);
			fn_nextLoop();
			break;
			
		case "saveMain" : 
			if ( iErrorCode == 0 ) {
				gfn_message("A","DMS00000","I");	//MSGI0001 : 정상 처리되었습니다.
				if (pv_sPtrn == "I") {		// 신규등록일 경우에만 재조회
					ds_ncFieldMap.setColumn(0,"DEALCO_NM", ds_dealCo.getColumn(ds_dealCo.rowposition,"DEALCO_NM"));
					ds_ncFieldMap.setColumn(0,"DEALCO_CL_1", ds_dealCo.getColumn(ds_dealCo.rowposition,"DEALCO_CL_1"));
					ds_ncFieldMap.setColumn(0,"DEALCO_ST_CD", ds_dealCo.getColumn(ds_dealCo.rowposition,"DEALCO_ST_CD"));
					ds_ncFieldMap.setColumn(0,"DEALCO_BLICENS_NO", ds_dealCo.getColumn(ds_dealCo.rowposition,"DEALCO_BLICENS_NO"));
					btn_search_onclick();
				} else if (pv_sPtrn == "D") {
					btn_search_onclick();
				}
				Div01.Div02.edt_agnOrgCd.readonly = true;
			}
			break;
			
		case "searchSecureInfo" : 
			if ( iErrorCode == 0 ) {
			    //상세사용자설정
			    fn_setDecodeInfo(true);
			}
			break;
			
		default :
			break;
	}
}

/*===============================================================================================
 * [ PART 7 ] Main Button Event
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : search
-----------------------------------------------------------------------------------------------*/
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	// 입력 항목 Validate Check
	if (!gfn_getValidateCompList(div_search)) {	
		return false;
	}
	gfn_dsTrim(ds_ncFieldMap);
	ds_dealCo.clearData();
	page = 1;
	fn_searchMain();
	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : reset
-----------------------------------------------------------------------------------------------*/
function btn_reset_onclick(obj:Button,  e:ClickEventInfo)
{
	if ( ds_dealCo.rowposition != -1 && ds_dealCo.getRowType(ds_dealCo.rowposition) != Dataset.ROWTYPE_NORMAL) {		
		if (gfn_message("C","DMS00024","Q")){ //편집중인 데이터가 있습니다. 계속하시겠습니까?
			ds_dealCo.reset();
			Div01.Div02.edt_agnOrgCd.readonly = true;
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : new
-----------------------------------------------------------------------------------------------*/
function btn_new_onclick(obj:Button,  e:ClickEventInfo)
{
	if ( ds_dealCo.rowposition != -1 && ds_dealCo.getRowType(ds_dealCo.rowposition) != Dataset.ROWTYPE_NORMAL) {		
		if (gfn_message("C","DMS00024","Q")){ //편집중인 데이터가 있습니다. 계속하시겠습니까?
			ds_dealCo.reset();
			var row = ds_dealCo.addRow();
			ds_dealCo.rowposition = row;
			ds_dealCo.setColumn(ds_dealCo.rowposition,'DEL_YN', 'N');
			Div01.Div02.edt_dealCoNm.setFocus();
			ds_dealCo.setRowType(ds_dealCo.rowposition, Dataset.ROWTYPE_INSERT);
			Div01.Div02.edt_agnOrgCd.readonly = true;
		}
	} else {
		var row = ds_dealCo.addRow();
		ds_dealCo.rowposition = row;
		ds_dealCo.setColumn(ds_dealCo.rowposition,'DEL_YN', 'N');
		Div01.Div02.edt_dealCoNm.setFocus();
		ds_dealCo.setRowType(ds_dealCo.rowposition, Dataset.ROWTYPE_INSERT);
		Div01.Div02.edt_agnOrgCd.readonly = true;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : print
-----------------------------------------------------------------------------------------------*/
function btn_print_onclick(obj:Button,  e:ClickEventInfo)
{
	//사용안함 alert("Report 출력");
}

/*----------------------------------------------------------------------------------------------
 * 설명   : save
-----------------------------------------------------------------------------------------------*/
function btn_save_onclick(obj:Button,  e:ClickEventInfo)
{
	//alert(gfn_getLength(Div01.Div02.edt_dealCoNm.value)+"/"+gfn_getLengthB2(gfn_getLength(Div01.Div02.edt_dealCoNm.value)));
	if ( fn_chkBeforeSave() ) fn_saveMain();
}

/*----------------------------------------------------------------------------------------------
 * 설명   : grid filter
-----------------------------------------------------------------------------------------------*/
function btn_filter_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_toggleGridFilter(grd_main);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : grid excel
-----------------------------------------------------------------------------------------------*/
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	if (grd_main.rowcount == 0){
		gfn_message("A","DMS00021","I"); //조회된 정보가 없습니다.
	} else {
		gfn_baseExcelExpert(grd_main,"거래처목록","거래처목록");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : grid expand
-----------------------------------------------------------------------------------------------*/
function btn_expand_onclick(obj:Button,  e:ClickEventInfo)
{
	//사용안함 alert("그리드 확장");
}

/*===============================================================================================
 * [ PART 8 ] Event
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 조회조건에서 엔터키가 눌러졌을때 조회
-----------------------------------------------------------------------------------------------*/
function div_search_edt_dealCoNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == KEYCODE_ENTER) {
		btn_search.setFocus();
		btn_search_onclick();
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 조회조건에서 엔터키가 눌러졌을때 조회
-----------------------------------------------------------------------------------------------*/
function div_search_msk_bizNum_onkeydown(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == KEYCODE_ENTER) {
		btn_search.setFocus();
		btn_search_onclick();
	}	
}

/*===============================================================================================
 * [ PART 9 ] User Defined
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 저장전 유효성 검사
 * param   : 
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function fn_chkBeforeSave()	
{
	//저장전 수정,신규입력데이터의 trim처리 
	gfn_dsTrim(ds_dealCo);
	
	if(!gfn_isUpdated(ds_dealCo))//저장할 테이타셋
	{
		gfn_message("A","DMS00022","I");	//변경된 정보가 없습니다.
		return false;
	}
	
	if (!gfn_getValidateCompList(Div01)) {	
		return false;
	}
	
	if(!gfn_checkPhone(Div01.Div03.edt_phonNum.value) ){
		gfn_message("A","DMS00080","I" );	//전화번호 형식이 맞지 않습니다.
		Div01.Div03.edt_phonNum.setFocus();
		return false;
	}
	
	if(!gfn_isNull(Div01.Div03.edt_faxNo.value) && !gfn_checkPhone(Div01.Div03.edt_faxNo.value) ){
		gfn_message("A","DMS00081","I" );	//팩스번호 형식이 맞지 않습니다.
		Div01.Div03.edt_faxNo.setFocus();
		return false;
	}
	
	if (Div01.Div03.cbo_dealCoStCd.value=="05" && gfn_isNull(Div01.Div03.cal_dealEndDt.value)) {	
		gfn_message("A","DMS00062","I");	//거래종료시 거래종료일을 입력하셔야 합니다.
		return false;
	}
	
	if (Div01.Div02.cbo_dealCoCl1.value=="A1" && gfn_isNull(Div01.Div02.edt_agnOrgCd.value)) {	
		gfn_message("A","DMS00098","I");	//거래처구분이 대리점일 경우 대리점조직코드는 필수입니다.
		return false;
	}
	
	if (!gfn_message("C","DMS00056","Q")){ //UKEY 연계데이터입니다.저장하시겠습니까?
		return false;
	}
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명   : Row Change 이벤트
 * param   : obj - Dataset
 * param   : e  - DSRowPosChangeEventInfo
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function ds_dealCo_canrowposchange(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	if ( e.oldrow != -1 && obj.getRowType(e.oldrow) != Dataset.ROWTYPE_NORMAL ) {		
		if (gfn_message("C","DMS00024","Q")){ //편집중인 데이터가 있습니다. 계속하시겠습니까?
			obj.reset();
			//Div01.edt_msgId.readonly = true;
		} else {
			return false;
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 주소검색(행정자치부 통합검색창 연계)
-----------------------------------------------------------------------------------------------*/
function Div01_Div03_btn_addrSrch_onclick(obj:Button,  e:ClickEventInfo)
{
	var URL1="http://"+loc+"/juso.jsp";
	//var objWebBrowser = new WebBrowser("WebBrowser00", 10, 10, 100, 100);
	//objWebBrowser.init("WebBrowser00", 10, 10, 100, 100);
	//objWebBrowser.url="javascript:window.open('http://"+loc+"/juso.jsp','popup','top=100px,left=100px,height=600px,width=800px')";
	//objWebBrowser.show(); 
	//WebBrowser.url="javascript:window.open('http://"+loc+"/juso.jsp','popup','top=100px,left=100px,height=600px,width=800px')";
	
	//WebBrowser.url= URL1;
	//WebBrowser.go();
	//msie.url = URL1;
	//msie.Navigate2.go();
	
	msie.Navigate2(URL1);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 주소검색후 우편번호,주소 셋팅 
-----------------------------------------------------------------------------------------------*/
function msie_TitleChange(obj:ActiveX, e)
{
	if (e.Text != "로그인") {
		var addr = e.Text.split("|");
		Div01.Div03.edt_zipNo.value = gfn_removeHyphen(addr[1]);
		Div01.Div03.edt_addr.value = addr[0];
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 소속대리점 검색
-----------------------------------------------------------------------------------------------*/
function Div01_Div02_btn_dealSrch_onclick(obj:Button,  e:ClickEventInfo)
{
	//alert("소속대리점 검색 팝업");
	var sParam01 = Div01.Div02.edt_posAgencyNm.value;
	var sParam02 = "";
	var sParam03 = "";
	var sParam04 = "";
	if ( e == null ) {
		sParam04 = "key";
	} else {
		sParam04 = "button";
	}
	var arrArgs = {argAutoSelect:true, argCallProgram:"FBI002M", argParam01:sParam01, argParam02:sParam02, argParam03:sParam03, argParam04:sParam04};
	var sRtnVal = gfn_dialog("FBI004P", arrArgs);

	//팝업에서 입력받은 값 리턴
	if ( gfn_isNull(sRtnVal) || sRtnVal == "cancel" ) {
		//취소시 값 제거
		Div01.Div02.edt_posAgency.value = "";
		Div01.Div02.edt_posAgencyNm.value = "";
	} else {	//Object이용시
		Div01.Div02.edt_posAgency.value    = sRtnVal["supDealCoCd"];
		Div01.Div02.edt_posAgencyNm.value  = sRtnVal["supDealCoNm"];
	//	btn_search_onclick();
	}
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 소속대리점 검색리셋
-----------------------------------------------------------------------------------------------*/
function Div01_Div02_btn_reset_onclick(obj:Button,  e:ClickEventInfo)
{
	Div01.Div02.edt_posAgency.value = "";
	Div01.Div02.edt_posAgencyNm.value = "";
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 거래상태가 거래종료가 아닐때 거래종료일 널처리
-----------------------------------------------------------------------------------------------*/
function Div01_Div03_cbo_dealCoStCd_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if ( Div01.Div03.cbo_dealCoStCd.value != "05" ) {
		Div01.Div03.cal_dealEndDt.value = "";
		Div01.Div03.cal_dealEndDt.readonly = true;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 전화번호 masking 처리 Event
 * param   : 
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function div_info_MaskEdit00_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
	//전화번호 masking 처리 onkillfocus Event
	gfn_tel_onkillfocus(obj);
}

function div_info_MaskEdit00_onkillfocus2(obj:MaskEdit, e:KillFocusEventInfo)
{
	//전화번호 masking 처리 onkillfocus Event
	gfn_tel_onkillfocus(obj);
}

function div_info_MaskEdit00_onsetfocus(obj:MaskEdit, e:SetFocusEventInfo)
{
	//전화번호 masking 처리 onsetfocus Event
	gfn_tel_onsetfocus(obj);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 전화번호 마스킹
-----------------------------------------------------------------------------------------------*/
function grd_main_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	//gfn_tel_onkillfocus(Div01.Div03.edt_phonNum);
	//if(!gfn_isNull(Div01.Div03.edt_faxNo.value)) gfn_tel_onkillfocus(Div01.Div03.edt_faxNo);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 복호화
-----------------------------------------------------------------------------------------------*/
function ds_dealCo_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	//trace("ds_dealCo_onrowposchanged");
	btn_searchDecodeList();	//복호화
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 복호화
-----------------------------------------------------------------------------------------------*/
function btn_searchDecodeList()
{	
	g_row = ds_dealCo.rowposition;
	ds_prnInfoInq.clearData();

	//대표자명
	if(!gfn_isNull(ds_dealCo.getColumn(g_row,"DEALCO_REPVE_NM_ENPT"))) {
		nRow = ds_prnInfoInq.addRow();
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_ITEM_CD",DMS007_NAME);
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_CTT", ds_dealCo.getColumn(g_row,"DEALCO_REPVE_NM_ENPT"));
	}

	//전화번호 
	if(!gfn_isNull(ds_dealCo.getColumn(g_row,"DEALCO_TEL_NO_ENPT"))) {
		nRow = ds_prnInfoInq.addRow();
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_ITEM_CD",DMS007_TEL);
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_CTT", ds_dealCo.getColumn(g_row,"DEALCO_TEL_NO_ENPT"));
	}
	
	
	//팩스번호
	if(!gfn_isNull(ds_dealCo.getColumn(g_row,"DEALCO_FAX_NO_ENPT"))) {
		nRow = ds_prnInfoInq.addRow();
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_ITEM_CD",DMS007_FAX);
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_CTT", ds_dealCo.getColumn(g_row,"DEALCO_FAX_NO_ENPT"));
	}
	
	//주소
	if(!gfn_isNull(ds_dealCo.getColumn(g_row,"DEALCO_ADDR_ENPT"))) {
		nRow = ds_prnInfoInq.addRow();
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_ITEM_CD",DMS007_ADDR);
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_CTT", ds_dealCo.getColumn(g_row,"DEALCO_ADDR_ENPT"));
	}
	
	//계좌번호
	if(!gfn_isNull(ds_dealCo.getColumn(g_row,"DEALCO_ACCO_NO_ENPT"))) {
		nRow = ds_prnInfoInq.addRow();
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_ITEM_CD",DMS007_ACCOUNT);
		ds_prnInfoInq.setColumn(nRow ,"PRN_INFO_INQ_CTT", ds_dealCo.getColumn(g_row,"DEALCO_ACCO_NO_ENPT"));
	}


	if(ds_prnInfoInq.getRowCount()>0){
	
		ds_searchSecureInfo.clearData();
		ds_searchSecureInfo.insertRow(0);
		ds_searchSecureInfo.setColumn(0,'FRM_ID',objID);
		ds_searchSecureInfo.setColumn(0,'INQ_OBJ_NO',"SVC0002");  //조회대상번호 
		ds_searchSecureInfo.setColumn(0,'REG_HST_YN','Y'); //이력여부
		
		gfn_searchSecureInfo("searchSecureInfo", "fn_callBack", "ds_prnInfoInq", "ds_searchSecureInfo" ); //개인정보 조회 
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   :  복호화 처리
-----------------------------------------------------------------------------------------------*/
function fn_setDecodeInfo(bSecureYn)
{  
	//개인정보조회 콜백함수에서 호출한 경우 
	if(!gfn_isNull(bSecureYn) && bSecureYn){
		var sName = ds_prnInfoInq.lookup("PRN_INFO_INQ_ITEM_CD", DMS007_NAME,"PRN_INFO_INQ_CTT");    
		var sTel =  ds_prnInfoInq.lookup("PRN_INFO_INQ_ITEM_CD", DMS007_TEL,"PRN_INFO_INQ_CTT");
		var sFax = ds_prnInfoInq.lookup("PRN_INFO_INQ_ITEM_CD", DMS007_FAX,"PRN_INFO_INQ_CTT");    
		var sAddr =  ds_prnInfoInq.lookup("PRN_INFO_INQ_ITEM_CD", DMS007_ADDR,"PRN_INFO_INQ_CTT");
		var sAccNo =  ds_prnInfoInq.lookup("PRN_INFO_INQ_ITEM_CD", DMS007_ACCOUNT,"PRN_INFO_INQ_CTT");
		ds_dealCo.updatecontrol = false;
		ds_dealCo.setColumn(g_row, "DEALCO_REPVE_NM", "");
		ds_dealCo.setColumn(g_row, "DEALCO_TEL_NO", "");
		ds_dealCo.setColumn(g_row, "DEALCO_FAX_NO", "");
		ds_dealCo.setColumn(g_row, "DEALCO_ADDR", "");
		ds_dealCo.setColumn(g_row, "DEALCO_ACCO_NO", "");
		if(!gfn_isEmpty(sName)) ds_dealCo.setColumn(g_row, "DEALCO_REPVE_NM", sName);
		if(!gfn_isEmpty(sTel)) ds_dealCo.setColumn(g_row, "DEALCO_TEL_NO",sTel);
		if(!gfn_isEmpty(sFax)) ds_dealCo.setColumn(g_row, "DEALCO_FAX_NO",sFax);
		if(!gfn_isEmpty(sAddr)) ds_dealCo.setColumn(g_row, "DEALCO_ADDR",sAddr);
		if(!gfn_isEmpty(sAccNo)) ds_dealCo.setColumn(g_row, "DEALCO_ACCO_NO",sAccNo);
		ds_dealCo.setRowType(g_row, Dataset.ROWTYPE_NORMAL);
		//trace("decode:"+ds_dealCo.getRowType(g_row));
		ds_dealCo.updatecontrol = true;
		
		//g_row_type = ds_dealCo.getRowType(g_row);
		
		//ds_dealCo.setRowType(g_row, g_row_type);
		//g_row = -1;
		//g_row_type = "";
		//grd_main.redraw();
		//rowType 초기화 
		//ds_dealCo.setRowType(g_row, Dataset.ROWTYPE_NORMAL);
		//trace("after decode/"+ds_dealCo.getColumn(g_row,"DEALCO_REPVE_NM"));
		//trace(ds_dealCo.getRowType(g_row));
		dc_yn = "Y";
	}
	gfn_tel_onkillfocus(Div01.Div03.edt_phonNum);
	if(!gfn_isNull(Div01.Div03.edt_faxNo.value)) gfn_tel_onkillfocus(Div01.Div03.edt_faxNo);
}

/*----------------------------------------------------------------------------------------------
 * 설명   :  거래처구분 변경
-----------------------------------------------------------------------------------------------*/
function Div01_Div02_cbo_dealCoCl1_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if ( ds_dealCo.getRowType(ds_dealCo.rowposition) == Dataset.ROWTYPE_INSERT && Div01.Div02.cbo_dealCoCl1.value == "A1" ) {
		Div01.Div02.edt_agnOrgCd.readonly = false;
	} else {
		Div01.Div02.edt_agnOrgCd.readonly = true;
	}
}
 //전체액셀다운로드
function btn_excelAll_onclick(obj:Button,  e:ClickEventInfo)
{
	// 입력 항목 Validate Check
	if (!gfn_getValidateCompList(div_search)) {	
		return false;
	}
	gfn_dsTrim(ds_ncFieldMap);
	ds_dealCoAll.clearData();
	curPage = page;
	page = 1;
	page_size = 10000;
	
	fn_searchMainAll();
}

function msie_DownloadComplete(obj:ActiveX)
{
	msie.Document.cookie = "JSESSIONID=" + JSESSIONID + ";";
}
]]></Script>
  </Form>
</FDL>
