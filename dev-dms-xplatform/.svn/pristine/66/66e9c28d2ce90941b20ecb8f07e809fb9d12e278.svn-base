<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="CommCalendarPred" classname="CommCalendarPred" inheritanceid="" position="absolute 0 0 205 20" style="background:transparent;" scrollbars="none" onload="CommCalendarView_onload" ontimer="" onmousemove="" titletext="From_To달력">
    <Layouts>
      <Layout>
        <PopupDiv id="PopCalPred" visible="false" position="absolute 0 28 367 303" oncloseup="PopCalPred_oncloseup" taborder="2" style="border:1 solid #bbbbbbff ;" scrollbars="none">
          <Layouts>
            <Layout>
              <Grid id="grd_calFrom" class="grd_calendar" taborder="1" binddataset="ds_calFrom" scrollbars="none" useinputpanel="false" selecttype="cell" autofittype="col" useselcolor="false" oncellclick="PopCalPred_grd_cal_oncellclick" position="absolute -1 22 183 185" anchor="default" oncelldblclick="PopCalPred_grd_cal_oncelldblclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                    </Columns>
                    <Rows>
                      <Row size="25" band="head"/>
                      <Row size="22"/>
                    </Rows>
                    <Band id="head" style="cellfont:Dotum,9;">
                      <Cell style="color:#ef3f30ff;color2:#ef3f30;selectcolor:#ef3f30ff;" text="일"/>
                      <Cell col="1" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="월"/>
                      <Cell col="2" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="화"/>
                      <Cell col="3" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="수"/>
                      <Cell col="4" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="목"/>
                      <Cell col="5" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="금"/>
                      <Cell col="6" style="background2: ;color:#31a3dcff;color2:#31a3dcff;selectcolor:#31a3dcff;" text="토"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:BIND(bgc0);background2:BIND(bgc0);color:EXPR((chk0==0)?'#c4c4c4':(bgc0=='#31a3dc')?'#ffffff':'#ef3f30');color2:EXPR((chk0==0)?'#c4c4c4':(bgc0=='#31a3dc')?'#ffffff':'#ef3f30');selectcolor:#ffffffff;" text="bind:day0"/>
                      <Cell col="1" style="background:BIND(bgc1);background2:BIND(bgc1);color:EXPR((chk1==0)?'#c4c4c4':(bgc1=='#31a3dc')?'#ffffff':'');color2:EXPR((chk1==0)?'#c4c4c4':(bgc1=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day1"/>
                      <Cell col="2" style="background:BIND(bgc2);background2:BIND(bgc2);color:EXPR((chk2==0)?'#c4c4c4':(bgc2=='#31a3dc')?'#ffffff':'');color2:EXPR((chk2==0)?'#c4c4c4':(bgc2=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day2"/>
                      <Cell col="3" style="background:BIND(bgc3);background2:BIND(bgc3);color:EXPR((chk3==0)?'#c4c4c4':(bgc3=='#31a3dc')?'#ffffff':'');color2:EXPR((chk3==0)?'#c4c4c4':(bgc3=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day3"/>
                      <Cell col="4" style="background:BIND(bgc4);background2:BIND(bgc4);color:EXPR((chk4==0)?'#c4c4c4':(bgc4=='#31a3dc')?'#ffffff':'');color2:EXPR((chk4==0)?'#c4c4c4':(bgc4=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day4"/>
                      <Cell col="5" style="background:BIND(bgc5);background2:BIND(bgc5);color:EXPR((chk5==0)?'#c4c4c4':(bgc5=='#31a3dc')?'#ffffff':'');color2:EXPR((chk5==0)?'#c4c4c4':(bgc5=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day5"/>
                      <Cell col="6" style="background:BIND(bgc6);background2:BIND(bgc6);color:EXPR((chk6==0)?'#c4c4c4':(bgc6=='#31a3dc')?'#ffffff':'#31a3dc');color2:EXPR((chk6==0)?'#c4c4c4':(bgc6=='#31a3dc')?'#ffffff':'#31a3dc');selectcolor:#ffffffff;" class="cel_sat" text="bind:day6"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Div id="div_topFrom" taborder="1" scrollbars="none" class="dv_calMonth" position="absolute -1 -1 183 22" anchor="default">
                <Layouts>
                  <Layout>
                    <Static id="sttYear" text="2012." onclick="PopupDiv00_Div02_Static15_onclick" class="sta_cal_headText" position="absolute 51 1 101 21" _term="" anchor="default"/>
                    <Button id="btnPreviousMonth" taborder="1" onclick="div_calTop_btn_monPrev_onclick" class="btn_cal_monthspinUp" position="absolute 21 0 43 22" _term="" _auth="" anchor="default"/>
                    <Button id="btnNextMonth" taborder="1" onclick="div_calTop_btn_monNext_onclick" class="btn_cal_monthspinDown" position="absolute 138 0 160 22" _term="" _auth="" anchor="default"/>
                    <Button id="btnPreviousYear" taborder="1" onclick="div_calTop_btn_yearPrev_onclick" class="btn_calendar_yearPrev" position="absolute -1 0 21 22" _term="" _auth="" anchor="default"/>
                    <Button id="btnNextYear" taborder="1" onclick="div_calTop_btn_yearNext_onclick" class="btn_calendar_yearNext" position="absolute 160 0 182 22" _term="" _auth="" anchor="default"/>
                    <Static id="sttMonth" text="10" onclick="PopupDiv00_Div02_Static00_onclick" class="sta_cal_headText" position="absolute 99 1 125 21" _term="" anchor="default"/>
                  </Layout>
                </Layouts>
              </Div>
              <Div id="div_topTo" taborder="1" scrollbars="none" class="dv_calMonth" position="absolute 182 -1 366 22" anchor="default">
                <Layouts>
                  <Layout>
                    <Static id="sttYear" text="2012." onclick="PopupDiv00_Div02_Static15_onclick" class="sta_cal_headText" position="absolute 51 1 101 21" _term="" anchor="default"/>
                    <Button id="btnPreviousMonth" taborder="1" onclick="div_calTop_btn_monPrev_onclick" class="btn_cal_monthspinUp" position="absolute 21 0 43 22" _term="" _auth="" anchor="default"/>
                    <Button id="btnNextMonth" taborder="1" onclick="div_calTop_btn_monNext_onclick" class="btn_cal_monthspinDown" position="absolute 138 0 160 22" _term="" _auth="" anchor="default"/>
                    <Button id="btnPreviousYear" taborder="1" onclick="div_calTop_btn_yearPrev_onclick" class="btn_calendar_yearPrev" position="absolute -1 0 21 22" _term="" _auth="" anchor="default"/>
                    <Button id="btnNextYear" taborder="1" onclick="div_calTop_btn_yearNext_onclick" class="btn_calendar_yearNext" position="absolute 160 0 182 22" _term="" _auth="" anchor="default"/>
                    <Static id="sttMonth" text="10" onclick="PopupDiv00_Div02_Static00_onclick" class="sta_cal_headText" position="absolute 99 1 125 21" _term="" anchor="default"/>
                  </Layout>
                </Layouts>
              </Div>
              <Grid id="grd_calTo" class="grd_calendar" taborder="1" binddataset="ds_calTo" scrollbars="none" useinputpanel="false" selecttype="cell" autofittype="col" useselcolor="false" position="absolute 182 22 366 185" oncellclick="PopCalPred_grd_cal_oncellclick" anchor="default" oncelldblclick="PopCalPred_grd_cal_oncelldblclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                      <Column size="26"/>
                    </Columns>
                    <Rows>
                      <Row size="25" band="head"/>
                      <Row size="22"/>
                    </Rows>
                    <Band id="head" style="cellfont:Dotum,9;">
                      <Cell style="color:#ef3f30ff;color2:#ef3f30;selectcolor:#ef3f30ff;" text="일"/>
                      <Cell col="1" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="월"/>
                      <Cell col="2" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="화"/>
                      <Cell col="3" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="수"/>
                      <Cell col="4" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="목"/>
                      <Cell col="5" style="background:#f7f7f7ff;background2:#f7f7f7ff;color:#969696ff;color2:#969696ff;selectline:0 none;" text="금"/>
                      <Cell col="6" style="background2: ;color:#31a3dcff;color2:#31a3dcff;selectcolor:#31a3dcff;" text="토"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:BIND(bgc0);background2:BIND(bgc0);color:EXPR((chk0==0)?'#c4c4c4':(bgc0=='#30a273')?'#ffffff':'#ef3f30');color2:EXPR((chk0==0)?'#c4c4c4':(bgc0=='#31a3dc')?'#ffffff':'#ef3f30');selectcolor:#ffffffff;" text="bind:day0"/>
                      <Cell col="1" style="background:BIND(bgc1);background2:BIND(bgc1);color:EXPR((chk1==0)?'#c4c4c4':(bgc1=='#30a273')?'#ffffff':'');color2:EXPR((chk1==0)?'#c4c4c4':(bgc1=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day1"/>
                      <Cell col="2" style="background:BIND(bgc2);background2:BIND(bgc2);color:EXPR((chk2==0)?'#c4c4c4':(bgc2=='#30a273')?'#ffffff':'');color2:EXPR((chk2==0)?'#c4c4c4':(bgc2=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day2"/>
                      <Cell col="3" style="background:BIND(bgc3);background2:BIND(bgc3);color:EXPR((chk3==0)?'#c4c4c4':(bgc3=='#30a273')?'#ffffff':'');color2:EXPR((chk3==0)?'#c4c4c4':(bgc3=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day3"/>
                      <Cell col="4" style="background:BIND(bgc4);background2:BIND(bgc4);color:EXPR((chk4==0)?'#c4c4c4':(bgc4=='#30a273')?'#ffffff':'');color2:EXPR((chk4==0)?'#c4c4c4':(bgc4=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day4"/>
                      <Cell col="5" style="background:BIND(bgc5);background2:BIND(bgc5);color:EXPR((chk5==0)?'#c4c4c4':(bgc5=='#30a273')?'#ffffff':'');color2:EXPR((chk5==0)?'#c4c4c4':(bgc5=='#31a3dc')?'#ffffff':'');selectcolor:#ffffffff;" text="bind:day5"/>
                      <Cell col="6" style="background:BIND(bgc6);background2:BIND(bgc6);color:EXPR((chk6==0)?'#c4c4c4':(bgc6=='#30a273')?'#ffffff':'#31a3dc');color2:EXPR((chk6==0)?'#c4c4c4':(bgc6=='#31a3dc')?'#ffffff':'#31a3dc');selectcolor:#ffffffff;" class="cel_sat" text="bind:day6"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Radio id="rdo_dayChOpt" taborder="2" columncount="4" rowcount="0" index="-1" innerdataset="@ds_DayChOpt" codecolumn="CODE" datacolumn="NAME" position="absolute 10 195 359 263" style="font:Dotum,9;" anchor="default" onitemchanged="rdo_dayChOpt_onitemchanged"/>
            </Layout>
          </Layouts>
        </PopupDiv>
        <Static id="stc_03" text="~" class="sta_WF_Unit" position="absolute 95 0 110 20" style="align:center;"/>
        <Calendar id="cal_calFrom" taborder="0" dateformat="yyyy-MM-dd" position="absolute 0 0 95 20" style="usetrailingday:true;" canchange="cal_calFrom_canchange" onchanged="cal_calFrom_onchanged" ondropdown="cal_calFrom_ondropdown"/>
        <Calendar id="cal_calTo" taborder="1" dateformat="yyyy-MM-dd" position="absolute 110 0 205 20" style="usetrailingday:true;" onchanged="cal_calTo_onchanged" canchange="cal_calTo_canchange" ondropdown="cal_calTo_ondropdown"/>
        <Static id="Static00" text="h10" class="tip_guide" visible="false" position2="absolute l:14 w:74 t:214 h:10" positiontype="position2"/>
        <Static id="Static01" text="h10" class="tip_guide" visible="false" position2="absolute l:129 w:117 t:292 h:10" positiontype="position2"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_calTo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="day0" type="STRING" size="256"/>
          <Column id="day1" type="STRING" size="256"/>
          <Column id="day2" type="STRING" size="256"/>
          <Column id="day3" type="STRING" size="256"/>
          <Column id="day4" type="STRING" size="256"/>
          <Column id="day5" type="STRING" size="256"/>
          <Column id="day6" type="STRING" size="256"/>
          <Column id="chk0" type="STRING" size="256"/>
          <Column id="chk1" type="STRING" size="256"/>
          <Column id="chk2" type="STRING" size="256"/>
          <Column id="chk3" type="STRING" size="256"/>
          <Column id="chk4" type="STRING" size="256"/>
          <Column id="chk5" type="STRING" size="256"/>
          <Column id="chk6" type="STRING" size="256"/>
          <Column id="bgc0" type="STRING" size="256"/>
          <Column id="bgc1" type="STRING" size="256"/>
          <Column id="bgc2" type="STRING" size="256"/>
          <Column id="bgc3" type="STRING" size="256"/>
          <Column id="bgc4" type="STRING" size="256"/>
          <Column id="bgc5" type="STRING" size="256"/>
          <Column id="bgc6" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="day0">24</Col>
            <Col id="day1">25</Col>
            <Col id="day2">26</Col>
            <Col id="day3">27</Col>
            <Col id="day4">28</Col>
            <Col id="day5">29</Col>
            <Col id="day6">30</Col>
            <Col id="chk0">0</Col>
            <Col id="chk1">0</Col>
            <Col id="chk2">0</Col>
            <Col id="chk3">0</Col>
            <Col id="chk4">0</Col>
            <Col id="chk5">0</Col>
            <Col id="chk6">0</Col>
          </Row>
          <Row>
            <Col id="day0">1</Col>
            <Col id="day1">2</Col>
            <Col id="day2">3</Col>
            <Col id="day3">4</Col>
            <Col id="day4">5</Col>
            <Col id="day5">6</Col>
            <Col id="day6">7</Col>
            <Col id="chk6">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk0">1</Col>
          </Row>
          <Row>
            <Col id="day0">8</Col>
            <Col id="day1">9</Col>
            <Col id="day2">10</Col>
            <Col id="day3">11</Col>
            <Col id="day4">12</Col>
            <Col id="day5">13</Col>
            <Col id="day6">14</Col>
            <Col id="chk0">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk6">1</Col>
          </Row>
          <Row>
            <Col id="day0">15</Col>
            <Col id="day1">16</Col>
            <Col id="day2">17</Col>
            <Col id="day3">18</Col>
            <Col id="day4">19</Col>
            <Col id="day5">20</Col>
            <Col id="day6">21</Col>
            <Col id="chk6">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk0">1</Col>
          </Row>
          <Row>
            <Col id="day0">22</Col>
            <Col id="day1">23</Col>
            <Col id="day2">24</Col>
            <Col id="day3">25</Col>
            <Col id="day4">26</Col>
            <Col id="day5">27</Col>
            <Col id="day6">28</Col>
            <Col id="chk0">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk6">1</Col>
          </Row>
          <Row>
            <Col id="day0">29</Col>
            <Col id="day1">30</Col>
            <Col id="day2">31</Col>
            <Col id="day3">1</Col>
            <Col id="day4">2</Col>
            <Col id="day5">3</Col>
            <Col id="day6">4</Col>
            <Col id="chk0">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk3">0</Col>
            <Col id="chk4">0</Col>
            <Col id="chk5">0</Col>
            <Col id="chk6">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_calFrom" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="day0" type="STRING" size="256"/>
          <Column id="day1" type="STRING" size="256"/>
          <Column id="day2" type="STRING" size="256"/>
          <Column id="day3" type="STRING" size="256"/>
          <Column id="day4" type="STRING" size="256"/>
          <Column id="day5" type="STRING" size="256"/>
          <Column id="day6" type="STRING" size="256"/>
          <Column id="chk0" type="STRING" size="256"/>
          <Column id="chk1" type="STRING" size="256"/>
          <Column id="chk2" type="STRING" size="256"/>
          <Column id="chk3" type="STRING" size="256"/>
          <Column id="chk4" type="STRING" size="256"/>
          <Column id="chk5" type="STRING" size="256"/>
          <Column id="chk6" type="STRING" size="256"/>
          <Column id="bgc0" type="STRING" size="256"/>
          <Column id="bgc1" type="STRING" size="256"/>
          <Column id="bgc2" type="STRING" size="256"/>
          <Column id="bgc3" type="STRING" size="256"/>
          <Column id="bgc4" type="STRING" size="256"/>
          <Column id="bgc5" type="STRING" size="256"/>
          <Column id="bgc6" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="day0">24</Col>
            <Col id="day1">25</Col>
            <Col id="day2">26</Col>
            <Col id="day3">27</Col>
            <Col id="day4">28</Col>
            <Col id="day5">29</Col>
            <Col id="day6">30</Col>
            <Col id="chk0">0</Col>
            <Col id="chk1">0</Col>
            <Col id="chk2">0</Col>
            <Col id="chk3">0</Col>
            <Col id="chk4">0</Col>
            <Col id="chk5">0</Col>
            <Col id="chk6">0</Col>
          </Row>
          <Row>
            <Col id="day0">1</Col>
            <Col id="day1">2</Col>
            <Col id="day2">3</Col>
            <Col id="day3">4</Col>
            <Col id="day4">5</Col>
            <Col id="day5">6</Col>
            <Col id="day6">7</Col>
            <Col id="chk6">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk0">1</Col>
          </Row>
          <Row>
            <Col id="day0">8</Col>
            <Col id="day1">9</Col>
            <Col id="day2">10</Col>
            <Col id="day3">11</Col>
            <Col id="day4">12</Col>
            <Col id="day5">13</Col>
            <Col id="day6">14</Col>
            <Col id="chk0">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk6">1</Col>
          </Row>
          <Row>
            <Col id="day0">15</Col>
            <Col id="day1">16</Col>
            <Col id="day2">17</Col>
            <Col id="day3">18</Col>
            <Col id="day4">19</Col>
            <Col id="day5">20</Col>
            <Col id="day6">21</Col>
            <Col id="chk6">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk0">1</Col>
          </Row>
          <Row>
            <Col id="day0">22</Col>
            <Col id="day1">23</Col>
            <Col id="day2">24</Col>
            <Col id="day3">25</Col>
            <Col id="day4">26</Col>
            <Col id="day5">27</Col>
            <Col id="day6">28</Col>
            <Col id="chk0">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk3">1</Col>
            <Col id="chk4">1</Col>
            <Col id="chk5">1</Col>
            <Col id="chk6">1</Col>
          </Row>
          <Row>
            <Col id="day0">29</Col>
            <Col id="day1">30</Col>
            <Col id="day2">31</Col>
            <Col id="day3">1</Col>
            <Col id="day4">2</Col>
            <Col id="day5">3</Col>
            <Col id="day6">4</Col>
            <Col id="chk0">1</Col>
            <Col id="chk1">1</Col>
            <Col id="chk2">1</Col>
            <Col id="chk3">0</Col>
            <Col id="chk4">0</Col>
            <Col id="chk5">0</Col>
            <Col id="chk6">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_DayChOpt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="NAME">오늘</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="NAME">전일</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="NAME">금주</Col>
          </Row>
          <Row>
            <Col id="CODE">4</Col>
            <Col id="NAME">전주</Col>
          </Row>
          <Row>
            <Col id="CODE">5</Col>
            <Col id="NAME">당월</Col>
          </Row>
          <Row>
            <Col id="CODE">6</Col>
            <Col id="NAME">전월</Col>
          </Row>
          <Row>
            <Col id="CODE">7</Col>
            <Col id="NAME">당분기</Col>
          </Row>
          <Row>
            <Col id="CODE">8</Col>
            <Col id="NAME">전분기</Col>
          </Row>
          <Row>
            <Col id="CODE">9</Col>
            <Col id="NAME">당년(오늘)</Col>
          </Row>
          <Row>
            <Col id="CODE">10</Col>
            <Col id="NAME">당년(12/31)</Col>
          </Row>
          <Row>
            <Col id="CODE">11</Col>
            <Col id="NAME">전년</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[/*
 * 01. 업무구분 : 공통 Composite
 * 02. 화면 : CommCalendarPred.xfdl
 * 03. 화면 Notice : From To 달력
 * 04. 관련 화면/서비스 : 
 * 05. 작성자 : 심상준
 * 06. 작성일 : 2015.06.01
 * 07. 수정이력 :
 ************************************************************************************************
 *     수정일        이  름    사유
 ************************************************************************************************
 *     2015.06.01    심상준    최초 작성
 ************************************************************************************************
 */
include "LIB::comUtil.xjs";
include "LIB::comDate.xjs";

var cv_FromDt;
var cv_ToDt;
var cv_Active;
var cv_leftnCnt  = 0;
var cv_rightnCnt = 0;
var cv_SkipCheck = true;
//2015.2.5 조회조건초기화시 날짜초기화 용도
var cv_initFromDt = null; 
var cv_initToDt = null;

function CommCalendarView_onload(obj:Form, e:LoadEventInfo)
{
	//setData(gfn_today(),gfn_today(),true);
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 초기화
 * param    : sFormDt - 시작일자
 * param    : sToDt   - 종료일자
 * param    : sAction - 변경될 시 처리할 이벤트명
 * return   : void
-----------------------------------------------------------------------------------------------*/
function setInit(sFormDt,sToDt, sAction){

   cv_Active = gfn_isNull(sAction) ? "" : sAction ;
   if(gfn_isDate(sFormDt) && gfn_isDate(sToDt)){
       cal_calFrom.value = sFormDt;
       cal_calTo.value = sToDt;
       //2015.2.5 조회조건초기화시 날짜초기화 용도
       cv_initFromDt =  sFormDt;
       cv_initToDt = sToDt;
	   lfn_createMonth(sFormDt,PopCalPred.grd_calFrom);
	   lfn_createMonth(sToDt,PopCalPred.grd_calTo);
   }
}
/*----------------------------------------------------------------------------------------------
 * Notice   : 날짜 초기화 (전역변수에 저장한 값으로 적용)
 * return   : void
-----------------------------------------------------------------------------------------------*/
function setReload(){
   cal_calFrom.value = cv_initFromDt;
   cal_calTo.value = cv_initToDt;
}
/*----------------------------------------------------------------------------------------------
 * Notice   : 날짜 적용
 * param    : sFormDt - 시작일자
 * param    : sToDt   - 종료일자
 * param    : bIsSkipCheck   - 현재일 이후 날짜 체크 여부 플래그
 * param    : sAction - 변경될 시 처리할 이벤트명
 * return   : void
-----------------------------------------------------------------------------------------------*/
function setData(sFormDt,sToDt,bIsSkipCheck,sAction){
	cv_Active = gfn_isNull(sAction) ? "" : sAction;
    if(gfn_isDate(sFormDt) && gfn_isDate(sToDt)){

		cal_calFrom.value = sFormDt;
		cal_calTo.value = sToDt;
	    //2015.2.5 조회조건초기화시 날짜초기화 용도
        if(cv_initFromDt == null || cv_initFromDt == "" ) {
			cv_initFromDt =  sFormDt;
			cv_initToDt = sToDt;
		}
		//현재일 이후 날짜 체크 여부 플래그 설정
		cv_SkipCheck = bIsSkipCheck;

 	   lfn_createMonth(sFormDt,PopCalPred.grd_calFrom);
 	   lfn_createMonth(sToDt,PopCalPred.grd_calTo);
   }
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 그리드 달력 ReDraw
 * param    : sDt - 기준일자
 * param    : obj - Calendar Grid Object
 * return   : void
-----------------------------------------------------------------------------------------------*/
function lfn_createMonth(sDt,obj)
{
	if(sDt == "" || sDt == null ) return;
	
	var firstDay = gfn_getFirstDate(sDt);
	var lastDay = gfn_getLastDate(sDt);
	var fDay = gfn_getDay(firstDay);
	var prevDay = gfn_getBeforeMonth(sDt);
	var prevLastDay = gfn_getLastDate(prevDay);
	var objDs = eval(obj.binddataset);
	var sYear = sDt.substr(0,4);
	var sMonth = sDt.substr(4,2); 
	var sDay = parseInt(sDt.substr(6,2));
	
	lastDay = lastDay.substr(6,2);
	prevLastDay = parseInt(prevLastDay.substr(6,2));

	if(obj.name == "grd_calFrom"){
		PopCalPred.div_topFrom.sttYear.text = sYear+".";
		PopCalPred.div_topFrom.sttMonth.text = sMonth;
		cv_FromDt = sDt;
	} else {
		PopCalPred.div_topTo.sttYear.text = sYear+".";
		PopCalPred.div_topTo.sttMonth.text = sMonth;
		cv_ToDt = sDt;
	}
	objDs.enableevent = false;
	objDs.deleteAll();
	
	var day = 1;
	var isMonth = 1;
	if(fDay > 0){
      // 현재월 및 다음월 채우기
      for(var i=0; i<6; i++){
          var nRow = objDs.addRow();
          var j = (i==0) ? fDay : 0;
           for(var k=j; k<7; k++){
				objDs.setColumn(nRow,"day"+k,day);
				objDs.setColumn(nRow,"chk"+k,isMonth);
				if(sDay == day && isMonth == 1){
					objDs.setColumn(nRow,"bgc"+k,"#30a273");
				} else {
					objDs.setColumn(nRow,"bgc"+k,"");
				}
				if(day == lastDay){
					day = 1;
					isMonth = 0;
				} else {
					day++;
				}
			}
		}   
	} else {
		// 현재월 및 다음월 채우기
		for(var i=0; i<6; i++){
			var nRow = objDs.addRow();
			if(i != 0){
				for(var k=0; k<7; k++){
					objDs.setColumn(nRow,"day"+k,day);
					objDs.setColumn(nRow,"chk"+k,isMonth);
					if(sDay == day && isMonth == 1){
						objDs.setColumn(nRow,"bgc"+k,"#30a273");
					} else {
						objDs.setColumn(nRow,"bgc"+k,"");
					}                 
					if(day == lastDay){
						day = 1;
						isMonth = 0;
					} else {
						day++;
					}
				}
			}
		}
	}
   
	// 이전월 채우기
	var i = (fDay==0) ? 6 : fDay-1;
	isMonth = 0;
	while(i > -1){
		objDs.setColumn(0,"day"+i,prevLastDay);
		objDs.setColumn(0,"chk"+i,isMonth);
		objDs.setColumn(0,"bgc"+i,"");
		i--;
		prevLastDay--;
	}
         
	// 선택일이 있는주 선택
	var fRow;
	for(var k=0; k<7; k++){
		fRow = objDs.findRowExpr("day"+k+" == '"+sDay+"' && chk"+k+" == '1'");
		if(fRow > -1) break;
	}
	objDs.enableevent = true; 
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 이전달로 이동
 * param    : obj - Button
 * param    : e - ClickEventInfo
 * return   : void
-----------------------------------------------------------------------------------------------*/
function div_calTop_btn_monPrev_onclick(obj:Button,  e:ClickEventInfo)
{
    var objDiv = obj.parent;
    var prevDate;
	    
    if(objDiv.name == "div_topFrom"){
		prevDate = gfn_getBeforeMonth(cv_FromDt);
		lfn_createMonth(prevDate,PopCalPred.grd_calFrom);    
    } else {
		prevDate = gfn_getBeforeMonth(cv_ToDt);
		lfn_createMonth(prevDate,PopCalPred.grd_calTo);      
    }
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 다음달로 이동
 * param    : obj - Button
 * param    : e - ClickEventInfo
 * return   : void
-----------------------------------------------------------------------------------------------*/
function div_calTop_btn_monNext_onclick(obj:Button,  e:ClickEventInfo)
{
    var objDiv = obj.parent;
    var nextDate;
	    
    if(objDiv.name == "div_topFrom"){
		nextDate = gfn_getAfterMonth(cv_FromDt);
		lfn_createMonth(nextDate,PopCalPred.grd_calFrom);    
    } else {
		nextDate = gfn_getAfterMonth(cv_ToDt);
		lfn_createMonth(nextDate,PopCalPred.grd_calTo);      
    }
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 전년도로 이동
 * param    : obj - Button
 * param    : e - ClickEventInfo
 * return   : void
-----------------------------------------------------------------------------------------------*/
function div_calTop_btn_yearPrev_onclick(obj:Button,  e:ClickEventInfo)
{

    var objDiv = obj.parent;
    var nextDate;
	    
    if(objDiv.name == "div_topFrom"){
		nextDate = gfn_getBeforeYear(cv_FromDt);
		lfn_createMonth(nextDate,PopCalPred.grd_calFrom);    
    } else {
		nextDate = gfn_getBeforeYear(cv_ToDt);
		lfn_createMonth(nextDate,PopCalPred.grd_calTo);      
    }
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 내년도로 이동
 * param    : obj - Button
 * param    : e - ClickEventInfo
 * return   : void
-----------------------------------------------------------------------------------------------*/
function div_calTop_btn_yearNext_onclick(obj:Button,  e:ClickEventInfo)
{

    var objDiv = obj.parent;
    var nextDate;
	    
    if(objDiv.name == "div_topFrom"){
		nextDate = gfn_getAfterYear(cv_FromDt);
		lfn_createMonth(nextDate,PopCalPred.grd_calFrom);    
    } else {
		nextDate = gfn_getAfterYear(cv_ToDt);
		lfn_createMonth(nextDate,PopCalPred.grd_calTo);      
    }
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 해당 날짜 선택
 * param    : sDt - 기준일자
 * param    : obj - Calendar Grid
 * param    : tmpChk - 
 * return   : void
-----------------------------------------------------------------------------------------------*/
function lfn_selDt(sDt,obj,tmpChk){
	if(tmpChk == 0 ) return;
	var day = 1;
	var isMonth;
	for(var i=0; i<obj.rowcount; i++){
		for(var k=0; k<7; k++){
			isMonth = obj.getColumn(i,"chk"+k);
			if(isMonth == 1){
				if(sDt == day){
					obj.setColumn(i,"bgc"+k,"#30a273");
				} else {
					obj.setColumn(i,"bgc"+k,"");
				}  	     
			 
				day++;
			}   
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 선택된 날짜 Get
 * return   : array ( From일자, To일자)
-----------------------------------------------------------------------------------------------*/
function getData(){

    var rtnVal 	= Array(2);
    var sFromDt;
    var sToDt;
    if(!gfn_isNull(cal_calFrom.value))
    {
		sFromDt = gfn_date2Str(cal_calFrom.value);    
    }
    if(!gfn_isNull(cal_calTo.value))
    {
		sToDt 	= gfn_date2Str(cal_calTo.value);
	}
	
	rtnVal[0] = sFromDt;
	rtnVal[1] = sToDt;
	return rtnVal;
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 칼렌더 팝업 Show, Hide
 * return   : void
-----------------------------------------------------------------------------------------------*/
function lv_calShowHeide(){
	var obj  = btn_calFrom;
	var nX   = system.clientToScreenX(medt_calFrom, 0)-1;
	var nY   = system.clientToScreenY(obj, 0)+(obj.position.height);

	if(PopCalPred.isPopup()==false){
		PopCalPred.trackPopup(nX, nY);
	}else{
		cv_leftnCnt  = 0;
		cv_rightnCnt = 0;
		PopCalPred.closePopup();
	}	 
}

/*----------------------------------------------------------------------------------------------
 * Notice   : From 달력 변경 가능여부  검사
 * return   : false
-----------------------------------------------------------------------------------------------*/
function cal_calFrom_canchange(obj:Calendar, e:ChangeEventInfo)
{
	//달력 변경 전 날짜가 blank 일경우 이전 값 자동 설정 
	if(gfn_isEmpty(e.postvalue)) {
		this.cal_calFrom.enableevent	= false;
		this.cal_calFrom.value		= e.prevalue;
		this.cal_calFrom.enableevent	= true;

		return false;
	}	
}

/*----------------------------------------------------------------------------------------------
 * Notice   : To 달력 변경 가능여부  검사
 * return   : false
-----------------------------------------------------------------------------------------------*/
function cal_calTo_canchange(obj:Calendar, e:ChangeEventInfo)
{
	//달력 변경 전 날짜가 blank 일경우 이전 값 자동 설정 
	if(gfn_isEmpty(e.postvalue)) {
		this.cal_calTo.enableevent	= false;
		this.cal_calTo.value		= e.prevalue;
		this.cal_calTo.enableevent	= true;

		return false;
	}	
}

/*----------------------------------------------------------------------------------------------
 * Notice   : FROM 달력 변경 시
 * return   : void
-----------------------------------------------------------------------------------------------*/
function cal_calFrom_onchanged(obj:Calendar, e:ChangeEventInfo)
{
	//기간 달력은 달력 값 변경 시 클라이언트에 변경 이벤트 호출 필요 없음
	//(반드시 조회 버튼을 이용 해서 조회)
}

/*----------------------------------------------------------------------------------------------
 * Notice   : TO 달력 변경 시
 * return   : void
-----------------------------------------------------------------------------------------------*/
function cal_calTo_onchanged(obj:Calendar, e:ChangeEventInfo)
{
	//기간 달력은 달력 값 변경 시 클라이언트에 변경 이벤트 호출 필요 없음
	//(반드시 조회 버튼을 이용 해서 조회)
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력 DropDown
 * return   : void
-----------------------------------------------------------------------------------------------*/
function cal_calFrom_ondropdown(obj:Calendar, e:EventInfo)
{
	lfn_CalBtnDropDown(); 
	return false;	
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력 DropDown
 * return   : void
-----------------------------------------------------------------------------------------------*/
function cal_calTo_ondropdown(obj:Calendar, e:EventInfo)
{
	lfn_CalBtnDropDown();
	return false;	
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력 DropDown 처리
 * return   : void
-----------------------------------------------------------------------------------------------*/
function lfn_CalBtnDropDown() 
{
	try	{
	    // medt_calFrom, medt_calTo 에 "" 이 들어 오면 현재 날짜의 캘린더로 펼쳐준다.
		var calFrom = "";
		var calTo = "";

		//From 달력 과 To 달력 모두 선택 시 PopupDiv를 닫기 위한 조건 초기화 
		cv_leftnCnt  =0;
		cv_rightnCnt =0;

		if(cal_calTo.value != null)
		{
			calTo = gfn_date2Str(cal_calTo.value);   
			lfn_createMonth(calTo,PopCalPred.grd_calTo);
		} else {
			calTo = gfn_today();
			lfn_createMonth(calTo,PopCalPred.grd_calTo);	   
		}

		if(cal_calFrom.value != null)
		{
			calFrom = gfn_date2Str(cal_calFrom.value);   
			lfn_createMonth(calFrom,PopCalPred.grd_calFrom);
		} else {
			calFrom = gfn_today();
			lfn_createMonth(calFrom,PopCalPred.grd_calFrom);
		}

		// End
		var nX   = system.clientToScreenX(cal_calFrom, 0)-1;
		var nY   = system.clientToScreenY(cal_calFrom, 0)+(cal_calFrom.position.height);

		if(PopCalPred.isPopup()==false){
			PopCalPred.trackPopup(nX, nY);
		} else {
			PopCalPred.closePopup();
		}
	}catch(e) {}
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력 그리드 선택 
 * return   : void
-----------------------------------------------------------------------------------------------*/
function PopCalPred_grd_cal_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	var dsObj   = eval(obj.binddataset);

	var bgc     = dsObj.getColumn(e.row,"bgc"+(e.col));
	var tmpDay  = dsObj.getColumn(e.row,"day"+(e.col));
	var tmpChk  = dsObj.getColumn(e.row,"chk"+(e.col));
		
	var sFromDt = "";
	var sToDt	= "";
	try
	{					
		var sDs = eval(obj.binddataset);
		var sFromYear  = PopCalPred.div_topFrom.sttYear.text;		
		var sFromMonth = PopCalPred.div_topFrom.sttMonth.text;
		var sToYear  = PopCalPred.div_topTo.sttYear.text;
		var sToMonth = PopCalPred.div_topTo.sttMonth.text;		
		var sDay 	= "";	

		if(obj.name == "grd_calFrom"){
					
			var oToDay = cal_calTo.value;
			
			sDay = sDs.getColumn(e.row,"day"+(e.col));
			sDay = sDay.padLeft(2, '0');

			var fromDt = sFromYear.replace(".","")+sFromMonth+sDay;		
			//현재일 이후 날짜 체크 여부
			if(!cv_SkipCheck)
			{
				if(fromDt > gfn_today()){				
					lfn_message(" 현재 날짜 이후는 이동 불가 합니다.");
					return;
				}
			}
			if(tmpChk == '0') {
				if(e.row == 0){
					fromDt = gfn_addMonth(fromDt,-1)+sDay;
				} else {
					fromDt = gfn_addMonth(fromDt,1)+sDay;
				}				
			}
			/*if(gfn_isNull(oToDay)){
				oToDay = sToYear.replace(".","")+sToMonth+sDay;		
			}*/

			if((!gfn_isNull(oToDay) || tmpChk != 0 ) && fromDt > oToDay){
				cal_calTo.value   = fromDt;
				cal_calFrom.value = fromDt;
				lfn_createMonth(fromDt,PopCalPred.grd_calFrom);
				lfn_createMonth(fromDt,PopCalPred.grd_calTo);				
				lfn_message("시작일은 종료일보다 클수 없습니다.");
				return;		
			}		
			
		}else if(obj.name == "grd_calTo"){
			
			var oFromDay = cal_calFrom.value;				
						
			sDay = sDs.getColumn(e.row,"day"+(e.col));						
			sDay = sDay.padLeft(2, '0');
			
			var toDt   = sToYear.replace(".","")+sToMonth+sDay;	
			//현재일 이후 날짜 체크 여부
			if(cv_SkipCheck == false)
			{
				if(toDt > gfn_today()){				
					lfn_message(" 현재 날짜 이후는 이동 불가 합니다.");
					return;
				}
			}

			if(oFromDay > toDt){
				lfn_message("시작일은 종료일보다 클수 없습니다.");
				return;						
			}				
		}
				
	
		var strCellOldVal = "";
		if(e.oldrow  == -1 || e.oldcell == -1)
		{
			strCellOldVal = PopCalPred.grd_calFrom.getCellText(e.row,e.cell);
		}else
		{
			strCellOldVal = PopCalPred.grd_calFrom.getCellText(e.oldrow,e.oldcell);	
		}
		
		var sYear;
		var sMonth;							
			
 		if(tmpChk == 1)
 		{
			if(gfn_isNull(bgc)){
				lfn_selDt(tmpDay,dsObj,tmpChk);
			}
			
			tmpDay = tmpDay.padLeft(2, '0');
				
			if(obj.name == "grd_calFrom"){
				cv_leftnCnt++;
				sYear = PopCalPred.div_topFrom.sttYear.text;
				sMonth = PopCalPred.div_topFrom.sttMonth.text;
				var stryyyyMM = "";
				if(e.row == 0 )
				{
					stryyyyMM = gfn_addMonth(sYear+sMonth,-1);
				}else if(e.row == 5)
				{
					stryyyyMM = gfn_addMonth(sYear+sMonth,1);				
				}
				
				cv_FromDt = sYear.replace(".","")+sMonth+tmpDay;
			
				cal_calFrom.value = cv_FromDt;
				
			} else {
				cv_rightnCnt++;
				sYear = PopCalPred.div_topTo.sttYear.text;
				sMonth = PopCalPred.div_topTo.sttMonth.text;
				cv_ToDt = sYear.replace(".","")+sMonth+tmpDay;
				 
				cal_calTo.value = cv_ToDt;
			}			
			
		} else if (tmpChk == 0)	{
			var sCurYyyyMm = "";
			var sNewYyyyMm	= "";
			
			if(obj.name == "grd_calFrom"){
				cv_leftnCnt++;			
				
				sYear	= PopCalPred.div_topFrom.sttYear.text;	
				sMonth 	= PopCalPred.div_topFrom.sttMonth.text;					
				tmpDay 	= tmpDay.padLeft(2, '0');
				
				sCurYyyyMm = sYear.replace(".","")+sMonth;
				if(ds_calFrom.rowposition == 0 )
				{
					sNewYyyyMmDd = gfn_getBeforeMonth(sCurYyyyMm+"01").substr(0,6) + tmpDay;
					lfn_createMonth(sNewYyyyMmDd,PopCalPred.grd_calFrom); 
				} else {		
					sNewYyyyMmDd = gfn_getAfterMonth(sCurYyyyMm+"01").substr(0,6) + tmpDay;
					lfn_createMonth(sNewYyyyMmDd,PopCalPred.grd_calFrom);     				   	
				}
				cv_FromDt = sNewYyyyMmDd;  	
				cal_calFrom.value = cv_FromDt;							
			} else {
				cv_rightnCnt++;	
				sYear	= PopCalPred.div_topTo.sttYear.text;	
				sMonth 	= PopCalPred.div_topTo.sttMonth.text;					
				tmpDay 	= tmpDay.padLeft(2, '0');				 		 
				sCurYyyyMm = sYear.replace(".","")+sMonth;
				if(ds_calTo.rowposition == 0 )
				{
					sNewYyyyMmDd = gfn_getBeforeMonth(sCurYyyyMm+"01").substr(0,6) + tmpDay;

					lfn_createMonth(sNewYyyyMmDd,PopCalPred.grd_calTo); 
				} else {		
					sNewYyyyMmDd = gfn_getAfterMonth(sCurYyyyMm+"01").substr(0,6) + tmpDay;
				
					lfn_createMonth(sNewYyyyMmDd,PopCalPred.grd_calTo);

				}
				cv_ToDt = sNewYyyyMmDd;  	
				cal_calTo.value = cv_ToDt;							
			}				
		}

		if(cv_leftnCnt > 0 && cv_rightnCnt > 0 ) {
			PopCalPred.closePopup();
		}
	}catch(e) {
		//alert("Error"+e);
	}
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력 close 
 * return   : void
-----------------------------------------------------------------------------------------------*/
function PopCalPred_oncloseup(obj:PopupDiv, e:EventInfo)
{	
	//달력 팝업div Close 시 날짜가 변경 된 경우 변경 event 함수 호출 
	//(팝업 달력이 닫힐 경우에만 호출됨 달력을 직접 편집 시 호출 안함.)
	var sFromDt	= gfn_date2Str(cal_calFrom.value);
	var sToDt	= gfn_date2Str(cal_calTo.value);

	if (cv_leftnCnt >0 || cv_rightnCnt > 0) {
		if(application.popupframes[0] == null)
		{
			if(!gfn_isNull(cv_Active)) {
				ap_WorkFrame.getActiveFrame().form.Action(cv_Active,sFromDt+","+sToDt);
			}
		}else
		{
			//2014.12.12 수정 setfocus로 변경 (팝업화면에서 달력선택후 close시  "Action은(는) 선언되지 않은 식별자입니다."라는 오류 발생하여 수정함)
			//application.popupframes[0].form.Action(cv_Active,sFromDt+","+sToDt);
			application.popupframes[0].form.setFocus();
			
		}			
	}		
	cv_leftnCnt  =0;
	cv_rightnCnt =0;						
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력 분기자료
 * return   : array ( 해당월 분기자료 )
-----------------------------------------------------------------------------------------------*/
function fn_getCurQDate(sDate)
{
	var aRtnVal = new Array(2);
	var sYear = sDate.substr(0, 4);
	var sMon1, sMon2;
	var nMonth = parseInt(sDate.substr(4,2));
	if((nMonth >= 1) && (nMonth <= 3))
	{
		sMon1 = "01";
		sMon2 = "03";
	}
	else if((nMonth >= 4) && (nMonth <= 6))
	{
		sMon1 = "04";
		sMon2 = "06";
	}
	else if((nMonth >= 7) && (nMonth <= 9))
	{
		sMon1 = "07";
		sMon2 = "09";
	}
	else if((nMonth >= 10) && (nMonth <= 12))
	{
		sMon1 = "10";
		sMon2 = "12";
	}
	aRtnVal[0] = sYear + sMon1 + "01";
	aRtnVal[1] = sYear + sMon2 + gfn_getLastDay(sYear + sMon2 + "01");
	return aRtnVal;
}

/*----------------------------------------------------------------------------------------------
 * Notice   : From To 구분에 따른 기본값 처리
 * return   : void
-----------------------------------------------------------------------------------------------*/
function rdo_dayChOpt_onitemchanged(obj:Radio, e:ItemChangeEventInfo)
{
	var sDate, msStDate, msEdDate;
	var sGb = e.postvalue;
	switch(sGb) {
		//오늘
		case "1" : msStDate = gfn_today();
		           msEdDate = gfn_today();
		           break;
		//전일
		case "2" : msStDate = gfn_addDate(gfn_today(), -1);
		           msEdDate = gfn_addDate(gfn_today(), -1);
		           break;
		//금주
		case "3" : var nIdx = gfn_getDay(gfn_today());
		           msStDate = gfn_addDate(gfn_today(), (0-nIdx));
		           msEdDate = gfn_addDate(gfn_today(), (6-nIdx));
		           break;
		//전주
		case "4" : sDate = gfn_addDate(gfn_today(), -7);
		           var nIdx = gfn_getDay(sDate);
		           msStDate = gfn_addDate(sDate, (0-nIdx));
		           msEdDate = gfn_addDate(sDate, (6-nIdx));
		           break;
		//당월
		case "5" : sDate = gfn_left(gfn_today(), 6) + "01";
		           msStDate = sDate;
		           msEdDate = gfn_left(sDate, 6) + gfn_getLastDay(sDate);
		           break;
		//전월
		case "6" : sDate = gfn_left(gfn_addMonth(gfn_today(), -1), 6) + "01";
		           msStDate = sDate;
		           msEdDate = gfn_left(sDate, 6) + gfn_getLastDay(sDate);
		           break;
		//당분기
		case "7" : var aDate = fn_getCurQDate(gfn_today());
				   msStDate = aDate[0];
		           msEdDate = aDate[1];
		           break;
		//전분기
		case "8" : var aDate = fn_getCurQDate(gfn_today());
		           aDate = fn_getCurQDate(gfn_addMonth(aDate[0], -1));
		           msStDate = aDate[0];
		           msEdDate = aDate[1];
		           break;
		//당년(오늘)
		case "9" : sDate = gfn_left(gfn_today(), 4) + "0101";
		           msStDate = sDate;
		           msEdDate = gfn_today();
		           break;
		//당년(12/31)
		case "10" : sDate = gfn_left(gfn_today(), 4);
				    msStDate = sDate + "0101";
				    msEdDate = sDate + "1231";
				    break;
		//전년
		case "11" : sDate = (parseInt(gfn_left(gfn_today(), 4) - 1)).toString();
		            msStDate = sDate + "0101"
		            msEdDate = sDate + "1231"
		            break;
	}
	setData(msStDate,msEdDate);
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력팝업 적용
 * return   : array ( From일자, To일자 )
-----------------------------------------------------------------------------------------------*/
function btnOk_onclick(obj:Button,  e:ClickEventInfo)
{
	var aRtnVal = getData();
	PopCalPred.closePopup(aRtnVal);
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력팝업 종료
 * return   : void
-----------------------------------------------------------------------------------------------*/
function btnClose_onclick(obj:Button,  e:ClickEventInfo)
{
	PopCalPred.closePopup();
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력내 메시지 처리
 * return   : void
-----------------------------------------------------------------------------------------------*/
function lfn_message(sMessage)
{
	alert(sMessage);
	//gfn_message("E",sMessage);
}

/*----------------------------------------------------------------------------------------------
 * Notice   : 달력 그리드 더블클릭선택 
 * return   : void
-----------------------------------------------------------------------------------------------*/
function PopCalPred_grd_cal_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	PopCalPred_grd_cal_oncellclick(obj, e);
	PopCalPred.closePopup();
}
]]></Script>
  </Form>
</FDL>
