<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="BUSC009M01" classname="ProgramReg" inheritanceid="" position="absolute 0 0 1038 528" titletext="사용자권한역할관리" style="font:arial,11;" onload="Form_onload" ondragmove="BUSC009M01_ondragmove" onkeydown="BUSC009M01_onkeydown">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w&#13;&#10;20" class="tip_guide" visible="false" position2="absolute l:1018 w:21 t:24 h:478" positiontype="position2"/>
        <Static id="Static00" text="h10" class="tip_guide" visible="false" position2="absolute l:101 w:42 t:0 h:10" positiontype="position2"/>
        <Static id="Static01" text="h3" class="tip_guide" visible="false" position2="absolute l:732 w:42 t:54 h:3" positiontype="position2"/>
        <Div id="div_search" taborder="0" class="bg_search" anchor="left top right" position="absolute 0 0 1018 40" positiontype="position">
          <Layouts>
            <Layout>
              <Edit id="edt_user_no" taborder="0" position="absolute 98 9 198 29" anchor="default" onkeydown="div_Search_onkeydown" maxlength="12" inputtype="digit,alpha" validate="title:사용자번호,maxlength:12" class="Code" tooltiptext="사용자번호" tooltiptype="default" displaynulltext="사용자번호"/>
              <Static id="stc_02" text="사용자 정보" class="sta_WFDA_detail_Label_P" position="absolute 14 9 103 29" anchor="default"/>
              <Edit id="edt_usernm" taborder="2" position="absolute 280 9 380 29" anchor="default" onkeydown="div_Search_onkeydown" imemode="hangul" maxlength="50" validate="title:사용자명,maxlengthB:50" tooltiptext="사용자명" displaynulltext="사용자명"/>
              <Static id="Static12" text="w&#13;&#10;&#13;15" class="tip_guide" visible="false" position2="absolute l:-1 w:15 t:0 h:42" positiontype="position2"/>
              <Static id="Static00" text="w&#13;&#10;&#13;10" class="tip_guide" visible="false" position2="absolute l:88 w:10 t:2 h:42" positiontype="position2"/>
              <Static id="Static14" text="h10" class="tip_guide" visible="false" position2="absolute l:101 w:42 t:29 h:10" positiontype="position2"/>
              <Static id="Static01" text="h10" class="tip_guide" visible="false" position2="absolute l:101 w:42 t:0 h:10" positiontype="position2"/>
              <Static id="Static03" text="h10" class="tip_guide" visible="false" position2="absolute l:351 w:42 t:0 h:10" positiontype="position2"/>
              <Static id="Static04" text="h10" class="tip_guide" visible="false" position2="absolute l:351 w:42 t:29 h:10" positiontype="position2"/>
              <Button id="btn_01" taborder="20" class="btn_WFSA_search" position="absolute 19 -39 39 -19" tooltiptype="hover" tooltiptext="우편번호 검색" anchor="default"/>
              <Button id="btn_02" taborder="3" class="btn_WFSA_search" position="absolute 381 9 401 29" tooltiptype="hover" anchor="default" onclick="btn_Popup_onclick"/>
              <Button id="btn_reset" taborder="4" class="btn_WFSA_reset" enable="true" position="absolute 402 9 422 29" anchor="default" tooltiptext="초기화" onclick="div_search_btn_reset_onclick"/>
              <Edit id="edt_login_id" taborder="1" inputtype="digit,alpha" maxlength="12" onkeydown="div_Search_onkeydown" class="Code" position="absolute 199 9 279 29" validate="" tooltiptext="로그인ID" displaynulltext="로그인ID"/>
              <Edit id="copy_edt_user_no" taborder="21" enable="false" position="absolute 453 10 503 30" visible="false"/>
              <Edit id="copy_edt_usernm" taborder="22" enable="false" position="absolute 508 10 558 30" visible="false"/>
              <Edit id="copy_edt_login_id" taborder="23" enable="false" position="absolute 564 10 614 30" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div01" taborder="2" text="Div01" position="absolute 1 42 1018 528" style="background:transparent;color:transparent;" anchor="all">
          <Layouts>
            <Layout width="1033" height="268">
              <UserGrid id="UserGrid01" taborder="1" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" autofittype="col" hideendline="col" nodataimage="URL('theme://Img/ico_WFDA_nodata.png')" position="absolute 657 31 1017 486" tooltiptype="hover" _number="true" _status="false" _check="false" _checkColumnName="_checkcol" _checkedallevent="false" _nodataimage="true" _required="" _requiredimage="false" _sort="true" _tooltip="true" binddataset="ds_autrRol" anchor="top right bottom" onvtracklast="grd_main_onvtracklast" style="cursor:hand;" selecttype="multirow" oncelldblclick="div01_UserGrid01_oncelldblclick" ondrag="div01_UserGrid01_ondrag" onlbuttonup="div01_UserGrid01_onlbuttonup">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="71"/>
                      <Column size="266"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="권한역할ID"/>
                      <Cell col="1" text="권한역할명"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:AUTR_ROL_ID"/>
                      <Cell col="1" class="alignLeft" text="bind:AUTR_ROL_NM"/>
                    </Band>
                  </Format>
                </Formats>
              </UserGrid>
              <Button id="btn_save" taborder="6" text="저장" class="btn_common_saveTxt" position="absolute 563 8 613 28" onclick="btn_save_onclick" anchor="top right" enable="false"/>
              <UserGrid id="UserGrid02" taborder="7" binddataset="ds_UserAutrrolList" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" autofittype="col" hideendline="col" nodataimage="URL('theme://Img/ico_WFDA_nodata.png')" position="absolute 0 31 614 486" tooltiptype="hover" _number="false" _status="true" _check="false" _checkColumnName="_checkcol" _checkedallevent="false" _nodataimage="true" _required="aplyStaDt^aplyEndDt^useYn" _requiredimage="true" _sort="true" _tooltip="true" anchor="all" style="cursor:hand;" selecttype="multirow" ondrag="div01_UserGrid02_ondrag" onlbuttonup="div01_UserGrid02_onlbuttonup" oncelldblclick="div01_UserGrid02_oncelldblclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="100"/>
                      <Column size="59"/>
                      <Column size="168"/>
                      <Column size="90"/>
                      <Column size="90"/>
                      <Column size="80"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="사용자번호"/>
                      <Cell col="1" colspan="2" text="권한역할" taborder="undefined"/>
                      <Cell col="3" text="적용시작일자"/>
                      <Cell col="4" text="적용종료일자"/>
                      <Cell col="5" text="사용여부"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="normal" edittype="none" text="bind:USER_NO"/>
                      <Cell col="1" displaytype="normal" edittype="none" text="bind:AUTR_ROL_ID"/>
                      <Cell col="2" displaytype="normal" edittype="none" class="alignLeft" text="bind:AUTR_ROL_NM"/>
                      <Cell col="3" displaytype="date" edittype="date" text="bind:APLY_STA_DT" calendardisplaynulltype="none"/>
                      <Cell col="4" displaytype="date" edittype="date" text="bind:APLY_END_DT" calendardisplaynulltype="none"/>
                      <Cell col="5" displaytype="checkbox" edittype="checkbox" text="bind:USE_YN" expr="expr:USE_YN=='Y'||USE_YN=='1'?'1':'0'"/>
                    </Band>
                  </Format>
                </Formats>
                <Layouts>
                  <Layout width="568" height="185"/>
                </Layouts>
              </UserGrid>
              <Static id="stc_subTitle02" text="사용자화면권한역할" class="sub_title" position="absolute 0 9 340 27" anchor="default"/>
              <Static id="Static13" text="w10" class="tip_guide" visible="false" position2="absolute l:614 w:10 t:203 h:33" positiontype="position2"/>
              <Button id="btn_roll_add" taborder="8" class="btn_suttleLeft" tooltiptext="추가" anchor="top right" position="absolute 624 225 647 248" enable="true" onclick="div01_btn_roll_add_onclick" positiontype="position"/>
              <Button id="btn_roll_del" taborder="9" class="btn_suttleRight" tooltiptext="제거" anchor="top right" position="absolute 624 249 647 272" enable="true" onclick="div01_btn_roll_del_onclick" positiontype="position"/>
              <Button id="btn_reset_copy" taborder="10" onclick="btn_reset_onclick_rol" class="btn_common_reset" position="absolute 446 8 468 28" anchor="top right" tooltiptext="초기화" enable="false"/>
              <Static id="Static00" text="w10" class="tip_guide" visible="false" position2="absolute l:647 w:10 t:227 h:33" positiontype="position2"/>
              <Static id="stc_00" text="원본사용자" class="sta_WFSA_Label" position="absolute 201 8 279 28" style="font:Dotum,9;" anchor="top right"/>
              <Edit id="edt_user_no1" taborder="11" maxlength="12" position="absolute 278 8 353 28" anchor="top right" onkeydown="div_Copy_onkeydown" inputtype="digit,alpha" validate="title:원본사용자번호,maxlength:12,required:true" class="Code" displaynulltext="사용자번호"/>
              <Edit id="edt_usernm1" taborder="12" position="absolute 354 8 422 28" anchor="top right" onkeydown="div_Copy_onkeydown" imemode="hangul" maxlength="50" validate="title:사용자명,maxlengthB:50" displaynulltext="사용자명"/>
              <Button id="btn_search_copy" taborder="13" onclick="btn_Popup_onclick2" class="btn_common_search2" enable="false" position="absolute 423 8 445 28" tooltiptype="hover" anchor="top right"/>
              <Button id="btn_copy" taborder="14" text="권한복사하기" onclick="div_copy_btn_copy_onclick" class="btn_common" enable="false" position="absolute 469 8 562 28" anchor="top right"/>
              <Edit id="edt_autrRol" taborder="15" maxlength="50" position="absolute 889 8 971 28" anchor="top right" imemode="hangul" validate="" onkeydown="div01_edt_autrRol_onkeydown"/>
              <Static id="stc_01" text="권한역할명" class="sta_WFSA_Label" position="absolute 814 8 889 28" anchor="top right" style="font:Dotum,9;"/>
              <Button id="btn_search_filter" taborder="16" onclick="btn_filter_onclick" class="btn_common_search2" enable="false" position="absolute 972 8 994 28" anchor="top right" tooltiptype="hover"/>
              <Button id="btn_reset_filter" taborder="17" onclick="btn_reset_filter_onclick" class="btn_common_reset" enable="false" position="absolute 995 8 1017 28" anchor="top right" tooltiptext="초기화"/>
              <Button id="Button44" taborder="18" class="btn_suttleLeftAll" anchor="top right" position="absolute 624 201 647 224" onclick="div01_Button44_onclick" positiontype="position"/>
              <Button id="Button45" taborder="19" class="btn_suttleRightAll" anchor="top right" position="absolute 624 273 647 296" onclick="div01_Button45_onclick" positiontype="position"/>
              <Static id="stc_subTitle00" text="화면권한역할" class="sub_title" position="absolute 657 9 795 27" anchor="top right"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static08" text="h33" class="tip_guide" visible="false" position2="absolute l:794 w:32 t:40 h:33" positiontype="position2"/>
        <Static id="Static07" text="h14" class="tip_guide" visible="false" position2="absolute l:5 w:42 t:40 h:14" positiontype="position2"/>
        <Static id="Static03" text="h14" class="tip_guide" visible="false" position2="absolute l:658 w:42 t:40 h:14" positiontype="position2"/>
        <Static id="Static09" text="h8" class="tip_guide" visible="false" position2="absolute l:658 w:42 t:65 h:8" positiontype="position2"/>
        <Static id="Static10" text="h8" class="tip_guide" visible="false" position2="absolute l:9 w:42 t:65 h:8" positiontype="position2"/>
        <Static id="sta_frmrol_N_Move" text="grd_frmrol_N_Move" visible="false" position="absolute 72 132 472 156" anchor="left top" style="color:#3f3f3f6c;padding:0 0 0 10;"/>
        <Static id="sta_frmrol_Y_Move" text="grd_frmrol_Y_Move" visible="false" position="absolute 68 160 468 184" anchor="left top" style="color:#3f3f3f6c;padding:0 0 0 10;"/>
        <Button id="btn_search" taborder="21" text="조회" onclick="btn_search_onclick" class="btn_WFSA_Search_M" position="absolute 959 12 1017 39" anchor="top right" style="align:center middle;"/>
        <Static id="Static04" text="w&#13;&#10;&#13;&#10;10" class="tip_guide" visible="false" position2="absolute l:880 w:10 t:37 h:42" positiontype="position2"/>
        <Static id="Static02" text="h10" class="tip_guide" visible="false" position2="absolute l:880 w:42 t:40 h:10" positiontype="position2"/>
        <Static id="Static11" text="h33" class="tip_guide" visible="false" position2="absolute l:166 w:32 t:40 h:33" positiontype="position2"/>
        <Static id="Static12" text="w&#13;&#10;&#13;&#10;10" class="tip_guide" visible="false" position2="absolute l:269 w:10 t:45 h:26" positiontype="position2"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_UserAutrrolList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="USER_NO" type="STRING" size="256"/>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
          <Column id="APLY_STA_DT" type="STRING" size="256"/>
          <Column id="APLY_END_DT" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ncFieldMap" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="USER_NO" type="STRING" size="256"/>
          <Column id="USER_NM" type="STRING" size="256"/>
          <Column id="LOGIN_ID" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_autrRol" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_UserAutrrolList_show" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onload="fn_userlst_filter">
        <ColumnInfo>
          <Column id="USER_NO" type="STRING" size="256"/>
          <Column id="USER_NM" type="STRING" size="256"/>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
          <Column id="APLY_STA_DT" type="STRING" size="256"/>
          <Column id="APLY_END_DT" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_autrRolTemp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SCC014" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_usrData" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_SNO" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_CO_CD" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_BRND_CD" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_BRND_NM" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_MCHT_NO" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_MCHT_NM" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_CO_CD_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_usrDataTemp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_SNO" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_CO_CD" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_BRND_CD" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_BRND_NM" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_MCHT_NO" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_MCHT_NM" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="AUTR_CL_CD" type="STRING" size="256"/>
          <Column id="AUTR_OBJ_CD" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="AUTR_CL_CD">title:권한구분코드,required:true,maxlength:2</Col>
            <Col id="AUTR_OBJ_CD">title:권한대상코드,required:true,maxlength:4</Col>
            <Col id="AUTR_CL_CD">title:권한구분코드,required:true,maxlength:2</Col>
            <Col id="AUTR_OBJ_CD">title:권한대상코드,required:true,maxlength:4</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_usrCopy" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="USER_NO" type="STRING" size="256"/>
          <Column id="USER_NO_CP" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="dsListValidrol" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="APLY_STA_DT" type="STRING" size="256"/>
          <Column id="APLY_END_DT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="APLY_STA_DT">title:시작일,comparemin:APLY_END_DT:종료일,required:true</Col>
            <Col id="APLY_END_DT">title:종료일,comparemax:APLY_STA_DT:시작일,required:true</Col>
            <Col id="APLY_STA_DT">title:시작일,comparemin:aplyEndDt:종료일,required:true</Col>
            <Col id="APLY_END_DT">title:종료일,comparemax:aplyStaDt:시작일,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_UserAutrrolListTemp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onload="fn_userlst_filter">
        <ColumnInfo>
          <Column id="USER_NO" type="STRING" size="256"/>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
          <Column id="APLY_STA_DT" type="STRING" size="256"/>
          <Column id="APLY_END_DT" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_moving" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="AUTR_ROL_ID" type="STRING" size="256"/>
          <Column id="AUTR_ROL_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_gridMenuList1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MENU_LEVEL" type="STRING" size="256"/>
          <Column id="MENU_NM" type="STRING" size="256"/>
          <Column id="MENU_ID" type="STRING" size="256"/>
          <Column id="FUNCTION_ID" type="STRING" size="256"/>
          <Column id="ENABLE_YN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="MENU_NM">저장</Col>
            <Col id="MENU_LEVEL">0</Col>
            <Col id="MENU_ID">div01.btn_save</Col>
            <Col id="FUNCTION_ID">btn_save_onclick</Col>
            <Col id="ENABLE_YN">Y</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item3" compid="div_search.edt_user_no" propid="value" datasetid="ds_ncFieldMap" columnid="USER_NO"/>
      <BindItem id="item5" compid="div_search.edt_usernm" propid="value" datasetid="ds_ncFieldMap" columnid="USER_NM"/>
      <BindItem id="item0" compid="div01.edt_user_no1" propid="value" datasetid="ds_usrCopy" columnid="USER_NO_CP"/>
      <BindItem id="item2" compid="div_search.edt_login_id" propid="value" datasetid="ds_ncFieldMap" columnid="LOGIN_ID"/>
      <BindItem id="item1" compid="div_search.copy_edt_user_no" propid="value" datasetid="ds_usrCopy" columnid="USER_NO"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 * 01. 업무구분 : 공통
 * 02. 화면 : UserRolMgmtM.xfdl
 * 03. 화면 설명 : 사용자권한역할관리
 * 04. 관련 화면/서비스 : 
 * 05. 작성자 : 심상준
 * 06. 작성일 : 2015.06.11
 * 07. 수정이력 :
 ************************************************************************************************
 *     수정일        이  름    사유
 ************************************************************************************************
 *     2015.06.11    심상준    최초 작성
 *     2014.10.07    심상준    최종 수정
 ************************************************************************************************
 */
 
/*===============================================================================================
 * [ PART 1 ] Form에서 Include 할 라이브러리(xjs)파일 정의
================================================================================================*/
include "LIB::common.xjs"; //공통함수 호출

/*===============================================================================================
 * [ PART 2 ] Form에서 사용될 전역변수를 선언
================================================================================================*/
var select_data = ""; //그리드 드래그 이벤트관련 변수 

//사용자데이터권한역할 그리드 페이징 변수
var syspoldtlpage = 1;
var syspoldtlpgsize = 50;
var syspoldtltotalcnt = 0 ;

//전체권한그리드 페이징 변수
var rolpage = 1;
var rolpgsize = 100;
var rolotalcnt = 0 ;
/*===============================================================================================
 * [ PART 3 ] Form Event 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : Form Load Event
-----------------------------------------------------------------------------------------------*/
function Form_onload(obj:Form, e:LoadEventInfo)
{
	
	//공통 Form 초기화
	gfn_setInitForm(obj, e, "FRM0014M")
 	//Form 초기 개발자 셋팅
 	//공통코드 초기화
 	fn_setInitCode(obj, e);
 	//그리드 초기화
 	fn_setInitGrid(obj, e);
 	//기본값 초기화
 	fn_setInitForm(obj, e);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : Form 종료전 Check 함수(공통)
-----------------------------------------------------------------------------------------------*/
function Form_checkBeforeClose()
{
	//변경된 Dataset검증
	if ( gfn_formBeforeOnClose(this, "ds_UserAutrrolList") ) {
		return true;
	} else {
		return false;
	}
}

/*===============================================================================================
 * [ PART 4 ] Load 후 초기설정
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 공통코드 초기화
-----------------------------------------------------------------------------------------------*/
function fn_setInitCode(obj:Form, e:LoadEventInfo)
{
	var strCode =  "SCC014=ds_SCC014=S";
				
	gfn_getCodeDs( this
				  , strCode
				  ,"fn_afterCodeCallBack");	
			  
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 공통코드 호출 후 처리
-----------------------------------------------------------------------------------------------*/
function fn_afterCodeCallBack()
{		  	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 그리드 초기화
-----------------------------------------------------------------------------------------------*/
function fn_setInitGrid(obj:Form, e:LoadEventInfo)
{

}

/*----------------------------------------------------------------------------------------------
 * 설명   : 기본값 설정
-----------------------------------------------------------------------------------------------*/
function fn_setInitForm(obj:Form, e:LoadEventInfo)
{
	div_search.edt_usernm.setFocus();
	page = 1;
	page_size = 30;
	div01.btn_copy.enable = false;
	
	// 그리드 초기화 
	//gfn_initGrid(grd_main, bReadonly, bSortable, bTooltip, sSelectType, innerDs);
	gfn_initGrid(div01.UserGrid02, false, true, true, "multirow", "ds_gridMenuList1");
	gfn_initGrid(div01.UserGrid01, true, true, true, "multirow", "");
}

/*===============================================================================================
 * [ PART 5 ] Transaction 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 메인조회
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_searchMain()
{
	fn_dsClear();	
	var sSvcID		 = "searchMain";
	var sTrID		 = "PSCUserAutRolMgmt_pInqUserAutrRolLst";
	var sPtrn		 = "R";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "ncFieldMap=ds_ncFieldMap";
	var sOutputDs	 = "ds_UserAutrrolList=RS_USER_ROL_LIST";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}
//데이타셋 clear
function fn_dsClear(){
	ds_UserAutrrolList.clearData();		
    ds_UserAutrrolList_show.clearData();
    ds_autrRol.clear();
    ds_usrData.clearData();
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 메인저장
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_saveMain()
{
	var sSvcID		 = "saveMain";
	var sTrID		 = "PSCUserAutRolMgmt_pSaveUserAutrRol";
	//var sPtrn		 = ds_UserAutrrolList.getRowType(ds_UserAutrrolList.rowposition) == Dataset.ROWTYPE_INSERT? "I" : "U";  //입력C,조회R,수정U,삭제D,복합M
	var sPtrn		 = "M";
	var sInputDs	 = "RS_USER_ROL_LIST=ds_UserAutrrolList:u";
	var sOutputDs	 = "";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 데이터권한역할삭제
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_DelMain()
{
	ds_UserAutrrolList.updatecontrol = false;
	ds_UserAutrrolList.setRowType(ds_UserAutrrolList.rowposition, Dataset.ROWTYPE_DELETE);
	ds_UserAutrrolList.updatecontrol = true;
	
	var sSvcID		 = "delMain";
	var sTrID		 = "PSCUserAutRolMgmt_pSaveUserAutrRol";
	var sPtrn		 = "D";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "RS_USER_ROL_LIST=ds_UserAutrrolList:u";
	var sOutputDs	 = "";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 권한역할조회
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_searchRol()
{
	page = rolpage;
	page_size = rolpgsize;
	
	var sSvcID		 = "searchRol";
	var sTrID		 = "PSCAutrRolMgmt_pInqAutrRolLst";
	var sPtrn		 = "R";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "";
	var sOutputDs	 = "ds_autrRolTemp=RS_AUTR_ROL_LIST";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);	
}


/*----------------------------------------------------------------------------------------------
 * 설명   : 데이터역할조회
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_searchData()
{
	page = syspoldtlpage;
	page_size = syspoldtlpgsize;
	var sSvcID		 = "searchData";
	var sTrID		 = "PSCUserAutRolMgmt_pInqUserDataRolLst";
	var sPtrn		 = "R";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "ncFieldMap=ds_ncFieldMap";
	var sOutputDs	 = "ds_usrDataTemp=RS_USER_DATA_ROL_LIST";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
	
}



/*----------------------------------------------------------------------------------------------
 * 설명   : 사용자권한역할복사
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_copyRol()
{	
	var sSvcID		 = "copyRol";
	var sTrID		 = "PSCUserAutRolMgmt_pCpUserAutrRol";
	//var sPtrn		 = "M";  //입력C,조회R,수정U,삭제D,복합M
	var sPtrn	     = ds_UserAutrrolList.getRowType(ds_UserAutrrolList.rowposition) == Dataset.ROWTYPE_INSERT? "I" : "I";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "RS_COPY_ROL=ds_usrCopy";
	var sOutputDs	 = "";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
	
}

/*===============================================================================================
 * [ PART 6 ] CallBack 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : Transaction CallBack
 * param   : sSvcID, iErrorCode, sErrorMsg(ncMsgId,ncMsg)
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_callBack(sSvcID, iErrorCode, sErrorMsg, ncMsgId, ncMsg)
{

	switch(sSvcID) {
		case "searchMain" : 
			if ( iErrorCode == 0 ) {
				if(div01.UserGrid02.rowcount == 0){
					gfn_setGridTitleCountPaging(div01.stc_subTitle02, "0");
				}else{
					gfn_setGridTitleCountPaging(div01.stc_subTitle02, div01.UserGrid02.rowcount);
				}
				gfn_message("B","DMS00001");	//MSGI0003 :정상 조회되었습니다.
				
				//버튼 enable
				div01.btn_roll_add.enable = true;
				div01.btn_roll_del.enable = true;
				div01.btn_reset_copy.enable = true;
				div01.btn_save.enable = true;
				div01.edt_user_no1.enable = true;
				div01.edt_usernm1.enable = true;
				div01.btn_copy.enable = true;
				div01.btn_search_copy.enable = true;
				div01.btn_search_filter.enable = true;
				div01.btn_reset_filter.enable = true;
				
				// 사용자화면권한역할 조회 후 Callback에서 권한역할 목록과 데이터권한역할 조회
				fn_searchRol();
				//fn_searchData();
			}
			
		break;
		case "searchRol" : 
		
			//페이징 관련셋팅
			ds_autrRol.appendData(ds_autrRolTemp,true);	
			syspoldtltotalcnt = rolotalcnt;
			
			//전체권한목록중 사용자권한데이터셋과 중복되는 데이터 필터처리 
			fn_filterDupData();
			
		break;	
			
		case "searchData" : 
				//페이징 관련셋팅
				ds_usrData.appendData(ds_usrDataTemp,true);									
				gfn_setGridTitleCountPaging(div02.stc_subTitle02, total_record_cnt);				
				syspoldtltotalcnt = total_record_cnt;
				
		break;		
			
		case "saveMain" : 
			if ( iErrorCode == 0 ) {
				gfn_message("A","DMS00000","I");	//MSGI0001 : 정상 처리되었습니다.
				btn_search_onclick();
			} 
		break;
	
		case "delMain" : 
			if ( iErrorCode == 0 ) {
				gfn_message("A","DMS00000","I");	//MSGI0001 : 정상 처리되었습니다.
			} 
			ds_UserAutrrolList.reset();
		break;	
			
		case "copyRol" : 
			if ( iErrorCode == 0 ) {
				gfn_message("A","DMS00000","I");	//MSGI0001 : 정상 처리되었습니다.
				btn_search_onclick();				//권한복사 후 조회
			}
		break;
		
		default :
		break;
	}
}

/*===============================================================================================
 * [ PART 7 ] Main Button Event
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : search
-----------------------------------------------------------------------------------------------*/
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{	
	if(div_search.edt_user_no.value == null || div_search.edt_user_no.value.length == 0
	 && div_search.edt_usernm.value == null || div_search.edt_usernm.value.length == 0)
	{
		gfn_message("A","DMS00023","I","","사용자정보");
		btn_Popup_onclick();
		return false;
	}
	
	// 입력 항목 Validate Check
	if (!gfn_getValidateCompList(div_search)) {	
		return false;
	}
	
	//페이지초기화
	rolpage = 1;
	syspoldtlpage = 1;
	//조회함수 호출 
	fn_searchMain();
		
	div01.edt_user_no1.value = null;
	div01.edt_usernm1.value  = null;
}



/*----------------------------------------------------------------------------------------------
 * 설명   : resetrol
-----------------------------------------------------------------------------------------------*/
function btn_reset_onclick_rol(obj:Button,  e:ClickEventInfo)
{
	div01.edt_user_no1.value = "";
	div01.edt_usernm1.value = "";
}

/*----------------------------------------------------------------------------------------------
 * 설명   : print
-----------------------------------------------------------------------------------------------*/
function btn_print_onclick(obj:Button,  e:ClickEventInfo)
{
	alert("Report 출력");
}

/*----------------------------------------------------------------------------------------------
 * 설명   : save
-----------------------------------------------------------------------------------------------*/
function btn_save_onclick(obj:Button,  e:ClickEventInfo)
{	
	if ( fn_chkBeforeSave() && fn_GridValidationChk1() ) {
		fn_saveMain();
	}
   
}

/************************************************************************************************
 * 설명   :   > 버튼 클릭시 이벤트  
 * param   : obj - Button
 * param   : e  - ClickEventInfo
*************************************************************************************************/
function div01_btn_roll_del_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_del_rol(e.row); //행삭제 
}
/************************************************************************************************
 * 설명   :   >> 버튼 클릭시 이벤트  
 * param   : obj - Button
 * param   : e  - ClickEventInfo
*************************************************************************************************/
function div01_Button45_onclick(obj:Button,  e:ClickEventInfo)
{
	//전체 권한 선택
	for(var i = 0; i < ds_UserAutrrolList.getRowCount(); i++){
		ds_UserAutrrolList.selectRow(i);
	}
	fn_del_rol();
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 사용자권한목록 그리드 oncelldblclick 이벤트
 * param   : obj - Grid
 * param   : e  - GridClickEventInfo
-----------------------------------------------------------------------------------------------*/
function div01_UserGrid02_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	 fn_del_rol(e.row); //행삭제 
}
/************************************************************************************************
 * 설명   : 수직   마지막에 도달했을때 페이지 조회 이벤트
 * param   : obj - Button
 * param   : e  - ClickEventInfo
 * return  : void
*************************************************************************************************/
function fn_del_rol(nRow)
{
	/*if ( ds_UserAutrrolList.rowposition != -1 && ds_UserAutrrolList.getRowType(ds_UserAutrrolList.rowposition) == Dataset.ROWTYPE_INSERT) {		
		gfn_message("A","DMS00025","E"); //삭제할 수 없는 데이터 입니다.
		return;
	}
	*/
	
    if(nRow != null && nRow > -1){
    //특정 선택row 파라미터가 있는 경우 		
		//전체권한 데이터셋에 삭제대상 권한 추가 
		fn_row_change2(nRow);
         //선택권한 삭제
		ds_UserAutrrolList.deleteRow(nRow);
    } else {
		
		//선택한 행이 없으면 return
		if(ds_UserAutrrolList.rowposition <0 ){
			return;
		}
		
	    var totCnt = ds_UserAutrrolList.getRowCount();
	    var delRowArray = new Array();
	    for(var i = 0; i < totCnt; i++){
			if(ds_UserAutrrolList.getSelect(i)){
				  delRowArray[delRowArray.length] = i; 
				 //전체권한 데이터셋에 삭제대상 권한 추가 
				 fn_row_change2(i);
			}
		} //loop end				
		for(var j=delRowArray.length-1; j>=0;j--){
			//사용자권한 dataset의  선택한 row 삭제 
			ds_UserAutrrolList.deleteRow(delRowArray[j]);	
		}//loop2 end		
    }	
    
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 사용자권한데이터셋과 중복되는 데이터 화면권한역할데이터셋 필터처리 
-----------------------------------------------------------------------------------------------*/
function fn_filterDupData()
{ 
	var sRolId = "";
	var sFilter = "";
	//사용자권한데이터셋 조사 
	for(var i=0; i< ds_UserAutrrolList.getRowCount(); i++){
		sRolId = ds_UserAutrrolList.getColumn(i,"AUTR_ROL_ID");
		if(i == 0){
			sFilter = "AUTR_ROL_ID != '"+sRolId+"'";
		} else {
			sFilter += " && "+"AUTR_ROL_ID != '"+sRolId+"'";
		}
	}   
	//필터초기화 
	ds_autrRol.filter("");  
	if(sFilter != null && sFilter != ""){
		ds_autrRol.filter(sFilter);    
	}	
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 선택한 데이터를 전체권한 데이터셋에 추가한다.
-----------------------------------------------------------------------------------------------*/
function fn_row_change2(nRow)
{  
	var rolId = ds_UserAutrrolList.getColumn(nRow,"AUTR_ROL_ID");
	var rolNm = ds_UserAutrrolList.getColumn(nRow,"AUTR_ROL_NM");
	var chkCnt =0;
	//중복된 데이터가 있는지 확인 
	for(var i=0; i<ds_autrRol.getRowCount(); i++ ){
		if(ds_autrRol.getColumn(i,"AUTR_ROL_ID")==rolId){
			chkCnt++;
		}
	}
	//중복된 데이터가 없는 경우 데이터추가 
	if(chkCnt ==0){
		var row = ds_autrRol.addRow();
		ds_autrRol.setColumn(row,"AUTR_ROL_ID",rolId);
		ds_autrRol.setColumn(row,"AUTR_ROL_NM",rolNm);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : grid filter : 화면권한역할 - 권한역할명 입력으로 LIKE Filter
-----------------------------------------------------------------------------------------------*/
function btn_filter_onclick(obj:Button,  e:ClickEventInfo)
{   
	if(gfn_isNull(div01.edt_autrRol.value)){
		fn_filterDupData();
		return false;
	}
	
	var str = div01.edt_autrRol.value;
	ds_autrRol.filter("String(AUTR_ROL_NM).indexOf(\""+str+"\") >= 0");
	
}

/*----------------------------------------------------------------------------------------------
 * 설명   :  필터 Enter key 입력시 이벤트 
-----------------------------------------------------------------------------------------------*/
function div01_edt_autrRol_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == KEYCODE_ENTER) {
		btn_filter_onclick();
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : grid excel
-----------------------------------------------------------------------------------------------*/
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	alert("그리드 Excel Down Load");
}

/*----------------------------------------------------------------------------------------------
 * 설명   : grid expand
-----------------------------------------------------------------------------------------------*/
function btn_expand_onclick(obj:Button,  e:ClickEventInfo)
{
	alert("그리드 확장");
}


/*----------------------------------------------------------------------------------------------
 * 설명   : 권한가져오기
-----------------------------------------------------------------------------------------------*/
function div_copy_btn_copy_onclick(obj:Button,  e:ClickEventInfo)
{
	if(gfn_isNull(gfn_trim(div_search.copy_edt_user_no.value))){
		gfn_message("A","DMS00023","E","","복사대상사용자번호");
		btn_Popup_onclick();
		return false;
	}
	/*	
	if(gfn_isEmpty(div01.edt_user_no1.value)){
		gfn_message("A","DMS00023","I","","원본사용자번호/원본사용자명");
		btn_Popup_onclick2();
		return false;
	}
	*/
	/*if(ds_UserAutrrolList.rowcount == 0){
	 gfn_message("A","HPC00064","I","","사용자화면권한역할");
	 return false;
	} */
	
	// 입력 항목 Validate Check
	if (!gfn_getValidateCompList(div01)) {	
		return false;
	}
	
	ds_usrCopy.setColumn(0,"USER_NO",div_search.copy_edt_user_no.value);
	ds_usrCopy.setColumn(0,"USER_NO_CP",div01.edt_user_no1.value);
	fn_copyRol();
}

/*===============================================================================================
 * [ PART 8 ] Event
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 검색 조건에서 엔터키가 눌러졌을때 검색창 OPEN
-----------------------------------------------------------------------------------------------*/
function div_Search_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == KEYCODE_ENTER) {
		//div_search.btn_search.setFocus();
		//btn_search_onclick();
		btn_Popup_onclick();
	} else{
		if(obj.name=="edt_user_no" ) {   			
			div_search.edt_usernm.value = "";
			div_search.edt_login_id.value = "";
		} else if(obj.name =="edt_login_id" ) {
			div_search.edt_usernm.value = "";
			div_search.edt_user_no.value = "";
		} else if(obj.name =="edt_usernm" ) {
			div_search.edt_login_id.value = "";
			div_search.edt_user_no.value = "";		
		}
	}
}

function div_Copy_onkeydown(obj:Edit, e:KeyEventInfo)
{	
	if (e.keycode == KEYCODE_ENTER) {
		btn_Popup_onclick2();
	}	
	
}
/*===============================================================================================
 * [ PART 9 ] User Defined
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 저장전 유효성 검사
 * param   : 
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function fn_chkBeforeSave()	
{
	//저장전 수정,신규입력데이터의 trim처리 
	gfn_dsTrim(ds_UserAutrrolList);

	if(!gfn_isUpdated(ds_UserAutrrolList))//저장할 테이타셋 ds_Save
	{
		gfn_message("A","DMS00022","I");	//???? : 변경된 정보가 없습니다.
		return false;
	}	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명   : Validate Check (사용자권한역할)
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_GridValidationChk1(obj:Button,  e:ClickEventInfo)
{
	if (!gfn_dsValidCheck(div01.UserGrid02, dsListValidrol)) {
		return false;
	} else {
		return true;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : Validate Check ( 사용자데이터권한역할 )
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_GridValidationChk2(obj:Button,  e:ClickEventInfo)
{
	if (!gfn_dsValidCheck(div02.grd_data, dsListValid)) {
		return false;
	} else {
		return true;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 사용자 검색 팝업 (조회)
-----------------------------------------------------------------------------------------------*/
function btn_Popup_onclick(obj:Button,  e:ClickEventInfo)
{
	
	div_search.copy_edt_user_no.value = null;
	div_search.copy_edt_usernm.value = null;
	
	var sParam01 = div_search.edt_user_no.value;
	var sParam02 = div_search.edt_usernm.value;
	var sParam03 = "";
	var sParam04 = div_search.edt_login_id.value;
	if ( e == null ) {
		sParam03 = "key";
	} else {
		sParam03 = "button";
	}
	var arrArgs = {argAutoSelect:true, argCallProgram:"UserRolMgmtM", argParam01:sParam01, argParam02:sParam02, argParam03:sParam03, argParam04:sParam04, argParam05:""};
	var sRtnVal = gfn_dialog("FSC011P", arrArgs);

	if ( gfn_isNull(sRtnVal) || sRtnVal == "cancel" ) {
		//취소시 값 제거
		div_search.edt_user_no.value = null;
		div_search.edt_usernm.value = null;
		div_search.edt_login_id.value = null;
		
		div_search.copy_edt_user_no.value = null;
		div_search.copy_edt_usernm.value = null;
		div_search.copy_edt_login_id.value = null;
		
	} else {	//Object이용시
		
		div_search.edt_user_no.value = sRtnVal["value1"];
		div_search.edt_usernm.value = sRtnVal["value2"];
		div_search.edt_login_id.value = sRtnVal["value3"];
		div_search.copy_edt_user_no.value = sRtnVal["value1"];
		div_search.copy_edt_usernm.value = sRtnVal["value2"];
		div_search.copy_edt_login_id.value = sRtnVal["value3"];
		
		if( !gfn_isEmpty(div_search.copy_edt_user_no.value)) {		
			btn_search_onclick();
		}
		div_search.edt_usernm.setFocus();
	}
	
	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 사용자 검색 팝업 (권한복사대상자 조회)
-----------------------------------------------------------------------------------------------*/
function btn_Popup_onclick2(obj:Button,  e:ClickEventInfo)
{
	
	var sParam01 = div01.edt_user_no1.value;
	var sParam02 = div01.edt_usernm1.value;
	var sParam03 = "";
	if ( e == null ) {
		sParam03 = "key";
	} else {
		sParam03 = "button";
	}
	var arrArgs = {argAutoSelect:true, argCallProgram:"UserRolMgmtM", argParam01:sParam01, argParam02:sParam02, argParam03:sParam03, argParam04:"", argParam05:""};
	var sRtnVal = gfn_dialog("FSC011P", arrArgs);

	if ( gfn_isNull(sRtnVal) || sRtnVal == "cancel" ) {
		//취소시 값 제거
		div01.edt_user_no1.value = null;
		div01.edt_usernm1.value = null;
	} else {	//Object이용시
		div01.edt_user_no1.value = sRtnVal["value1"];
		div01.edt_usernm1.value = sRtnVal["value2"];
		
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 수직 스크롤바가 마지막에 도달했을때 페이지 조회 이벤트
 * param   : obj - Grid Object
 * param   : e  - ScrollEventInfo
 * return  : void
-----------------------------------------------------------------------------------------------*/
function grd_main_onvtracklast(obj:Grid, e:ScrollEventInfo)
{
	//trace("total_record_cnt = " + total_record_cnt);
	if ( rolotalcnt <=  rolpage * rolpgsize ) {
		gfn_message("B","DMS00028","I"); //조회 마지막 페이지 입니다.
		return;
	} else {
		//다음페이지 조회
		rolpage++;
		fn_searchRol();
	} 
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 사용자데이터권한역할 그리드의 onvtracklast 이벤트
 * param   : obj - Grid Object
 * param   : e  - ScrollEventInfo
 * return  : void
-----------------------------------------------------------------------------------------------*/
function div02_grd_data_onvtracklast(obj:Grid, e:ScrollEventInfo)
{
	if ( syspoldtltotalcnt <=  syspoldtlpage * syspoldtlpgsize ) {
		gfn_message("B","DMS00028","I"); //조회 마지막 페이지 입니다.
		return;
	} else {
		//다음페이지 조회
		syspoldtlpage++;
		//fn_searchData();
	} 
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 조회조건 리셋
-----------------------------------------------------------------------------------------------*/
function div_search_btn_reset_onclick(obj:Button,  e:ClickEventInfo)
{
	div_search.edt_user_no.value = "";
	div_search.edt_usernm.value = "";
	div_search.edt_login_id.value = "";
	
	div_search.copy_edt_user_no.value = "";
	div_search.copy_edt_usernm.value = "";
	div_search.copy_edt_login_id.value = "";
	
	fn_dsClear();
}

/*----------------------------------------------------------------------------------------------
 * 설명   : Filter 조건 및 결과  리셋
-----------------------------------------------------------------------------------------------*/
function btn_reset_filter_onclick(obj:Button,  e:ClickEventInfo)
{
	div01.edt_autrRol.value = "";
	fn_filterDupData();
	//ds_autrRol.filter("");
	//ds_autrRol.reset();
}

/************************************************************************************************
 * 설명   :   < 버튼 클릭시 이벤트  
 * param   : obj - Button
 * param   : e  - ClickEventInfo
*************************************************************************************************/
function div01_btn_roll_add_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_add_rol();
}

/*************************************************************************************************
 * 설명      : << 버튼 클릭시 이벤트  
 * param   : obj - Dataset
 * param   : e  - GridClickEventInfo
*************************************************************************************************/
function div01_Button44_onclick(obj:Button,  e:ClickEventInfo)
{
	//전체 권한 선택
	for(var i = 0; i < ds_autrRol.getRowCount(); i++){
		ds_autrRol.selectRow(i);
	}
	fn_add_rol();
}
/*************************************************************************************************
 * 설명      :  전체권한 그리드의 oncelldblclick 이벤트
 * param   : obj - Dataset
 * param   : e  - GridClickEventInfo
*************************************************************************************************/
function div01_UserGrid01_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	fn_add_rol(e.row);
}
/************************************************************************************************
 * 설명   :    전체권한 그리드에서 선택한 row 이동처리 
 * param   :  nRow 
 ************************************************************************************************/
function fn_add_rol(nRow)
{		
    if(nRow != null && nRow > -1){
    //특정 선택row 파라미터가 있는 경우 
        //데이터 이동처리 
		fn_row_change(nRow);
		
		//전제권한목록 dataset의  선택한 row 삭제 
		ds_autrRol.deleteRow(nRow);	
		
    } else {
	    var totCnt = ds_autrRol.getRowCount();
	    var delRowArray = new Array();
	    for(var i = 0; i < totCnt; i++){
			if(ds_autrRol.getSelect(i)){
				  delRowArray[delRowArray.length] = i; 
				 //권한있는화면목록으로 데이터 이동처리 
				 fn_row_change(i);
			}
		} //loop end				
		for(var j=delRowArray.length-1; j>=0;j--){
			//전제권한목록 dataset의  선택한 row 삭제 
			ds_autrRol.deleteRow(delRowArray[j]);	
		}//loop2 end		
    }	
}
/*----------------------------------------------------------------------------------------------
 * 설명   :  사용자권한 그리드로 선택한 데이터 이동처리 
 * param   :  nRow 
-----------------------------------------------------------------------------------------------*/
function fn_row_change(nRow){
		
	 // 권한 중복 Check
	var chkCnt =0;
    var addRolId = ds_autrRol.getColumn(nRow, "AUTR_ROL_ID");  // 추가 권한역할ID
    for(var i = 0 ; i < ds_UserAutrrolList.getRowCount() ; i++) {
		if (ds_UserAutrrolList.getColumn(i,"AUTR_ROL_ID") == addRolId) {
			chkCnt++;
		}
    }
    if(chkCnt ==0){
		var row = ds_UserAutrrolList.addRow();
		ds_UserAutrrolList.setColumn(row, "USER_NO" ,div_search.copy_edt_user_no.value);
		ds_UserAutrrolList.setColumn(row, "AUTR_ROL_ID", addRolId);
		ds_UserAutrrolList.setColumn(row, "AUTR_ROL_NM", ds_autrRol.getColumn( nRow, "AUTR_ROL_NM"));
		ds_UserAutrrolList.setColumn(row, "APLY_STA_DT", gfn_today());
		ds_UserAutrrolList.setColumn(row, "APLY_END_DT", '99991231');
		ds_UserAutrrolList.setColumn(row, "USE_YN", '1');
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명   :  화면 form ondragmove 이벤트
 * param   : obj - Form
 * param   : e  - DragEventInfo
-----------------------------------------------------------------------------------------------*/
function BUSC009M01_ondragmove(obj:Form, e:DragEventInfo)
{
	DragTextMove(obj,e);
}
/*----------------------------------------------------------------------------------------------
 * 설명   :   선택 권한의 drag and drop 
 * param   : obj - Form
 * param   : e  - DragEventInfo
-----------------------------------------------------------------------------------------------*/
function DragTextMove(obj:Form, e:DragEventInfo)
{
	//선택한 데이터가 담긴 static의 위치를 변경한다.
    if( sta_frmrol_N_Move.visible == true ) {
		div01.UserGrid01.selecttype="row";
		sta_frmrol_N_Move.move( e.clientX, e.clientY );
    } else if( sta_frmrol_Y_Move.visible == true ) {
		div01.UserGrid02.selecttype="row";
		sta_frmrol_Y_Move.move( e.clientX, e.clientY );
    } else {
		div01.UserGrid01.selecttype="multirow";
		div01.UserGrid02.selecttype="multirow";
    }
}
/*----------------------------------------------------------------------------------------------
 * 설명   :  전제권한 그리드 ondrag 이벤트
 * param   : obj - Dataset
 * param   : e  - GridDragEventInfo
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function div01_UserGrid01_ondrag(obj:Grid, e:GridDragEventInfo)
{
	//여러개 선택한 경우 드래그를 하지 않는다.  
     var selCnt = 0; 
     for(var i = 0; i < ds_autrRol.getRowCount(); i++){
		if(ds_autrRol.getSelect(i)){
			 selCnt++;
		}
	} //loop end	
   
    if(selCnt >1) { return; } 

	//움직일 텍스트의 바인드 데이터셋 초기화 
	ds_moving.clearData();
	ds_moving.insertRow(0);
	 //선택된 데이터 복사 
	select_data = e.row;
	var bSucc = ds_moving.copyRow(0,ds_autrRol,select_data);

	if(bSucc){
		sta_frmrol_N_Move.text = "  "+(select_data+1)+"     "+ds_moving.getColumn(0,"AUTR_ROL_ID")+"      "+ds_moving.getColumn(0,"AUTR_ROL_NM");
		var objDragData:DragDataObject = new DragDataObject();
		e.dragdata = select_data; //선택된 row index를 넘기기
		
		var cell_rect = obj.getCellRect(select_data, e.cell);
		sta_frmrol_N_Move.position.left = cell_rect.left;
		sta_frmrol_N_Move.move( e.clientX, e.clientY );
		sta_frmrol_N_Move.visible = true;
		
		return true;
	} else {
		return false;
	}
		
}
/*----------------------------------------------------------------------------------------------
 * 설명   :  전체권한목록 그리드 onlbuttonup 이벤트
 * param   : obj - Dataset
 * param   : e  - GridMouseEventInfo
-----------------------------------------------------------------------------------------------*/
function div01_UserGrid01_onlbuttonup(obj:UserGrid, e:GridMouseEventInfo)
{
	//선택한 데이터가 사용자권한그리드에 위치한 경우에만  데이터를 이동한다. 
    if( sta_frmrol_N_Move.visible == true ) {
	   //허용범위 구하기 
       var startX = div01.UserGrid02.position.left;
       var startY = div01.UserGrid02.position.top;
       var endX =  startX+ div01.UserGrid02.position.width;
       var endY =  startY+ div01.UserGrid02.position.height+50; //여유분 50px 
       //움직인 static항목의 위치구하기 
       var targetX = sta_frmrol_N_Move.position.left;
       var targetY = sta_frmrol_N_Move.position.top;
        
       //x좌표범위,Y좌표범위에 위치했는지 확인
      if((targetX> startX &&  targetX< endX ) && (targetY> startY && targetY < endY)){    
			//권한추가 
	    	fn_add_rol(select_data); 
		}
		//static항목 비활성화 
		sta_frmrol_N_Move.visible = false;
		div01.UserGrid01.selecttype="multirow";
		//선택row index 초기화
		select_data = "";
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명   :  사용자권한 그리드 ondrag 이벤트
 * param   : obj - Dataset
 * param   : e  - GridDragEventInfo
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function div01_UserGrid02_ondrag(obj:Grid, e:GridDragEventInfo)
{
	//여러개 선택한 경우 드래그를 하지 않는다.  
     var selCnt = 0; 
     for(var i = 0; i < ds_UserAutrrolList.getRowCount(); i++){
		if(ds_UserAutrrolList.getSelect(i)){
			 selCnt++;
		}
	} //loop end	
   
    if(selCnt >1) { return; } 
    
	 //선택된 데이터 복사 
	select_data = e.row;
	if(select_data > -1 ){
	
		sta_frmrol_Y_Move.text = "   "+ds_UserAutrrolList.getColumn(select_data,"AUTR_ROL_ID")+"      "+ds_UserAutrrolList.getColumn(select_data,"AUTR_ROL_NM");
		
		var objDragData:DragDataObject = new DragDataObject();
		e.dragdata = select_data; //선택된 row index를 넘기기
		
		var cell_rect = obj.getCellRect(select_data, e.cell);
		sta_frmrol_Y_Move.position.left = cell_rect.left;
		sta_frmrol_Y_Move.move( e.clientX, e.clientY );
		sta_frmrol_Y_Move.visible = true;
		
		return true;
	} else {
		return false;
	}
		
}
/*----------------------------------------------------------------------------------------------
 * 설명   :  사용자권한 그리드 onlbuttonup 이벤트
 * param   : obj - Dataset
 * param   : e  - GridMouseEventInfo
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function div01_UserGrid02_onlbuttonup(obj:UserGrid, e:GridMouseEventInfo)
{
	//선택한 데이터가 사용자권한그리드범위에서 벗어난  경우에만  데이터를 이동한다. 
    if( sta_frmrol_Y_Move.visible == true ) {
	   //허용범위 구하기 
       var startX = div01.UserGrid02.position.left;
       var startY = div01.UserGrid02.position.top;
       var endX =  startX+ div01.UserGrid02.position.width;
       var endY =  startY+ div01.UserGrid02.position.height;
       //움직인 static항목의 위치구하기 
       var targetX = sta_frmrol_Y_Move.position.left;
       var targetY = sta_frmrol_Y_Move.position.top;
        
        //endX좌표범위 밖으로 드래그했는지 확인
      if( targetX > endX ){    
			//사용자권한삭제
	    	fn_del_rol(select_data); //행삭제 
		}
		//static항목 비활성화 
		sta_frmrol_Y_Move.visible = false;
		div01.UserGrid02.selecttype="multirow";
		//선택row index 초기화
		select_data = "";
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명   :  form 내에서 esc버튼 클릭시 그리드 데이터셋 초기화 
 * param   : obj - Form
 * param   : e  - KeyEventInfo
 * return  : true/false
-----------------------------------------------------------------------------------------------*/
function BUSC009M01_onkeydown(obj:Form, e:KeyEventInfo)
{
	if(e.keycode ==KEYCODE_ESC) {	//ESC
		fn_dsClear();
		div_search.copy_edt_user_no.value = "";
		div_search.copy_edt_usernm.value = "";
		div_search.copy_edt_login_id.value = "";
	}
}
]]></Script>
  </Form>
</FDL>
