<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="DsptMgmtSndAmtRgstP" classname="popup_sample1" inheritanceid="" position="absolute 0 0 800 500" titletext="입금관리 단말기엑셀입력" class="frm_bg_popup" onload="Form_onload" visible="true">
    <Layouts>
      <Layout>
        <UserGrid id="grd_main" class="grd_subGrid" taborder="4" binddataset="ds_upLoadXlsList" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" hideendline="col" position="absolute 22 72 776 445" anchor="all" _number="true" _status="false" _check="false" _checkColumnName="_checkcol" _checkedallevent="false" _nodataimage="true" _sort="true" _tooltip="true" autofittype="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="107"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="105"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="모델코드"/>
                <Cell col="1" text="모델명"/>
                <Cell col="2" text="일련번호"/>
                <Cell col="3" text="고객명"/>
                <Cell col="4" text="상담일자"/>
                <Cell col="5" text="상담처코드"/>
                <Cell col="6" text="상담처명"/>
                <Cell col="7" text="개통일자"/>
                <Cell col="8" text="단말기등급"/>
                <Cell col="9" text="색상"/>
                <Cell col="10" text="분실단말기여부"/>
                <Cell col="11" text="보상반납대상여부"/>
                <Cell col="12" text="임대폰여부"/>
                <Cell col="13" text="USIM기변여부"/>
                <Cell col="14" text="타사/해외단말기여부"/>
                <Cell col="15" text="서비스번호"/>
                <Cell col="16" text="서비스관리번호"/>
                <Cell col="17" text="IMEI"/>
                <Cell col="18" text="요금공제여부"/>
                <Cell col="19" text="매입금액"/>
                <Cell col="20" text="검수구분"/>
                <Cell col="21" text="검수일자"/>
                <Cell col="22" text="고객의사"/>
                <Cell col="23" text="고객확인일자"/>
                <Cell col="24" text="예금주"/>
                <Cell col="25" text="은행코드"/>
                <Cell col="26" text="은행명"/>
                <Cell col="27" text="계좌번호"/>
                <Cell col="28" text="전화번호"/>
                <Cell col="29" text="우편번호"/>
                <Cell col="30" text="주소"/>
                <Cell col="31" text="기타주소"/>
                <Cell col="32" text="의견"/>
                <Cell col="33" text="T_관리번호"/>
                <Cell col="34" text="배터리"/>
                <Cell col="35" text="충전기"/>
                <Cell col="36" text="젠더"/>
                <Cell col="37" text="이어폰"/>
                <Cell col="38" text="충전 Case"/>
                <Cell col="39" text="USB CABLE"/>
                <Cell col="40" text="메모리카드"/>
                <Cell col="41" text="구성품_1"/>
                <Cell col="42" text="구성품_2"/>
                <Cell col="43" text="구성품_3"/>
                <Cell col="44" text="기타구성품"/>
                <Cell col="45" text="판매등급"/>
                <Cell col="46" text="ERROR"/>
              </Band>
              <Band id="body">
                <Cell text="bind:EQP_MDL_CD"/>
                <Cell col="1" style="align:left;" text="bind:PROD_NM"/>
                <Cell col="2" text="bind:EQP_SER_NO"/>
                <Cell col="3" text="bind:DPSTR"/>
                <Cell col="4" displaytype="date" text="bind:CNSL_DT" calendardisplaynulltype="none"/>
                <Cell col="5" text="bind:CNSL_DEALCO_CD"/>
                <Cell col="6" style="align:left;" text="bind:CON_PLC_NM" calendardisplaynulltype="none"/>
                <Cell col="7" displaytype="date" text="bind:ONING_DT" calendardisplaynulltype="none"/>
                <Cell col="8" displaytype="combo" text="bind:EQP_ST" combodataset="ds_DMS184" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM"/>
                <Cell col="9" displaytype="combo" text="bind:EQP_COLOR_CD" combodataset="ds_DMS100" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM"/>
                <Cell col="10" text="bind:LOSS_EQP_YN"/>
                <Cell col="11" text="bind:RWD_RTN_OBJ_YN"/>
                <Cell col="12" text="bind:RENTP_YN"/>
                <Cell col="13" text="bind:USIM_EQPCHG_YN"/>
                <Cell col="14" text="bind:OTHRCO_FORGN_EQP_YN"/>
                <Cell col="15" text="bind:SVC_NO"/>
                <Cell col="16" text="bind:SVC_MGMT_NO"/>
                <Cell col="17" text="bind:IMEI"/>
                <Cell col="18" text="bind:FEE_DEDC_YN"/>
                <Cell col="19" displaytype="number" style="align:right;" text="bind:SKN_JDG_AMT"/>
                <Cell col="20" text="bind:PRCH_CL"/>
                <Cell col="21" displaytype="date" text="bind:TLY_DT" calendardisplaynulltype="none"/>
                <Cell col="22" text="bind:CUST_IDEA"/>
                <Cell col="23" displaytype="date" text="bind:CUST_CHK_DT" calendardisplaynulltype="none"/>
                <Cell col="24" text="bind:ACC_NM"/>
                <Cell col="25" text="bind:BANK_CD"/>
                <Cell col="26" style="align:left;" text="bind:BANK_NM"/>
                <Cell col="27" text="bind:ACCO_NO"/>
                <Cell col="28" text="bind:TEL_NO"/>
                <Cell col="29" text="bind:ZIPCD"/>
                <Cell col="30" style="align:left;" text="bind:ADDR"/>
                <Cell col="31" style="align:left;" text="bind:ETC_ADDR"/>
                <Cell col="32" style="align:left;" text="bind:SUGG"/>
                <Cell col="33" text="bind:T_MGMT_NO"/>
                <Cell col="34" text="bind:BATTERY"/>
                <Cell col="35" text="bind:CHARGER"/>
                <Cell col="36" text="bind:ZENDER"/>
                <Cell col="37" text="bind:EARPHONES"/>
                <Cell col="38" text="bind:CASE"/>
                <Cell col="39" text="bind:USB"/>
                <Cell col="40" text="bind:MEMORY"/>
                <Cell col="41" text="bind:DTL_1"/>
                <Cell col="42" text="bind:DTL_2"/>
                <Cell col="43" text="bind:DTL_3"/>
                <Cell col="44" text="bind:OTHER"/>
                <Cell col="45" style="align:left;" text="bind:SELL_GRADE"/>
                <Cell col="46" style="align:left;color:red;" text="bind:ERR_DESC"/>
              </Band>
            </Format>
          </Formats>
        </UserGrid>
        <Button id="btn_errCheck" taborder="2" text="오류검증" onclick="btn_errCheck_onclick" class="btn_common" position="absolute 656 49 725 69" anchor="top right" tabstop="false"/>
        <Button id="btn_addFileOne" taborder="1" text="파일추가" onclick="btn_addFileOne_onclick" class="btn_common" position="absolute 586 49 655 69" anchor="top right" tabstop="false"/>
        <Button id="btn_delete" taborder="3" text="삭제" onclick="btn_delete_onclick" class="btn_common_delTxt" position="absolute 726 49 776 69" anchor="top right" tabstop="false"/>
        <Button id="btn_excel" taborder="0" tabstop="false" text="엑셀양식" onclick="btn_excel_onclick" class="btn_common" position="absolute 516 49 585 69" anchor="top right"/>
        <Static id="Static01" text="w&#13;&#10;&#13;&#10;15" class="tip_guide" visible="false" position="absolute 776 10 791 410"/>
        <Static id="Static03" text="w&#13;&#10;&#13;&#10;15" class="tip_guide" visible="false" position2="absolute l:7 w:15 t:10 h:400" positiontype="position2"/>
        <Static id="Static07" text="h10" class="tip_guide" visible="false" position2="absolute l:364 w:74 t:445 h:10" positiontype="position2"/>
        <Static id="Static06" text="h15" class="tip_guide" visible="false" position2="absolute l:376 w:42 t:475 h:15" positiontype="position2"/>
        <Static id="Static20" text="w&#13;&#10;&#13;5" class="tip_guide" visible="false" position2="absolute l:396 w:5 t:454 h:18" positiontype="position2"/>
        <Div id="Div00" taborder="5" text="Div00" position="absolute 330 455 472 475">
          <Layouts>
            <Layout>
              <Button id="btn_cancel" taborder="3" text="취소" onclick="button_onclick" class="btn_popup_cancel" position="absolute 71 0 126 20"/>
              <Button id="btn_excelSave" taborder="4" text="저장" onclick="div_search_btn_excelSave_onclick" class="btn_popup_save" enable="false" position="absolute 11 0 66 20"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static05" text="h10" class="tip_guide" visible="false" position2="absolute l:37 w:42 t:6 h:10" positiontype="position2"/>
        <Static id="Static04" text="h33" class="tip_guide" visible="false" position2="absolute l:480 w:34 t:39 h:33" positiontype="position2"/>
        <Button id="btn_close" taborder="7" onclick="button_onclick" class="popUp_close" position="absolute 758 13 776 31"/>
        <Div id="Div01" taborder="8" text="입금관리 단말기 엑셀입력" class="popUp_title_bg" transparenthittest="true" position="absolute 21 12 775 40"/>
        <UserGrid id="grd_mainExcel" class="grd_subGrid" taborder="9" binddataset="ds_upLoadXlsList" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" hideendline="col" position="absolute 816 72 1302 170" anchor="all" _number="false" _status="false" _check="false" _checkColumnName="_checkcol" _checkedallevent="false" _nodataimage="true" _sort="true" _tooltip="true" visible="false" autofittype="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="107"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="105"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="모델코드"/>
                <Cell col="1" text="모델명"/>
                <Cell col="2" text="일련번호"/>
                <Cell col="3" text="고객명"/>
                <Cell col="4" text="상담일자"/>
                <Cell col="5" text="상담처코드"/>
                <Cell col="6" text="상담처명"/>
                <Cell col="7" text="개통일자"/>
                <Cell col="8" text="단말기등급"/>
                <Cell col="9" text="색상"/>
                <Cell col="10" text="분실단말기여부"/>
                <Cell col="11" text="보상반납대상여부"/>
                <Cell col="12" text="임대폰여부"/>
                <Cell col="13" text="USIM기변여부"/>
                <Cell col="14" text="타사/해외단말기여부"/>
                <Cell col="15" text="서비스번호"/>
                <Cell col="16" text="서비스관리번호"/>
                <Cell col="17" text="IMEI"/>
                <Cell col="18" text="요금공제여부"/>
                <Cell col="19" text="매입금액"/>
                <Cell col="20" text="검수구분"/>
                <Cell col="21" text="검수일자"/>
                <Cell col="22" text="고객의사"/>
                <Cell col="23" text="고객확인일자"/>
                <Cell col="24" text="예금주"/>
                <Cell col="25" text="은행코드"/>
                <Cell col="26" text="은행명"/>
                <Cell col="27" text="계좌번호"/>
                <Cell col="28" text="전화번호"/>
                <Cell col="29" text="우편번호"/>
                <Cell col="30" text="주소"/>
                <Cell col="31" text="기타주소"/>
                <Cell col="32" text="의견"/>
                <Cell col="33" text="T_관리번호"/>
                <Cell col="34" text="배터리"/>
                <Cell col="35" text="충전기"/>
                <Cell col="36" text="젠더"/>
                <Cell col="37" text="이어폰"/>
                <Cell col="38" text="충전 Case"/>
                <Cell col="39" text="USB CABLE"/>
                <Cell col="40" text="메모리카드"/>
                <Cell col="41" text="구성품_1"/>
                <Cell col="42" text="구성품_2"/>
                <Cell col="43" text="구성품_3"/>
                <Cell col="44" text="기타구성품"/>
                <Cell col="45" text="판매등급"/>
                <Cell col="46" text="ERROR"/>
              </Band>
              <Band id="body">
                <Cell text="bind:EQP_MDL_CD"/>
                <Cell col="1" style="align:left;" text="bind:PROD_NM"/>
                <Cell col="2" text="bind:EQP_SER_NO"/>
                <Cell col="3" text="bind:DPSTR"/>
                <Cell col="4" displaytype="date" text="bind:CNSL_DT" calendardisplaynulltype="none"/>
                <Cell col="5" text="bind:CNSL_DEALCO_CD"/>
                <Cell col="6" style="align:left;" text="bind:CON_PLC_NM" calendardisplaynulltype="none"/>
                <Cell col="7" displaytype="date" text="bind:ONING_DT" calendardisplaynulltype="none"/>
                <Cell col="8" displaytype="combo" text="bind:EQP_ST" combodataset="ds_DMS184" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM"/>
                <Cell col="9" displaytype="combo" text="bind:EQP_COLOR_CD" combodataset="ds_DMS100" combocodecol="CM_CD_ID" combodatacol="CM_CD_NM"/>
                <Cell col="10" text="bind:LOSS_EQP_YN"/>
                <Cell col="11" text="bind:RWD_RTN_OBJ_YN"/>
                <Cell col="12" text="bind:RENTP_YN"/>
                <Cell col="13" text="bind:USIM_EQPCHG_YN"/>
                <Cell col="14" text="bind:OTHRCO_FORGN_EQP_YN"/>
                <Cell col="15" text="bind:SVC_NO"/>
                <Cell col="16" text="bind:SVC_MGMT_NO"/>
                <Cell col="17" text="bind:IMEI"/>
                <Cell col="18" text="bind:FEE_DEDC_YN"/>
                <Cell col="19" displaytype="number" style="align:right;" text="bind:SKN_JDG_AMT"/>
                <Cell col="20" text="bind:PRCH_CL"/>
                <Cell col="21" displaytype="date" text="bind:TLY_DT" calendardisplaynulltype="none"/>
                <Cell col="22" text="bind:CUST_IDEA"/>
                <Cell col="23" displaytype="date" text="bind:CUST_CHK_DT" calendardisplaynulltype="none"/>
                <Cell col="24" text="bind:ACC_NM"/>
                <Cell col="25" text="bind:BANK_CD"/>
                <Cell col="26" style="align:left;" text="bind:BANK_NM"/>
                <Cell col="27" text="bind:ACCO_NO"/>
                <Cell col="28" text="bind:TEL_NO"/>
                <Cell col="29" text="bind:ZIPCD"/>
                <Cell col="30" style="align:left;" text="bind:ADDR"/>
                <Cell col="31" style="align:left;" text="bind:ETC_ADDR"/>
                <Cell col="32" style="align:left;" text="bind:SUGG"/>
                <Cell col="33" text="bind:T_MGMT_NO"/>
                <Cell col="34" text="bind:BATTERY"/>
                <Cell col="35" text="bind:CHARGER"/>
                <Cell col="36" text="bind:ZENDER"/>
                <Cell col="37" text="bind:EARPHONES"/>
                <Cell col="38" text="bind:CASE"/>
                <Cell col="39" text="bind:USB"/>
                <Cell col="40" text="bind:MEMORY"/>
                <Cell col="41" text="bind:DTL_1"/>
                <Cell col="42" text="bind:DTL_2"/>
                <Cell col="43" text="bind:DTL_3"/>
                <Cell col="44" text="bind:OTHER"/>
                <Cell col="45" style="align:left;" text="bind:SELL_GRADE"/>
                <Cell col="46" style="align:left;color:red;" text="bind:ERR_DESC"/>
              </Band>
            </Format>
          </Formats>
        </UserGrid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_ncFieldMap" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="USER_NO" type="STRING" size="256"/>
          <Column id="USER_NM" type="STRING" size="256"/>
          <Column id="USER_CL_CD" type="STRING" size="256"/>
          <Column id="USER_ST_CD" type="STRING" size="256"/>
          <Column id="GRPC_CO_CD" type="STRING" size="256"/>
          <Column id="LGIN_ID" type="STRING" size="256"/>
          <Column id="HP_NO" type="STRING" size="256"/>
          <Column id="EML_ADDR" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_DMS002" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS002G" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upLoadXlsList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EQP_MDL_CD" type="STRING" size="256"/>
          <Column id="PROD_NM" type="STRING" size="256"/>
          <Column id="EQP_SER_NO" type="STRING" size="256"/>
          <Column id="DPSTR" type="STRING" size="256"/>
          <Column id="CNSL_DT" type="STRING" size="256"/>
          <Column id="CNSL_DEALCO_CD" type="STRING" size="256"/>
          <Column id="CON_PLC_NM" type="STRING" size="256"/>
          <Column id="ONING_DT" type="STRING" size="256"/>
          <Column id="EQP_ST" type="STRING" size="256"/>
          <Column id="EQP_COLOR_CD" type="STRING" size="256"/>
          <Column id="LOSS_EQP_YN" type="STRING" size="256"/>
          <Column id="RWD_RTN_OBJ_YN" type="STRING" size="256"/>
          <Column id="RENTP_YN" type="STRING" size="256"/>
          <Column id="USIM_EQPCHG_YN" type="STRING" size="256"/>
          <Column id="OTHRCO_FORGN_EQP_YN" type="STRING" size="256"/>
          <Column id="SVC_NO" type="STRING" size="256"/>
          <Column id="SVC_MGMT_NO" type="STRING" size="256"/>
          <Column id="IMEI" type="STRING" size="256"/>
          <Column id="FEE_DEDC_YN" type="STRING" size="256"/>
          <Column id="SKN_JDG_AMT" type="STRING" size="256"/>
          <Column id="PRCH_CL" type="STRING" size="256"/>
          <Column id="TLY_DT" type="STRING" size="256"/>
          <Column id="CUST_IDEA" type="STRING" size="256"/>
          <Column id="CUST_CHK_DT" type="STRING" size="256"/>
          <Column id="CTZ_NO" type="STRING" size="256"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="BANK_NM" type="STRING" size="256"/>
          <Column id="ACCO_NO" type="STRING" size="256"/>
          <Column id="TEL_NO" type="STRING" size="256"/>
          <Column id="ZIPCD" type="STRING" size="256"/>
          <Column id="ADDR" type="STRING" size="256"/>
          <Column id="ETC_ADDR" type="STRING" size="256"/>
          <Column id="SUGG" type="STRING" size="256"/>
          <Column id="T_MGMT_NO" type="STRING" size="256"/>
          <Column id="BATTERY" type="STRING" size="256"/>
          <Column id="CHARGER" type="STRING" size="256"/>
          <Column id="ZENDER" type="STRING" size="256"/>
          <Column id="EARPHONES" type="STRING" size="256"/>
          <Column id="CASE" type="STRING" size="256"/>
          <Column id="USB" type="STRING" size="256"/>
          <Column id="MEMORY" type="STRING" size="256"/>
          <Column id="DTL_1" type="STRING" size="256"/>
          <Column id="DTL_2" type="STRING" size="256"/>
          <Column id="DTL_3" type="STRING" size="256"/>
          <Column id="OTHER" type="STRING" size="256"/>
          <Column id="SELL_GRADE" type="STRING" size="256"/>
          <Column id="ERR_DESC" type="STRING" size="256"/>
          <Column id="SKN_CL" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS100" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS166" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS179" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DMS184" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="CM_GRP_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_ID" type="STRING" size="256"/>
          <Column id="CHG_DTM" type="STRING" size="256"/>
          <Column id="CM_CD_NM" type="STRING" size="256"/>
          <Column id="CM_CD_DESC" type="STRING" size="256"/>
          <Column id="CM_CD_SORT_ORD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SUP_CM_GRP_CD_ID" type="STRING" size="256"/>
          <Column id="SUP_CM_CD_ID" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD1" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD2" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD3" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD4" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD5" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD6" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD7" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD8" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD9" type="STRING" size="256"/>
          <Column id="MGMT_ITEM_CD10" type="STRING" size="256"/>
          <Column id="FS_REG_USER_ID" type="STRING" size="256"/>
          <Column id="FS_REG_DTM" type="STRING" size="256"/>
          <Column id="LS_CHG_USER_ID" type="STRING" size="256"/>
          <Column id="LS_CHG_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upLoadChkXlsList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EQP_MDL_CD" type="STRING" size="256"/>
          <Column id="PROD_NM" type="STRING" size="256"/>
          <Column id="EQP_SER_NO" type="STRING" size="256"/>
          <Column id="DPSTR" type="STRING" size="256"/>
          <Column id="CNSL_DT" type="STRING" size="256"/>
          <Column id="CNSL_DEALCO_CD" type="STRING" size="256"/>
          <Column id="CON_PLC_NM" type="STRING" size="256"/>
          <Column id="ONING_DT" type="STRING" size="256"/>
          <Column id="EQP_ST" type="STRING" size="256"/>
          <Column id="EQP_COLOR_CD" type="STRING" size="256"/>
          <Column id="LOSS_EQP_YN" type="STRING" size="256"/>
          <Column id="RWD_RTN_OBJ_YN" type="STRING" size="256"/>
          <Column id="RENTP_YN" type="STRING" size="256"/>
          <Column id="USIM_EQPCHG_YN" type="STRING" size="256"/>
          <Column id="OTHRCO_FORGN_EQP_YN" type="STRING" size="256"/>
          <Column id="SVC_NO" type="STRING" size="256"/>
          <Column id="SVC_MGMT_NO" type="STRING" size="256"/>
          <Column id="IMEI" type="STRING" size="256"/>
          <Column id="FEE_DEDC_YN" type="STRING" size="256"/>
          <Column id="SKN_JDG_AMT" type="STRING" size="256"/>
          <Column id="PRCH_CL" type="STRING" size="256"/>
          <Column id="TLY_DT" type="STRING" size="256"/>
          <Column id="CUST_IDEA" type="STRING" size="256"/>
          <Column id="CUST_CHK_DT" type="STRING" size="256"/>
          <Column id="CTZ_NO" type="STRING" size="256"/>
          <Column id="BANK_CD" type="STRING" size="256"/>
          <Column id="BANK_NM" type="STRING" size="256"/>
          <Column id="ACCO_NO" type="STRING" size="256"/>
          <Column id="TEL_NO" type="STRING" size="256"/>
          <Column id="ZIPCD" type="STRING" size="256"/>
          <Column id="ADDR" type="STRING" size="256"/>
          <Column id="ETC_ADDR" type="STRING" size="256"/>
          <Column id="SUGG" type="STRING" size="256"/>
          <Column id="T_MGMT_NO" type="STRING" size="256"/>
          <Column id="BATTERY" type="STRING" size="256"/>
          <Column id="CHARGER" type="STRING" size="256"/>
          <Column id="ZENDER" type="STRING" size="256"/>
          <Column id="EARPHONES" type="STRING" size="256"/>
          <Column id="CASE" type="STRING" size="256"/>
          <Column id="USB" type="STRING" size="256"/>
          <Column id="MEMORY" type="STRING" size="256"/>
          <Column id="DTL_1" type="STRING" size="256"/>
          <Column id="DTL_2" type="STRING" size="256"/>
          <Column id="DTL_3" type="STRING" size="256"/>
          <Column id="OTHER" type="STRING" size="256"/>
          <Column id="SELL_GRADE" type="STRING" size="256"/>
          <Column id="ERR_DESC" type="STRING" size="256"/>
          <Column id="SKN_CL" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[/*
 * 01. 업무구분 : 공통
 * 02. 화면 : DsptMgmtSndAmtRgstP.xfdl
 * 03. 화면 설명 : 입금관리엑셀입력
 * 04. 관련 화면/서비스 : 
 * 05. 작성자 : 양재석
 * 06. 작성일 : 2015.09.16
 * 07. 수정이력 :
 ************************************************************************************************
 *     수정일        이  름    사유
 ************************************************************************************************
 *     2015.09.16    양재석    최초 작성
 ************************************************************************************************
 */
 
/*===============================================================================================
 * [ PART 1 ] Form에서 Include 할 라이브러리(xjs)파일 정의
================================================================================================*/
include "LIB::common.xjs"; //공통함수 호출

/*===============================================================================================
 * [ PART 2 ] Form에서 사용될 전역변수를 선언
================================================================================================*/
 var inputType;
/*===============================================================================================
 * [ PART 3 ] Form Event 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : Form Load Event
-----------------------------------------------------------------------------------------------*/
function Form_onload(obj:Form, e:LoadEventInfo)
{
	//공통 Form 초기화
	gfn_setInitPop(obj, e, "FEP042P");
	
 	//Form 초기 개발자 셋팅
 	//공통코드 초기화
 	fn_setInitCode(obj, e);
 	//그리드 초기화
 	fn_setInitGrid(obj, e);
 	//기본값 초기화
 	fn_setInitForm(obj, e);
}

/*===============================================================================================
 * [ PART 4 ] Load 후 초기설정
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 공통코드 초기화
-----------------------------------------------------------------------------------------------*/
function fn_setInitCode(obj:Form, e:LoadEventInfo)
{
	var strCode =  "DMS100=ds_DMS100=N";	//단말기색상
 		strCode += ",DMS179=ds_DMS179=A";	//중고폰G.Key 진행상태
 		strCode += ",DMS166=ds_DMS166=A";	//중고폰은행코드
 		strCode += ",DMS184=ds_DMS184=A";	//등급_가격설정
 		ds_DMS184

	gfn_getCodeDs( this
				  , strCode
				  ,"fn_afterCodeCallBack");	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 공통코드 호출 후 처리
-----------------------------------------------------------------------------------------------*/
function fn_afterCodeCallBack()
{		  	
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 그리드 초기화
-----------------------------------------------------------------------------------------------*/
function fn_setInitGrid(obj:Form, e:LoadEventInfo)
{
	page = 1;
	page_size = 999999999;
	//gfn_initGrid(grd_main, true, true, true, "row", null);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 기본값 설정
-----------------------------------------------------------------------------------------------*/
function fn_setInitForm(obj:Form, e:LoadEventInfo)
{
	//자동조회시 파라메타 전달예제
	//page = 1;
	//page_size = 30;
}



/*===============================================================================================
 * [ PART 5 ] Transaction 처리
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 메인조회
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_searchMain()
{
	var sSvcID		 = "searchMain";
	var sTrID		 = "PSCUserMgmt_pInqUserLst";
	var sPtrn		 = "R";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "ncFieldMap=ds_ncFieldMap";
	var sOutputDs	 = "ds_userLstTemp=RS_USER_LIST";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 에러체크
 * param   : 
 * return  : void
-----------------------------------------------------------------------------------------------*/
function fn_listErrChk()
{
	var sSvcID		 = "errChk";
	var sTrID		 = "PEPDpstMgmt_pInqSendAmtObjErrChkList";
	var sPtrn		 = "R";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "RQ_SEND_AMT_OBJ_EQP_LIST=ds_upLoadXlsList";
	var sOutputDs	 = "ds_upLoadChkXlsList=RS_SEND_AMT_OBJ_EQP_LIST";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
}
/*===============================================================================================
 * [ PART 6 ] CallBack 처리
================================================================================================*/
function fn_callBack(sSvcID, iErrorCode, sErrorMsg, ncMsgId, ncMsg)
{

	switch(sSvcID) {
		case "saveMain" : 	
			if ( iErrorCode == 0 ) {
				gfn_message("A","DMS00000","I"); //정상 처리되었습니다.
				this.close("S");
			} 
			break;
			
		case "errChk" : 	
			if ( iErrorCode == 0 ) {
			/*
				var strErrMsg = "";
				ds_upLoadXlsList.clearData();
				for(var i = 0; i < ds_upLoadChkXlsList.rowcount-1; i++){
					strErrMsg = ds_upLoadChkXlsList.getColumn(i,"ERR_DESC");
					for(var j = i+1; j < ds_upLoadChkXlsList.rowcount; j++){
						if(ds_upLoadChkXlsList.getColumn(i,"EQP_SER_NO") == ds_upLoadChkXlsList.getColumn(j,"EQP_SER_NO")
							|| ds_upLoadChkXlsList.getColumn(i,"IMEI") == ds_upLoadChkXlsList.getColumn(j,"IMEI")){
							strErrMsg = fn_msgAdd(strErrMsg,"["+(j+1)+"]번째단말기와중복");
							break;
						}
					}
					if(strErrMsg != ""){
						ds_upLoadChkXlsList.setColumn(i, "ERR_DESC", strErrMsg + " 오류");
						if(ds_upLoadChkXlsList.rowcount > 1 && i == (ds_upLoadChkXlsList.rowcount - 2) &&
							(ds_upLoadChkXlsList.getColumn(i,"EQP_SER_NO") == ds_upLoadChkXlsList.getColumn(j,"EQP_SER_NO")
							|| ds_upLoadChkXlsList.getColumn(i,"IMEI") == ds_upLoadChkXlsList.getColumn(j,"IMEI"))){ //마지막건도 동일 여부
							strErrMsg = ds_upLoadChkXlsList.getColumn(j,"ERR_DESC");
							strErrMsg = fn_msgAdd(strErrMsg,"["+(i+1)+"]번째단말기와중복");
							ds_upLoadChkXlsList.setColumn(j, "ERR_DESC", strErrMsg + " 오류");
						}
					}
				}
				*/
				ds_upLoadXlsList.copyData(ds_upLoadChkXlsList);
				gfn_message("A","오류검증이 완료 되었습니다. 오류여부 확인 바랍니다.","I");
				Div00.btn_excelSave.enable = true;
			} 
			break;
		default :
			break;
	}
}

/*===============================================================================================
 * [ PART 7 ] Main Button Event
================================================================================================*/
/*----------------------------------------------------------------------------------------------
 * 설명   : 버튼 Event
-----------------------------------------------------------------------------------------------*/
function button_onclick(obj:Button,  e:ClickEventInfo)
{
	switch(obj.name) 
	{	
			
		case "btn_confirm" :	//확인
			break;
		case "btn_cancel" : 	//취소
			close("cancel");
			break;
			
		case "btn_close" : 		//버튼X
			close("cancel");
			break;	
	}
}

/*===============================================================================================
 * [ PART 8 ] Event
================================================================================================*/
/*===============================================================================================
 * [ PART 9 ] User Defined
================================================================================================*/
/*******************************************************************************
 * 오류검증- 이벤트
*******************************************************************************/
function btn_errCheck_onclick(obj:Button,  e:ClickEventInfo)
{
	var bCf = true;
	if(ds_upLoadXlsList.getRowCount() == 0 
		|| (ds_upLoadXlsList.getRowCount() == 1 && gfn_isNull(ds_upLoadXlsList.getRowCount(0,"PROD_NM")) ) ){
		gfn_message("A","업로드 문서에 처리 할 데이터가 없습니다.\n업로드 문서를 확인하시기 바랍니다.","E","","");
		return;
	}	
	var strErrMsg = "";
	for(var i = 0 ; i < ds_upLoadXlsList.rowcount ; i++) {
		strErrMsg = "";
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"EQP_MDL_CD"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"모델코드공백");
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"EQP_SER_NO"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"일련번호공백");
		}else if(!fn_chkLength(ds_upLoadXlsList.getColumn(i,"EQP_SER_NO"),30)){
			strErrMsg = fn_msgAdd(strErrMsg,"일련번호자릿수(30)");
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"IMEI"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"IMEI공백");
		}else if(!fn_chkLength(ds_upLoadXlsList.getColumn(i,"IMEI"),15)){
			strErrMsg = fn_msgAdd(strErrMsg,"IMEI자릿수(15)");
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"EQP_COLOR_CD"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"색상코드공백");
		}else{
			ds_DMS100.filter("CM_CD_ID == '"+ds_upLoadXlsList.getColumn(i,"EQP_COLOR_CD")+"'");
			if(ds_DMS100.rowcount <= 0){
				strErrMsg = fn_msgAdd(strErrMsg,"미존재색상코드");
			}
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"DPSTR"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"고객명공백");
		}else if(!fn_chkLength(ds_upLoadXlsList.getColumn(i,"DPSTR"),50)){
			strErrMsg = fn_msgAdd(strErrMsg,"고객명자릿수(50)");
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"CNSL_DEALCO_CD"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"상담처코드공백");
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"EQP_ST"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"단말기등급공백");
		}else{
			ds_DMS184.filter("CM_CD_ID == '"+ds_upLoadXlsList.getColumn(i,"EQP_ST")+"'");
			if(ds_DMS184.rowcount <= 0){
				strErrMsg = fn_msgAdd(strErrMsg,"미존재단말기등급");
			}
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"SKN_JDG_AMT"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"매입가공백");
		}else if(!gfn_isDigit(ds_upLoadXlsList.getColumn(i,"SKN_JDG_AMT").replace(",",""))){
			strErrMsg = fn_msgAdd(strErrMsg,"매입가숫자형식");
		}
		
		if (  gfn_isNull(ds_upLoadXlsList.getColumn(i,"BANK_CD"))  ){
			strErrMsg = fn_msgAdd(strErrMsg,"은행코드공백");
		}else{
			ds_DMS166.filter("CM_CD_ID == '"+ds_upLoadXlsList.getColumn(i,"BANK_CD")+"'");
			if(ds_DMS166.rowcount <= 0){
				strErrMsg = fn_msgAdd(strErrMsg,"미존재은행코드");
			}else if(ds_upLoadXlsList.getColumn(i,"BANK_NM") == null || ds_upLoadXlsList.getColumn(i,"BANK_NM") == ""){
				strErrMsg = fn_msgAdd(strErrMsg,"은행명공백");
			}else if(ds_upLoadXlsList.getColumn(i,"BANK_NM").trim() != ds_DMS166.getColumn(0,"CM_CD_NM").trim()){
				strErrMsg = fn_msgAdd(strErrMsg,"은행명 기준정보와비동일");
			}
		}
		if (!gfn_isNull(ds_upLoadXlsList.getColumn(i,"CNSL_DT"))){
			if(ds_upLoadXlsList.getColumn(i,"CNSL_DT").length == 17 && ds_upLoadXlsList.getColumn(i,"CNSL_DT").substr(8) == "000000000"){
				ds_upLoadXlsList.setColumn(i,"CNSL_DT",ds_upLoadXlsList.getColumn(i,"CNSL_DT").substr(0,8));
			}
		}
		if (!gfn_isNull(ds_upLoadXlsList.getColumn(i,"ONING_DT"))){
			if(ds_upLoadXlsList.getColumn(i,"ONING_DT").length == 17 && ds_upLoadXlsList.getColumn(i,"ONING_DT").substr(8) == "000000000"){
				ds_upLoadXlsList.setColumn(i,"ONING_DT",ds_upLoadXlsList.getColumn(i,"ONING_DT").substr(0,8));
			}
		}
		if (!gfn_isNull(ds_upLoadXlsList.getColumn(i,"TLY_DT"))){
			if(ds_upLoadXlsList.getColumn(i,"TLY_DT").length == 17 && ds_upLoadXlsList.getColumn(i,"TLY_DT").substr(8) == "000000000"){
				ds_upLoadXlsList.setColumn(i,"TLY_DT",ds_upLoadXlsList.getColumn(i,"TLY_DT").substr(0,8));
			}
		}
		if (!gfn_isNull(ds_upLoadXlsList.getColumn(i,"CNSL_DT")) && gfn_length(ds_upLoadXlsList.getColumn(i,"CNSL_DT").replace("-","").trim()) > 8){
			strErrMsg = fn_msgAdd(strErrMsg,"상담일자자릿수");
		}
		if (!gfn_isNull(ds_upLoadXlsList.getColumn(i,"ONING_DT")) && gfn_length(ds_upLoadXlsList.getColumn(i,"ONING_DT").replace("-","").trim()) > 8){
			strErrMsg = fn_msgAdd(strErrMsg,"개통일자자릿수");
		}
		if (!gfn_isNull(ds_upLoadXlsList.getColumn(i,"TLY_DT")) && gfn_length(ds_upLoadXlsList.getColumn(i,"TLY_DT").replace("-","").trim()) > 8){
			strErrMsg = fn_msgAdd(strErrMsg,"검수일자자릿수");
		}
		
		//trace("ds_upLoadXlsList.getColumn : " + i + " : " + ds_upLoadXlsList.getColumn(i,"ONING_DT") + " : " + strErrMsg);
		if(strErrMsg != ""){
			ds_upLoadXlsList.setColumn(i, "ERR_DESC", strErrMsg + " 오류");
			bCf = false;
		}
	}
	ds_DMS100.filter("");
	ds_DMS166.filter("");
	ds_DMS179.filter("");
	ds_DMS184.filter("");
	
	if(bCf){	//정상
		//단말기코드,거래처코드,기등록단말여부 체크
		fn_listErrChk();
	} 
	
}
/*******************************************************************************
 * 엑셀업로드- 이벤트
*******************************************************************************/
function btn_addFileOne_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_upLoadXlsList.rowcount > 0){
		if(!confirm("이미 업로드한 파일이 있습니다. 무시하고 계속 하시겠습니까?")){
			return;
		}
	}
	ds_upLoadXlsList.clearData();
	Div00.btn_excelSave.enable = false;
	var excelNm = gfn_importExcel(ds_upLoadXlsList,0,5);
	if(excelNm != null && excelNm == false){
		btn_errCheck_onclick();
	}
}

/*******************************************************************************
 * 엑셀 Export- 이벤트
*******************************************************************************/
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_baseExcelExpert(grd_mainExcel,"입금관리단말기등록양식", "입금관리단말기등록양식");
}

/*******************************************************************************
 * 필터- 이벤트
*******************************************************************************/
function btn_filter_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_toggleGridFilter(grd_main);
}

/*******************************************************************************
 * grid data 저장 - 이벤트
*******************************************************************************/
function div_search_btn_excelSave_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_upLoadXlsList.rowcount <= 0){
		return;
	}
	
	var icnt = 0;
	for(var i = 0; i < ds_upLoadXlsList.rowcount; i++ ){
		if(ds_upLoadXlsList.getColumn(i,"ERR_DESC") != '' && ds_upLoadXlsList.getColumn(i,"ERR_DESC") != null ){
			icnt++;
		}		
	}

	if(icnt > 0){
		if(!confirm("오류사항이 발생된 모델은 업로드 시 자동 제외 합니다. \n계속 하시겠습니까?")){
			return;
		}
	}

	//오류건 삭제하기.
	for(var i = ds_upLoadXlsList.getRowCount()-1 ; i >= 0 ; i-- ){
		if(ds_upLoadXlsList.getColumn(i,"ERR_DESC") != '' && ds_upLoadXlsList.getColumn(i,"ERR_DESC") != null ){
			ds_upLoadXlsList.deleteRow(i);
		}
	}

	if(ds_upLoadXlsList.getRowCount() == 0 ){
		gfn_message("A","DMS00087");
		return;
	}

	var sSvcID		 = "saveMain";
	var sTrID		 = "PEPDpstMgmt_pRegDpstMgmtSendAmtEqp";
	var sPtrn		 = "C";  //입력C,조회R,수정U,삭제D,복합M
	var sInputDs	 = "RQ_SEND_AMT_OBJ_EQP_LIST=ds_upLoadXlsList";
	var sOutputDs	 = "";
	var sArgs		 = "";
	var sCallBackFnc = "fn_callBack";
	
	gfn_transaction(sSvcID, sTrID, sPtrn, sInputDs, sOutputDs, sArgs, sCallBackFnc);
	
}

/*
삭제버튼
*/
function btn_delete_onclick(obj:Button,  e:ClickEventInfo)
{
	if(grd_main.currentrow < 0){
		return;
	}
	ds_upLoadXlsList.deleteRow(grd_main.currentrow);
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 메세지 추가
-----------------------------------------------------------------------------------------------*/
function fn_msgAdd(orgMsg,strAddMsg)
{
	if(strAddMsg == null || strAddMsg == ""){
		return orgMsg;
	}
	if(orgMsg != null && orgMsg != ""){
		orgMsg = orgMsg + "," + strAddMsg;
	}
	else{
		orgMsg = strAddMsg;
	}
	return orgMsg;
}
/*----------------------------------------------------------------------------------------------
 * 설명   : 길이 체크
-----------------------------------------------------------------------------------------------*/
function fn_chkLength(chkData,chkLength)
{
	if(chkData == null || chkData == "" || chkData.length <= chkLength){
		return true;
	}
	return false;
}]]></Script>
  </Form>
</FDL>
